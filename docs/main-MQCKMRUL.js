var zA=Object.defineProperty,Rj=Object.defineProperties;var xj=Object.getOwnPropertyDescriptors;var HA=Object.getOwnPropertySymbols,Nj=Object.getPrototypeOf,Pj=Object.prototype.hasOwnProperty,Mj=Object.prototype.propertyIsEnumerable,kj=Reflect.get;var qA=(n,e,t)=>e in n?zA(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,X=(n,e)=>{for(var t in e||={})Pj.call(e,t)&&qA(n,t,e[t]);if(HA)for(var t of HA(e))Mj.call(e,t)&&qA(n,t,e[t]);return n},it=(n,e)=>Rj(n,xj(e));var Oj=(n,e)=>{for(var t in e)zA(n,t,{get:e[t],enumerable:!0})};var Tr=(n,e,t)=>kj(Nj(n),t,e);var g=(n,e,t)=>new Promise((r,i)=>{var s=c=>{try{a(t.next(c))}catch(l){i(l)}},o=c=>{try{a(t.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(n,e)).next())});var WA=null;var by=1,GA=Symbol("SIGNAL");function ke(n){let e=WA;return WA=n,e}var KA={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Lj(n){if(!(Sy(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===by)){if(!n.producerMustRecompute(n)&&!Cy(n)){n.dirty=!1,n.lastCleanEpoch=by;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=by}}function QA(n){return n&&(n.nextProducerIndex=0),ke(n)}function YA(n,e){if(ke(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Sy(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Dy(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Cy(n){nf(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(Lj(t),r!==t.version))return!0}return!1}function JA(n){if(nf(n),Sy(n))for(let e=0;e<n.producerNode.length;e++)Dy(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Dy(n,e){if(Fj(n),nf(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)Dy(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];nf(i),i.producerIndexOfThis[r]=e}}function Sy(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function nf(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function Fj(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function Vj(){throw new Error}var Uj=Vj;function XA(n){Uj=n}function ce(n){return typeof n=="function"}function la(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var rf=la(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function jl(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Dt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ce(r))try{r()}catch(s){e=s instanceof rf?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{ZA(s)}catch(o){e=e??[],o instanceof rf?e=[...e,...o.errors]:e.push(o)}}if(e)throw new rf(e)}}add(e){var t;if(e&&e!==this)if(this.closed)ZA(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&jl(t,e)}remove(e){let{_finalizers:t}=this;t&&jl(t,e),e instanceof n&&e._removeParent(this)}};Dt.EMPTY=(()=>{let n=new Dt;return n.closed=!0,n})();var Ay=Dt.EMPTY;function sf(n){return n instanceof Dt||n&&"closed"in n&&ce(n.remove)&&ce(n.add)&&ce(n.unsubscribe)}function ZA(n){ce(n)?n():n.unsubscribe()}var nr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var ua={setTimeout(n,e,...t){let{delegate:r}=ua;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=ua;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function of(n){ua.setTimeout(()=>{let{onUnhandledError:e}=nr;if(e)e(n);else throw n})}function Bl(){}var eR=Ry("C",void 0,void 0);function tR(n){return Ry("E",void 0,n)}function nR(n){return Ry("N",n,void 0)}function Ry(n,e,t){return{kind:n,value:e,error:t}}var Hs=null;function da(n){if(nr.useDeprecatedSynchronousErrorHandling){let e=!Hs;if(e&&(Hs={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Hs;if(Hs=null,t)throw r}}else n()}function rR(n){nr.useDeprecatedSynchronousErrorHandling&&Hs&&(Hs.errorThrown=!0,Hs.error=n)}var qs=class extends Dt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,sf(e)&&e.add(this)):this.destination=$j}static create(e,t,r){return new ha(e,t,r)}next(e){this.isStopped?Ny(nR(e),this):this._next(e)}error(e){this.isStopped?Ny(tR(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Ny(eR,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},jj=Function.prototype.bind;function xy(n,e){return jj.call(n,e)}var Py=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){af(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){af(r)}else af(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){af(t)}}},ha=class extends qs{constructor(e,t,r){super();let i;if(ce(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&nr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&xy(e.next,s),error:e.error&&xy(e.error,s),complete:e.complete&&xy(e.complete,s)}):i=e}this.destination=new Py(i)}};function af(n){nr.useDeprecatedSynchronousErrorHandling?rR(n):of(n)}function Bj(n){throw n}function Ny(n,e){let{onStoppedNotification:t}=nr;t&&ua.setTimeout(()=>t(n,e))}var $j={closed:!0,next:Bl,error:Bj,complete:Bl};var fa=typeof Symbol=="function"&&Symbol.observable||"@@observable";function bn(n){return n}function My(...n){return ky(n)}function ky(n){return n.length===0?bn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Le=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=qj(t)?t:new ha(t,r,i);return da(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=iR(r),new r((i,s)=>{let o=new ha({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[fa](){return this}pipe(...t){return ky(t)(this)}toPromise(t){return t=iR(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function iR(n){var e;return(e=n??nr.Promise)!==null&&e!==void 0?e:Promise}function Hj(n){return n&&ce(n.next)&&ce(n.error)&&ce(n.complete)}function qj(n){return n&&n instanceof qs||Hj(n)&&sf(n)}function Oy(n){return ce(n?.lift)}function Ie(n){return e=>{if(Oy(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ee(n,e,t,r,i){return new Ly(n,e,t,r,i)}var Ly=class extends qs{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function pa(){return Ie((n,e)=>{let t=null;n._refCount++;let r=Ee(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var ma=class extends Le{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Oy(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Dt;let t=this.getSubject();e.add(this.source.subscribe(Ee(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Dt.EMPTY)}return e}refCount(){return pa()(this)}};var sR=la(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Wt=(()=>{class n extends Le{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new cf(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new sR}next(t){da(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){da(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){da(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Ay:(this.currentObservers=null,s.push(t),new Dt(()=>{this.currentObservers=null,jl(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new Le;return t.source=this,t}}return n.create=(e,t)=>new cf(e,t),n})(),cf=class extends Wt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Ay}};var Ft=class extends Wt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Cn=new Le(n=>n.complete());function oR(n){return n&&ce(n.schedule)}function aR(n){return n[n.length-1]}function cR(n){return ce(aR(n))?n.pop():void 0}function ji(n){return oR(aR(n))?n.pop():void 0}function lf(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function uR(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{l(r.next(d))}catch(h){o(h)}}function c(d){try{l(r.throw(d))}catch(h){o(h)}}function l(d){d.done?s(d.value):i(d.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function lR(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function zs(n){return this instanceof zs?(this.v=n,this):new zs(n)}function dR(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(w){return Promise.resolve(w).then(_,h)}}function a(_,w){r[_]&&(i[_]=function(b){return new Promise(function(R,L){s.push([_,b,R,L])>1||c(_,b)})},w&&(i[_]=w(i[_])))}function c(_,w){try{l(r[_](w))}catch(b){p(s[0][3],b)}}function l(_){_.value instanceof zs?Promise.resolve(_.value.v).then(d,h):p(s[0][2],_)}function d(_){c("next",_)}function h(_){c("throw",_)}function p(_,w){_(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function hR(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof lR=="function"?lR(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var uf=n=>n&&typeof n.length=="number"&&typeof n!="function";function df(n){return ce(n?.then)}function hf(n){return ce(n[fa])}function ff(n){return Symbol.asyncIterator&&ce(n?.[Symbol.asyncIterator])}function pf(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function zj(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var mf=zj();function gf(n){return ce(n?.[mf])}function _f(n){return dR(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield zs(t.read());if(i)return yield zs(void 0);yield yield zs(r)}}finally{t.releaseLock()}})}function yf(n){return ce(n?.getReader)}function Nt(n){if(n instanceof Le)return n;if(n!=null){if(hf(n))return Wj(n);if(uf(n))return Gj(n);if(df(n))return Kj(n);if(ff(n))return fR(n);if(gf(n))return Qj(n);if(yf(n))return Yj(n)}throw pf(n)}function Wj(n){return new Le(e=>{let t=n[fa]();if(ce(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Gj(n){return new Le(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function Kj(n){return new Le(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,of)})}function Qj(n){return new Le(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function fR(n){return new Le(e=>{Jj(n,e).catch(t=>e.error(t))})}function Yj(n){return fR(_f(n))}function Jj(n,e){var t,r,i,s;return uR(this,void 0,void 0,function*(){try{for(t=hR(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function gn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function vf(n,e=0){return Ie((t,r)=>{t.subscribe(Ee(r,i=>gn(r,n,()=>r.next(i),e),()=>gn(r,n,()=>r.complete(),e),i=>gn(r,n,()=>r.error(i),e)))})}function wf(n,e=0){return Ie((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function pR(n,e){return Nt(n).pipe(wf(e),vf(e))}function mR(n,e){return Nt(n).pipe(wf(e),vf(e))}function gR(n,e){return new Le(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function _R(n,e){return new Le(t=>{let r;return gn(t,e,()=>{r=n[mf](),gn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>ce(r?.return)&&r.return()})}function If(n,e){if(!n)throw new Error("Iterable cannot be null");return new Le(t=>{gn(t,e,()=>{let r=n[Symbol.asyncIterator]();gn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function yR(n,e){return If(_f(n),e)}function vR(n,e){if(n!=null){if(hf(n))return pR(n,e);if(uf(n))return gR(n,e);if(df(n))return mR(n,e);if(ff(n))return If(n,e);if(gf(n))return _R(n,e);if(yf(n))return yR(n,e)}throw pf(n)}function ut(n,e){return e?vR(n,e):Nt(n)}function oe(...n){let e=ji(n);return ut(n,e)}function ga(n,e){let t=ce(n)?n:()=>n,r=i=>i.error(t());return new Le(e?i=>e.schedule(r,0,i):r)}function Fy(n){return!!n&&(n instanceof Le||ce(n.lift)&&ce(n.subscribe))}var ui=la(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Te(n,e){return Ie((t,r)=>{let i=0;t.subscribe(Ee(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:Xj}=Array;function Zj(n,e){return Xj(e)?n(...e):n(e)}function wR(n){return Te(e=>Zj(n,e))}var{isArray:eB}=Array,{getPrototypeOf:tB,prototype:nB,keys:rB}=Object;function IR(n){if(n.length===1){let e=n[0];if(eB(e))return{args:e,keys:null};if(iB(e)){let t=rB(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function iB(n){return n&&typeof n=="object"&&tB(n)===nB}function ER(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function $l(...n){let e=ji(n),t=cR(n),{args:r,keys:i}=IR(n);if(r.length===0)return ut([],e);let s=new Le(sB(r,e,i?o=>ER(i,o):bn));return t?s.pipe(wR(t)):s}function sB(n,e,t=bn){return r=>{TR(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)TR(e,()=>{let l=ut(n[c],e),d=!1;l.subscribe(Ee(r,h=>{s[c]=h,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function TR(n,e,t){n?gn(t,n,e):e()}function bR(n,e,t,r,i,s,o,a){let c=[],l=0,d=0,h=!1,p=()=>{h&&!c.length&&!l&&e.complete()},_=b=>l<r?w(b):c.push(b),w=b=>{s&&e.next(b),l++;let R=!1;Nt(t(b,d++)).subscribe(Ee(e,L=>{i?.(L),s?_(L):e.next(L)},()=>{R=!0},void 0,()=>{if(R)try{for(l--;c.length&&l<r;){let L=c.shift();o?gn(e,o,()=>w(L)):w(L)}p()}catch(L){e.error(L)}}))};return n.subscribe(Ee(e,_,()=>{h=!0,p()})),()=>{a?.()}}function gt(n,e,t=1/0){return ce(e)?gt((r,i)=>Te((s,o)=>e(r,s,i,o))(Nt(n(r,i))),t):(typeof e=="number"&&(t=e),Ie((r,i)=>bR(r,i,n,t)))}function _a(n=1/0){return gt(bn,n)}function CR(){return _a(1)}function ya(...n){return CR()(ut(n,ji(n)))}function Ef(n){return new Le(e=>{Nt(n()).subscribe(e)})}function Vn(n,e){return Ie((t,r)=>{let i=0;t.subscribe(Ee(r,s=>n.call(e,s,i++)&&r.next(s)))})}function Bi(n){return Ie((e,t)=>{let r=null,i=!1,s;r=e.subscribe(Ee(t,void 0,void 0,o=>{s=Nt(n(o,Bi(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function DR(n,e,t,r,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(Ee(o,d=>{let h=l++;c=a?n(c,d,h):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function Ws(n,e){return ce(e)?gt(n,e,1):gt(n,1)}function $i(n){return Ie((e,t)=>{let r=!1;e.subscribe(Ee(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function di(n){return n<=0?()=>Cn:Ie((e,t)=>{let r=0;e.subscribe(Ee(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Vy(n){return Te(()=>n)}function Tf(n=oB){return Ie((e,t)=>{let r=!1;e.subscribe(Ee(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function oB(){return new ui}function Hl(n){return Ie((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function br(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Vn((i,s)=>n(i,s,r)):bn,di(1),t?$i(e):Tf(()=>new ui))}function va(n){return n<=0?()=>Cn:Ie((e,t)=>{let r=[];e.subscribe(Ee(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Uy(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Vn((i,s)=>n(i,s,r)):bn,va(1),t?$i(e):Tf(()=>new ui))}function jy(n,e){return Ie(DR(n,e,arguments.length>=2,!0))}function By(...n){let e=ji(n);return Ie((t,r)=>{(e?ya(n,t,e):ya(n,t)).subscribe(r)})}function Un(n,e){return Ie((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(Ee(r,c=>{i?.unsubscribe();let l=0,d=s++;Nt(n(c,d)).subscribe(i=Ee(r,h=>r.next(e?e(c,h,d,l++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function $y(n){return Ie((e,t)=>{Nt(n).subscribe(Ee(t,()=>t.complete(),Bl)),!t.closed&&e.subscribe(t)})}function Vt(n,e,t){let r=ce(n)||e||t?{next:n,error:e,complete:t}:n;return r?Ie((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Ee(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):bn}var lx="https://g.co/ng/security#xss",te=class extends Error{constructor(e,t){super(Nv(e,t)),this.code=e}};function Nv(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function ru(n){return{toString:n}.toString()}var bf="__parameters__";function aB(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function ux(n,e,t){return ru(()=>{let r=aB(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,d){let h=c.hasOwnProperty(bf)?c[bf]:Object.defineProperty(c,bf,{value:[]})[bf];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Ut=globalThis;function Ue(n){for(let e in n)if(n[e]===Ue)return e;throw Error("Could not find renamed property on target object.")}function Dn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Dn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function SR(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var cB=Ue({__forward_ref__:Ue});function dx(n){return n.__forward_ref__=dx,n.toString=function(){return Dn(this())},n}function Bn(n){return hx(n)?n():n}function hx(n){return typeof n=="function"&&n.hasOwnProperty(cB)&&n.__forward_ref__===dx}function ne(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ar(n){return{providers:n.providers||[],imports:n.imports||[]}}function Xf(n){return AR(n,px)||AR(n,mx)}function fx(n){return Xf(n)!==null}function AR(n,e){return n.hasOwnProperty(e)?n[e]:null}function lB(n){let e=n&&(n[px]||n[mx]);return e||null}function RR(n){return n&&(n.hasOwnProperty(xR)||n.hasOwnProperty(uB))?n[xR]:null}var px=Ue({\u0275prov:Ue}),xR=Ue({\u0275inj:Ue}),mx=Ue({ngInjectableDef:Ue}),uB=Ue({ngInjectorDef:Ue}),ue=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ne({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function gx(n){return n&&!!n.\u0275providers}var dB=Ue({\u0275cmp:Ue}),hB=Ue({\u0275dir:Ue}),fB=Ue({\u0275pipe:Ue}),pB=Ue({\u0275mod:Ue}),Mf=Ue({\u0275fac:Ue}),ql=Ue({__NG_ELEMENT_ID__:Ue}),NR=Ue({__NG_ENV_ID__:Ue});function Pv(n){return typeof n=="string"?n:n==null?"":String(n)}function mB(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Pv(n)}function gB(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new te(-200,n)}function Mv(n,e){throw new te(-201,!1)}var ye=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ye||{}),Xy;function _x(){return Xy}function jn(n){let e=Xy;return Xy=n,e}function yx(n,e,t){let r=Xf(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ye.Optional)return null;if(e!==void 0)return e;Mv(n,"Injector")}var _B={},Wl=_B,Zy="__NG_DI_FLAG__",kf="ngTempTokenPath",yB="ngTokenPath",vB=/\n/gm,wB="\u0275",PR="__source",ba;function IB(){return ba}function Hi(n){let e=ba;return ba=n,e}function EB(n,e=ye.Default){if(ba===void 0)throw new te(-203,!1);return ba===null?yx(n,void 0,e):ba.get(n,e&ye.Optional?null:void 0,e)}function se(n,e=ye.Default){return(_x()||EB)(Bn(n),e)}function K(n,e=ye.Default){return se(n,Zf(e))}function Zf(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function ev(n){let e=[];for(let t=0;t<n.length;t++){let r=Bn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new te(900,!1);let i,s=ye.Default;for(let o=0;o<r.length;o++){let a=r[o],c=TB(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(se(i,s))}else e.push(se(r))}return e}function vx(n,e){return n[Zy]=e,n.prototype[Zy]=e,n}function TB(n){return n[Zy]}function bB(n,e,t,r){let i=n[kf];throw e[PR]&&i.unshift(e[PR]),n.message=CB(`
`+n.message,i,t,r),n[yB]=i,n[kf]=null,n}function CB(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==wB?n.slice(2):n;let i=Dn(e);if(Array.isArray(e))i=e.map(Dn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Dn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(vB,`
  `)}`}var kv=vx(ux("Optional"),8);var wx=vx(ux("SkipSelf"),4);function Da(n,e){let t=n.hasOwnProperty(Mf);return t?n[Mf]:null}function Ov(n,e){n.forEach(t=>Array.isArray(t)?Ov(t,e):e(t))}function Ix(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Of(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var Gl={},Cr=[],Sa=new ue(""),Ex=new ue("",-1),Tx=new ue(""),Lf=class{get(e,t=Wl){if(t===Wl){let r=new Error(`NullInjectorError: No provider for ${Dn(e)}!`);throw r.name="NullInjectorError",r}return t}},bx=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(bx||{}),Ar=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Ar||{}),sr=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(sr||{});function DB(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function tv(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];SB(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function Cx(n){return n===3||n===4||n===6}function SB(n){return n.charCodeAt(0)===64}function Lv(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?MR(n,t,i,null,e[++r]):MR(n,t,i,null,null))}}return n}function MR(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var Dx="ng-template";function AB(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&DB(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Fv(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function Fv(n){return n.type===4&&n.value!==Dx}function RB(n,e,t){let r=n.type===4&&!t?Dx:n.value;return e===r}function xB(n,e,t){let r=4,i=n.attrs,s=i!==null?MB(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!rr(r)&&!rr(c))return!1;if(o&&rr(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!RB(n,c,t)||c===""&&e.length===1){if(rr(r))return!1;o=!0}}else if(r&8){if(i===null||!AB(n,i,c,t)){if(rr(r))return!1;o=!0}}else{let l=e[++a],d=NB(c,i,Fv(n),t);if(d===-1){if(rr(r))return!1;o=!0;continue}if(l!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&l!==h){if(rr(r))return!1;o=!0}}}}return rr(r)||o}function rr(n){return(n&1)===0}function NB(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return kB(e,n)}function PB(n,e,t=!1){for(let r=0;r<e.length;r++)if(xB(n,e[r],t))return!0;return!1}function MB(n){for(let e=0;e<n.length;e++){let t=n[e];if(Cx(t))return e}return n.length}function kB(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function kR(n,e){return n?":not("+e.trim()+")":e}function OB(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!rr(o)&&(e+=kR(s,i),i=""),r=o,s=s||!rr(r);t++}return i!==""&&(e+=kR(s,i)),e}function LB(n){return n.map(OB).join(",")}function FB(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!rr(i))break;i=s}r++}return{attrs:e,classes:t}}function st(n){return ru(()=>{let e=Nx(n),t=it(X({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===bx.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Ar.Emulated,styles:n.styles||Cr,_:null,schemas:n.schemas||null,tView:null,id:""});Px(t);let r=n.dependencies;return t.directiveDefs=LR(r,!1),t.pipeDefs=LR(r,!0),t.id=jB(t),t})}function VB(n){return zi(n)||Sx(n)}function UB(n){return n!==null}function cr(n){return ru(()=>({type:n.type,bootstrap:n.bootstrap||Cr,declarations:n.declarations||Cr,imports:n.imports||Cr,exports:n.exports||Cr,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function OR(n,e){if(n==null)return Gl;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=sr.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==sr.None?[r,a]:r,e[s]=o):t[s]=r}return t}function ep(n){return ru(()=>{let e=Nx(n);return Px(e),e})}function zi(n){return n[dB]||null}function Sx(n){return n[hB]||null}function Ax(n){return n[fB]||null}function Rx(n){let e=zi(n)||Sx(n)||Ax(n);return e!==null?e.standalone:!1}function xx(n,e){let t=n[pB]||null;if(!t&&e===!0)throw new Error(`Type ${Dn(n)} does not have '\u0275mod' property.`);return t}function Nx(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Gl,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||Cr,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:OR(n.inputs,e),outputs:OR(n.outputs),debugInfo:null}}function Px(n){n.features?.forEach(e=>e(n))}function LR(n,e){if(!n)return null;let t=e?Ax:VB;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(UB)}function jB(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function BB(...n){return{\u0275providers:Mx(!0,n),\u0275fromNgModule:!0}}function Mx(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return Ov(e,o=>{let a=o;nv(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&kx(i,s),t}function kx(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Vv(i,s=>{e(s,r)})}}function nv(n,e,t,r){if(n=Bn(n),!n)return!1;let i=null,s=RR(n),o=!s&&zi(n);if(!s&&!o){let c=n.ngModule;if(s=RR(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)nv(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Ov(s.imports,d=>{nv(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&kx(l,e)}if(!a){let l=Da(i)||(()=>new i);e({provide:i,useFactory:l,deps:Cr},i),e({provide:Tx,useValue:i,multi:!0},i),e({provide:Sa,useValue:()=>se(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;Vv(c,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function Vv(n,e){for(let t of n)gx(t)&&(t=t.\u0275providers),Array.isArray(t)?Vv(t,e):e(t)}var $B=Ue({provide:String,useValue:Ue});function Ox(n){return n!==null&&typeof n=="object"&&$B in n}function HB(n){return!!(n&&n.useExisting)}function qB(n){return!!(n&&n.useFactory)}function rv(n){return typeof n=="function"}var tp=new ue(""),Af={},zB={},Hy;function Uv(){return Hy===void 0&&(Hy=new Lf),Hy}var _n=class{},Kl=class extends _n{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,sv(e,o=>this.processProvider(o)),this.records.set(Ex,wa(void 0,this)),i.has("environment")&&this.records.set(_n,wa(void 0,this));let s=this.records.get(tp);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Tx,Cr,ye.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=ke(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ke(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Hi(this),r=jn(void 0),i;try{return e()}finally{Hi(t),jn(r)}}get(e,t=Wl,r=ye.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(NR))return e[NR](this);r=Zf(r);let i,s=Hi(this),o=jn(void 0);try{if(!(r&ye.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=JB(e)&&Xf(e);l&&this.injectableDefInScope(l)?c=wa(iv(e),Af):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ye.Self?Uv():this.parent;return t=r&ye.Optional&&t===Wl?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[kf]=a[kf]||[]).unshift(Dn(e)),s)throw a;return bB(a,e,"R3InjectorError",this.source)}else throw a}finally{jn(o),Hi(s)}}resolveInjectorInitializers(){let e=ke(null),t=Hi(this),r=jn(void 0),i;try{let s=this.get(Sa,Cr,ye.Self);for(let o of s)o()}finally{Hi(t),jn(r),ke(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Dn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new te(205,!1)}processProvider(e){e=Bn(e);let t=rv(e)?e:Bn(e&&e.provide),r=GB(e);if(!rv(e)&&e.multi===!0){let i=this.records.get(t);i||(i=wa(void 0,Af,!0),i.factory=()=>ev(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=ke(null);try{return t.value===Af&&(t.value=zB,t.value=t.factory()),typeof t.value=="object"&&t.value&&YB(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ke(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Bn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function iv(n){let e=Xf(n),t=e!==null?e.factory:Da(n);if(t!==null)return t;if(n instanceof ue)throw new te(204,!1);if(n instanceof Function)return WB(n);throw new te(204,!1)}function WB(n){if(n.length>0)throw new te(204,!1);let t=lB(n);return t!==null?()=>t.factory(n):()=>new n}function GB(n){if(Ox(n))return wa(void 0,n.useValue);{let e=KB(n);return wa(e,Af)}}function KB(n,e,t){let r;if(rv(n)){let i=Bn(n);return Da(i)||iv(i)}else if(Ox(n))r=()=>Bn(n.useValue);else if(qB(n))r=()=>n.useFactory(...ev(n.deps||[]));else if(HB(n))r=()=>se(Bn(n.useExisting));else{let i=Bn(n&&(n.useClass||n.provide));if(QB(n))r=()=>new i(...ev(n.deps));else return Da(i)||iv(i)}return r}function wa(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function QB(n){return!!n.deps}function YB(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function JB(n){return typeof n=="function"||typeof n=="object"&&n instanceof ue}function sv(n,e){for(let t of n)Array.isArray(t)?sv(t,e):t&&gx(t)?sv(t.\u0275providers,e):e(t)}function pi(n,e){n instanceof Kl&&n.assertNotDestroyed();let t,r=Hi(n),i=jn(void 0);try{return e()}finally{Hi(r),jn(i)}}function Lx(){return _x()!==void 0||IB()!=null}function XB(n){if(!Lx())throw new te(-203,!1)}function ZB(n){let e=Ut.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function e$(n){return typeof n=="function"}var mi=0,be=1,le=2,Gt=3,ir=4,lr=5,Ff=6,Ql=7,hi=8,Aa=9,or=10,Sn=11,Yl=12,FR=13,iu=14,Rr=15,jv=16,Ia=17,np=18,rp=19,Fx=20,qi=21,qy=22,Qs=23,Ys=25,Vx=1;var Js=7,Vf=8,Uf=9,$n=10,Bv=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Bv||{});function Gs(n){return Array.isArray(n)&&typeof n[Vx]=="object"}function gi(n){return Array.isArray(n)&&n[Vx]===!0}function Ux(n){return(n.flags&4)!==0}function $v(n){return n.componentOffset>-1}function jx(n){return(n.flags&1)===1}function su(n){return!!n.template}function t$(n){return(n[le]&512)!==0}var ov=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function Bx(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function ou(){return $x}function $x(n){return n.type.prototype.ngOnChanges&&(n.setInput=r$),n$}ou.ngInherit=!0;function n$(){let n=qx(this),e=n?.current;if(e){let t=n.previous;if(t===Gl)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function r$(n,e,t,r,i){let s=this.declaredInputs[r],o=qx(n)||i$(n,{previous:Gl,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new ov(l&&l.currentValue,t,c===Gl),Bx(n,e,i,t)}var Hx="__ngSimpleChanges__";function qx(n){return n[Hx]||null}function i$(n,e){return n[Hx]=e}var VR=null;var Dr=function(n,e,t){VR?.(n,e,t)},s$="svg",o$="math",a$=!1;function c$(){return a$}function fi(n){for(;Array.isArray(n);)n=n[mi];return n}function ur(n,e){return fi(e[n.index])}function zx(n,e){return n.data[e]}function Zs(n,e){let t=e[n];return Gs(t)?t:t[mi]}function Hv(n){return(n[le]&128)===128}function l$(n){return gi(n[Gt])}function UR(n,e){return e==null?null:n[e]}function Wx(n){n[Ia]=0}function u$(n){n[le]&1024||(n[le]|=1024,Hv(n)&&Jl(n))}function qv(n){return!!(n[le]&9216||n[Qs]?.dirty)}function av(n){n[or].changeDetectionScheduler?.notify(1),qv(n)?Jl(n):n[le]&64&&(c$()?(n[le]|=1024,Jl(n)):n[or].changeDetectionScheduler?.notify())}function Jl(n){n[or].changeDetectionScheduler?.notify();let e=Xl(n);for(;e!==null&&!(e[le]&8192||(e[le]|=8192,!Hv(e)));)e=Xl(e)}function Gx(n,e){if((n[le]&256)===256)throw new te(911,!1);n[qi]===null&&(n[qi]=[]),n[qi].push(e)}function d$(n,e){if(n[qi]===null)return;let t=n[qi].indexOf(e);t!==-1&&n[qi].splice(t,1)}function Xl(n){let e=n[Gt];return gi(e)?e[Gt]:e}var Pe={lFrame:eN(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function h$(){return Pe.lFrame.elementDepthCount}function f$(){Pe.lFrame.elementDepthCount++}function p$(){Pe.lFrame.elementDepthCount--}function Kx(){return Pe.bindingsEnabled}function m$(){return Pe.skipHydrationRootTNode!==null}function g$(n){return Pe.skipHydrationRootTNode===n}function _$(){Pe.skipHydrationRootTNode=null}function sn(){return Pe.lFrame.lView}function au(){return Pe.lFrame.tView}function dr(){let n=Qx();for(;n!==null&&n.type===64;)n=n.parent;return n}function Qx(){return Pe.lFrame.currentTNode}function y$(){let n=Pe.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function ip(n,e){let t=Pe.lFrame;t.currentTNode=n,t.isParent=e}function Yx(){return Pe.lFrame.isParent}function v$(){Pe.lFrame.isParent=!1}function w$(n){return Pe.lFrame.bindingIndex=n}function I$(){return Pe.lFrame.bindingIndex++}function E$(){return Pe.lFrame.inI18n}function T$(n,e){let t=Pe.lFrame;t.bindingIndex=t.bindingRootIndex=n,cv(e)}function b$(){return Pe.lFrame.currentDirectiveIndex}function cv(n){Pe.lFrame.currentDirectiveIndex=n}function Jx(n){Pe.lFrame.currentQueryIndex=n}function C$(n){let e=n[be];return e.type===2?e.declTNode:e.type===1?n[lr]:null}function Xx(n,e,t){if(t&ye.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&ye.Host);)if(i=C$(s),i===null||(s=s[iu],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=Pe.lFrame=Zx();return r.currentTNode=e,r.lView=n,!0}function zv(n){let e=Zx(),t=n[be];Pe.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Zx(){let n=Pe.lFrame,e=n===null?null:n.child;return e===null?eN(n):e}function eN(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function tN(){let n=Pe.lFrame;return Pe.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var nN=tN;function Wv(){let n=tN();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function D$(){return Pe.lFrame.selectedIndex}function Xs(n){Pe.lFrame.selectedIndex=n}function S$(){let n=Pe.lFrame;return zx(n.tView,n.selectedIndex)}function A$(){return Pe.lFrame.currentNamespace}var rN=!0;function iN(){return rN}function sN(n){rN=n}function R$(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=$x(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function oN(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Rf(n,e,t){aN(n,e,3,t)}function xf(n,e,t,r){(n[le]&3)===t&&aN(n,e,t,r)}function zy(n,e){let t=n[le];(t&3)===e&&(t&=16383,t+=1,n[le]=t)}function aN(n,e,t,r){let i=r!==void 0?n[Ia]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[Ia]+=65536),(a<s||s==-1)&&(x$(n,t,e,c),n[Ia]=(n[Ia]&4294901760)+c+2),c++}function jR(n,e){Dr(4,n,e);let t=ke(null);try{e.call(n)}finally{ke(t),Dr(5,n,e)}}function x$(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[le]>>14<n[Ia]>>16&&(n[le]&3)===e&&(n[le]+=16384,jR(a,s)):jR(a,s)}var Ca=-1,Zl=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function N$(n){return n instanceof Zl}function P$(n){return(n.flags&8)!==0}function M$(n){return(n.flags&16)!==0}function cN(n){return n!==Ca}function jf(n){return n&32767}function k$(n){return n>>16}function Bf(n,e){let t=k$(n),r=e;for(;t>0;)r=r[iu],t--;return r}var lv=!0;function BR(n){let e=lv;return lv=n,e}var O$=256,lN=O$-1,uN=5,L$=0,Sr={};function F$(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(ql)&&(r=t[ql]),r==null&&(r=t[ql]=L$++);let i=r&lN,s=1<<i;e.data[n+(i>>uN)]|=s}function dN(n,e){let t=hN(n,e);if(t!==-1)return t;let r=e[be];r.firstCreatePass&&(n.injectorIndex=e.length,Wy(r.data,n),Wy(e,null),Wy(r.blueprint,null));let i=Gv(n,e),s=n.injectorIndex;if(cN(i)){let o=jf(i),a=Bf(i,e),c=a[be].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function Wy(n,e){n.push(0,0,0,0,0,0,0,0,e)}function hN(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Gv(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=_N(i),r===null)return Ca;if(t++,i=i[iu],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Ca}function V$(n,e,t){F$(n,e,t)}function U$(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(Cx(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function fN(n,e,t){if(t&ye.Optional||n!==void 0)return n;Mv(e,"NodeInjector")}function pN(n,e,t,r){if(t&ye.Optional&&r===void 0&&(r=null),!(t&(ye.Self|ye.Host))){let i=n[Aa],s=jn(void 0);try{return i?i.get(e,r,t&ye.Optional):yx(e,r,t&ye.Optional)}finally{jn(s)}}return fN(r,e,t)}function mN(n,e,t,r=ye.Default,i){if(n!==null){if(e[le]&2048&&!(r&ye.Self)){let o=q$(n,e,t,r,Sr);if(o!==Sr)return o}let s=gN(n,e,t,r,Sr);if(s!==Sr)return s}return pN(e,t,r,i)}function gN(n,e,t,r,i){let s=$$(t);if(typeof s=="function"){if(!Xx(e,n,r))return r&ye.Host?fN(i,t,r):pN(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&ye.Optional))Mv(t);else return o}finally{nN()}}else if(typeof s=="number"){let o=null,a=hN(n,e),c=Ca,l=r&ye.Host?e[Rr][lr]:null;for((a===-1||r&ye.SkipSelf)&&(c=a===-1?Gv(n,e):e[a+8],c===Ca||!HR(r,!1)?a=-1:(o=e[be],a=jf(c),e=Bf(c,e)));a!==-1;){let d=e[be];if($R(s,a,d.data)){let h=j$(a,e,t,o,r,l);if(h!==Sr)return h}c=e[a+8],c!==Ca&&HR(r,e[be].data[a+8]===l)&&$R(s,a,e)?(o=d,a=jf(c),e=Bf(c,e)):a=-1}}return i}function j$(n,e,t,r,i,s){let o=e[be],a=o.data[n+8],c=r==null?$v(a)&&lv:r!=o&&(a.type&3)!==0,l=i&ye.Host&&s===a,d=B$(a,o,t,c,l);return d!==null?eu(e,o,d,a):Sr}function B$(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,d=s>>20,h=r?a:a+d,p=i?a+d:l;for(let _=h;_<p;_++){let w=o[_];if(_<c&&t===w||_>=c&&w.type===t)return _}if(i){let _=o[c];if(_&&su(_)&&_.type===t)return c}return null}function eu(n,e,t,r){let i=n[t],s=e.data;if(N$(i)){let o=i;o.resolving&&gB(mB(s[t]));let a=BR(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?jn(o.injectImpl):null,d=Xx(n,r,ye.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&R$(t,s[t],e)}finally{l!==null&&jn(l),BR(a),o.resolving=!1,nN()}}return i}function $$(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(ql)?n[ql]:void 0;return typeof e=="number"?e>=0?e&lN:H$:e}function $R(n,e,t){let r=1<<n;return!!(t[e+(n>>uN)]&r)}function HR(n,e){return!(n&ye.Self)&&!(n&ye.Host&&e)}var Ks=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return mN(this._tNode,this._lView,e,Zf(r),t)}};function H$(){return new Ks(dr(),sn())}function Kv(n){return ru(()=>{let e=n.prototype.constructor,t=e[Mf]||uv(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[Mf]||uv(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function uv(n){return hx(n)?()=>{let e=uv(Bn(n));return e&&e()}:Da(n)}function q$(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[le]&2048&&!(o[le]&512);){let a=gN(s,o,t,r|ye.Self,Sr);if(a!==Sr)return a;let c=s.parent;if(!c){let l=o[Fx];if(l){let d=l.get(t,Sr,r);if(d!==Sr)return d}c=_N(o),o=o[iu]}s=c}return i}function _N(n){let e=n[be],t=e.type;return t===2?e.declTNode:t===1?n[lr]:null}function Qv(n){return U$(dr(),n)}function qR(n,e=null,t=null,r){let i=yN(n,e,t,r);return i.resolveInjectorInitializers(),i}function yN(n,e=null,t=null,r,i=new Set){let s=[t||Cr,BB(n)];return r=r||(typeof n=="object"?void 0:Dn(n)),new Kl(s,e||Uv(),r||null,i)}var Nr=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return qR({name:""},i,r,"");{let s=r.name??"";return qR({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Wl,e.NULL=new Lf,e.\u0275prov=ne({token:e,providedIn:"any",factory:()=>se(Ex)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var z$="ngOriginalError";function Gy(n){return n[z$]}var xr=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Gy(e);for(;t&&Gy(t);)t=Gy(t);return t||null}},vN=new ue("",{providedIn:"root",factory:()=>K(xr).handleError.bind(void 0)}),Yv=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=W$,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),dv=class extends Yv{constructor(e){super(),this._lView=e}onDestroy(e){return Gx(this._lView,e),()=>d$(this._lView,e)}};function W$(){return new dv(sn())}function G$(){return Jv(dr(),sn())}function Jv(n,e){return new cu(ur(n,e))}var cu=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=G$;let n=e;return n})();var hv=class extends Wt{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,Lx()&&(this.destroyRef=K(Yv,{optional:!0})??void 0)}emit(e){let t=ke(null);try{super.next(e)}finally{ke(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Ky(s),i&&(i=Ky(i)),o&&(o=Ky(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Dt&&e.add(a),a}};function Ky(n){return e=>{setTimeout(n,void 0,e)}}var rn=hv;function wN(n){return(n.flags&128)===128}var IN=new Map,K$=0;function Q$(){return K$++}function Y$(n){IN.set(n[rp],n)}function J$(n){IN.delete(n[rp])}var zR="__ngContext__";function Ra(n,e){Gs(e)?(n[zR]=e[rp],Y$(e)):n[zR]=e}function EN(n){return bN(n[Yl])}function TN(n){return bN(n[ir])}function bN(n){for(;n!==null&&!gi(n);)n=n[ir];return n}var fv;function CN(n){fv=n}function X$(){if(fv!==void 0)return fv;if(typeof document<"u")return document;throw new te(210,!1)}var sp=new ue("",{providedIn:"root",factory:()=>Z$}),Z$="ng",Xv=new ue(""),Gi=new ue("",{providedIn:"platform",factory:()=>"unknown"});var Zv=new ue("",{providedIn:"root",factory:()=>X$().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var eH="h",tH="b";var nH=()=>null;function ew(n,e,t=!1){return nH(n,e,t)}var DN=!1,rH=new ue("",{providedIn:"root",factory:()=>DN});var Cf;function iH(){if(Cf===void 0&&(Cf=null,Ut.trustedTypes))try{Cf=Ut.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Cf}function sH(n){return iH()?.createScriptURL(n)||n}var Df;function oH(){if(Df===void 0&&(Df=null,Ut.trustedTypes))try{Df=Ut.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Df}function WR(n){return oH()?.createScriptURL(n)||n}var $f=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${lx})`}};function op(n){return n instanceof $f?n.changingThisBreaksApplicationSecurity:n}function tw(n,e){let t=aH(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${lx})`)}return t===e}function aH(n){return n instanceof $f&&n.getTypeName()||null}var cH=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function SN(n){return n=String(n),n.match(cH)?n:"unsafe:"+n}var ap=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(ap||{});function lH(n){let e=RN();return e?e.sanitize(ap.URL,n)||"":tw(n,"URL")?op(n):SN(Pv(n))}function uH(n){let e=RN();if(e)return WR(e.sanitize(ap.RESOURCE_URL,n)||"");if(tw(n,"ResourceURL"))return WR(op(n));throw new te(904,!1)}function _i(n){return sH(n[0])}function dH(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?uH:lH}function AN(n,e,t){return dH(e,t)(n)}function RN(){let n=sn();return n&&n[or].sanitizer}function xN(n){return n instanceof Function?n():n}function hH(n){return(n??K(Nr)).get(Gi)==="browser"}var eo=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(eo||{}),fH;function nw(n,e){return fH(n,e)}function Ea(n,e,t,r,i){if(r!=null){let s,o=!1;gi(r)?s=r:Gs(r)&&(o=!0,r=r[mi]);let a=fi(r);n===0&&t!==null?i==null?ON(e,t,a):Hf(e,t,a,i||null,!0):n===1&&t!==null?Hf(e,t,a,i||null,!0):n===2?RH(e,a,o):n===3&&e.destroyNode(a),s!=null&&NH(e,n,s,t,i)}}function pH(n,e){return n.createText(e)}function NN(n,e,t){return n.createElement(e,t)}function mH(n,e){PN(n,e),e[mi]=null,e[lr]=null}function gH(n,e,t,r,i,s){r[mi]=i,r[lr]=e,cp(n,r,t,1,i,s)}function PN(n,e){e[or].changeDetectionScheduler?.notify(1),cp(n,e,e[Sn],2,null,null)}function _H(n){let e=n[Yl];if(!e)return Qy(n[be],n);for(;e;){let t=null;if(Gs(e))t=e[Yl];else{let r=e[$n];r&&(t=r)}if(!t){for(;e&&!e[ir]&&e!==n;)Gs(e)&&Qy(e[be],e),e=e[Gt];e===null&&(e=n),Gs(e)&&Qy(e[be],e),t=e&&e[ir]}e=t}}function yH(n,e,t,r){let i=$n+r,s=t.length;r>0&&(t[i-1][ir]=e),r<s-$n?(e[ir]=t[i],Ix(t,$n+r,e)):(t.push(e),e[ir]=null),e[Gt]=t;let o=e[jv];o!==null&&t!==o&&vH(o,e);let a=e[np];a!==null&&a.insertView(n),av(e),e[le]|=128}function vH(n,e){let t=n[Uf],i=e[Gt][Gt][Rr];e[Rr]!==i&&(n[le]|=Bv.HasTransplantedViews),t===null?n[Uf]=[e]:t.push(e)}function MN(n,e){let t=n[Uf],r=t.indexOf(e);t.splice(r,1)}function pv(n,e){if(n.length<=$n)return;let t=$n+e,r=n[t];if(r){let i=r[jv];i!==null&&i!==n&&MN(i,r),e>0&&(n[t-1][ir]=r[ir]);let s=Of(n,$n+e);mH(r[be],r);let o=s[np];o!==null&&o.detachView(s[be]),r[Gt]=null,r[ir]=null,r[le]&=-129}return r}function kN(n,e){if(!(e[le]&256)){let t=e[Sn];t.destroyNode&&cp(n,e,t,3,null,null),_H(e)}}function Qy(n,e){if(e[le]&256)return;let t=ke(null);try{e[le]&=-129,e[le]|=256,e[Qs]&&JA(e[Qs]),IH(n,e),wH(n,e),e[be].type===1&&e[Sn].destroy();let r=e[jv];if(r!==null&&gi(e[Gt])){r!==e[Gt]&&MN(r,e);let i=e[np];i!==null&&i.detachView(n)}J$(e)}finally{ke(t)}}function wH(n,e){let t=n.cleanup,r=e[Ql];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[Ql]=null);let i=e[qi];if(i!==null){e[qi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function IH(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Zl)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Dr(4,a,c);try{c.call(a)}finally{Dr(5,a,c)}}else{Dr(4,i,s);try{s.call(i)}finally{Dr(5,i,s)}}}}}function EH(n,e,t){return TH(n,e.parent,t)}function TH(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[mi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===Ar.None||s===Ar.Emulated)return null}return ur(r,t)}}function Hf(n,e,t,r,i){n.insertBefore(e,t,r,i)}function ON(n,e,t){n.appendChild(e,t)}function GR(n,e,t,r,i){r!==null?Hf(n,e,t,r,i):ON(n,e,t)}function bH(n,e,t,r){n.removeChild(e,t,r)}function rw(n,e){return n.parentNode(e)}function CH(n,e){return n.nextSibling(e)}function DH(n,e,t){return AH(n,e,t)}function SH(n,e,t){return n.type&40?ur(n,t):null}var AH=SH,KR;function LN(n,e,t,r){let i=EH(n,r,e),s=e[Sn],o=r.parent||e[lr],a=DH(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)GR(s,i,t[c],a,!1);else GR(s,i,t,a,!1);KR!==void 0&&KR(s,r,e,t,i)}function Nf(n,e){if(e!==null){let t=e.type;if(t&3)return ur(e,n);if(t&4)return mv(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Nf(n,r);{let i=n[e.index];return gi(i)?mv(-1,i):fi(i)}}else{if(t&32)return nw(e,n)()||fi(n[e.index]);{let r=FN(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Xl(n[Rr]);return Nf(i,r)}else return Nf(n,e.next)}}}return null}function FN(n,e){if(e!==null){let r=n[Rr][lr],i=e.projection;return r.projection[i]}return null}function mv(n,e){let t=$n+n+1;if(t<e.length){let r=e[t],i=r[be].firstChild;if(i!==null)return Nf(r,i)}return e[Js]}function RH(n,e,t){let r=rw(n,e);r&&bH(n,r,e,t)}function iw(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],c=t.type;if(o&&e===0&&(a&&Ra(fi(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)iw(n,e,t.child,r,i,s,!1),Ea(e,n,i,a,s);else if(c&32){let l=nw(t,r),d;for(;d=l();)Ea(e,n,i,d,s);Ea(e,n,i,a,s)}else c&16?xH(n,e,r,t,i,s):Ea(e,n,i,a,s);t=o?t.projectionNext:t.next}}function cp(n,e,t,r,i,s){iw(t,r,n.firstChild,e,i,s,!1)}function xH(n,e,t,r,i,s){let o=t[Rr],c=o[lr].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];Ea(e,n,i,d,s)}else{let l=c,d=o[Gt];wN(r)&&(l.flags|=128),iw(n,e,l,d,i,s,!0)}}function NH(n,e,t,r,i){let s=t[Js],o=fi(t);s!==o&&Ea(e,n,r,s,i);for(let a=$n;a<t.length;a++){let c=t[a];cp(c[be],c,n,e,r,s)}}function PH(n,e,t){n.setAttribute(e,"style",t)}function VN(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function UN(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&tv(n,e,r),i!==null&&VN(n,e,i),s!==null&&PH(n,e,s)}var jN={};function MH(n,e,t,r){if(!r)if((e[le]&3)===3){let s=n.preOrderCheckHooks;s!==null&&Rf(e,s,t)}else{let s=n.preOrderHooks;s!==null&&xf(e,s,0,t)}Xs(t)}function yn(n,e=ye.Default){let t=sn();if(t===null)return se(n,e);let r=dr();return mN(r,t,Bn(n),e)}function BN(){let n="invalid";throw new Error(n)}function $N(n,e,t,r,i,s){let o=ke(null);try{let a=null;i&sr.SignalBased&&(a=e[r][GA]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&sr.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):Bx(e,a,r,s)}finally{ke(o)}}function kH(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Xs(~i);else{let s=i,o=t[++r],a=t[++r];T$(o,s);let c=e[s];a(2,c)}}}finally{Xs(-1)}}function sw(n,e,t,r,i,s,o,a,c,l,d){let h=e.blueprint.slice();return h[mi]=i,h[le]=r|4|128|8|64,(l!==null||n&&n[le]&2048)&&(h[le]|=2048),Wx(h),h[Gt]=h[iu]=n,h[hi]=t,h[or]=o||n&&n[or],h[Sn]=a||n&&n[Sn],h[Aa]=c||n&&n[Aa]||null,h[lr]=s,h[rp]=Q$(),h[Ff]=d,h[Fx]=l,h[Rr]=e.type==2?n[Rr]:h,h}function ow(n,e,t,r,i){let s=n.data[e];if(s===null)s=OH(n,e,t,r,i),E$()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=y$();s.injectorIndex=o===null?-1:o.injectorIndex}return ip(s,!0),s}function OH(n,e,t,r,i){let s=Qx(),o=Yx(),a=o?s:s&&s.parent,c=n.data[e]=$H(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function HN(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function qN(n,e,t,r,i){let s=D$(),o=r&2;try{Xs(-1),o&&e.length>Ys&&MH(n,e,Ys,!1),Dr(o?2:0,i),t(r,i)}finally{Xs(s),Dr(o?3:1,i)}}function zN(n,e,t){if(Ux(e)){let r=ke(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{ke(r)}}}function LH(n,e,t){Kx()&&(GH(n,e,t,ur(t,e)),(t.flags&64)===64&&QN(n,e,t))}function FH(n,e,t=ur){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function WN(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=GN(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function GN(n,e,t,r,i,s,o,a,c,l,d){let h=Ys+r,p=h+i,_=VH(h,p),w=typeof l=="function"?l():l;return _[be]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:d}}function VH(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:jN);return t}function UH(n,e,t,r){let s=r.get(rH,DN)||t===Ar.ShadowDom,o=n.selectRootElement(e,s);return jH(o),o}function jH(n){BH(n)}var BH=()=>null;function $H(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return m$()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function QR(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=sr.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?YR(r,t,l,a,c):YR(r,t,l,a)}return r}function YR(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function HH(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,l=null;for(let d=r;d<i;d++){let h=s[d],p=t?t.get(h):null,_=p?p.inputs:null,w=p?p.outputs:null;c=QR(0,h.inputs,d,c,_),l=QR(1,h.outputs,d,l,w);let b=c!==null&&o!==null&&!Fv(e)?i4(c,d,o):null;a.push(b)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function qH(n,e,t,r){if(Kx()){let i=r===null?null:{"":-1},s=QH(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&KN(n,e,t,o,i,a),i&&YH(t,r,i)}t.mergedAttrs=Lv(t.mergedAttrs,t.attrs)}function KN(n,e,t,r,i,s){for(let l=0;l<r.length;l++)V$(dN(t,e),n,r[l].type);XH(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=HN(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=Lv(t.mergedAttrs,d.hostAttrs),ZH(n,t,e,c,d),JH(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}HH(n,t,s)}function zH(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;WH(o)!=a&&o.push(a),o.push(t,r,s)}}function WH(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function GH(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;$v(t)&&e4(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||dN(t,e),Ra(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],l=eu(e,n,a,t);if(Ra(l,e),o!==null&&r4(e,a-i,l,c,t,o),su(c)){let d=Zs(t.index,e);d[hi]=eu(e,n,a,t)}}}function QN(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=b$();try{Xs(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];cv(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&KH(c,l)}}finally{Xs(-1),cv(o)}}function KH(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function QH(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(PB(e,o.selectors,!1))if(r||(r=[]),su(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;gv(n,e,c)}else r.unshift(o),gv(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function gv(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function YH(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new te(-301,!1);r.push(e[i],s)}}}function JH(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;su(e)&&(t[""]=n)}}function XH(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function ZH(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Da(i.type,!0)),o=new Zl(s,su(i),yn);n.blueprint[r]=o,t[r]=o,zH(n,e,r,HN(n,t,i.hostVars,jN),i)}function e4(n,e,t){let r=ur(e,n),i=WN(t),s=n[or].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=aw(n,sw(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function t4(n,e,t,r,i,s){let o=ur(n,e);n4(e[Sn],o,s,n.value,t,r,i)}function n4(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?Pv(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function r4(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],d=o[a++],h=o[a++];$N(r,t,c,l,d,h)}}function i4(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function s4(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function YN(n,e){let t=n.contentQueries;if(t!==null){let r=ke(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];Jx(s),a.contentQueries(2,e[o],o)}}}finally{ke(r)}}}function aw(n,e){return n[Yl]?n[FR][ir]=e:n[Yl]=e,n[FR]=e,e}function _v(n,e,t){Jx(0);let r=ke(null);try{e(n,t)}finally{ke(r)}}function o4(n){return n[Ql]||(n[Ql]=[])}function a4(n){return n.cleanup||(n.cleanup=[])}function JN(n,e){let t=n[Aa],r=t?t.get(xr,null):null;r&&r.handleError(e)}function XN(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],d=n.data[o];$N(d,l,r,a,c,i)}}function c4(n,e){let t=Zs(e,n),r=t[be];l4(r,t);let i=t[mi];i!==null&&t[Ff]===null&&(t[Ff]=ew(i,t[Aa])),ZN(r,t,t[hi])}function l4(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function ZN(n,e,t){zv(e);try{let r=n.viewQuery;r!==null&&_v(1,r,t);let i=n.template;i!==null&&qN(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[np]?.finishViewCreation(n),n.staticContentQueries&&YN(n,e),n.staticViewQueries&&_v(2,n.viewQuery,t);let s=n.components;s!==null&&u4(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[le]&=-5,Wv()}}function u4(n,e){for(let t=0;t<e.length;t++)c4(n,e[t])}function JR(n,e){return!e||e.firstChild===null||wN(n)}function d4(n,e,t,r=!0){let i=e[be];if(yH(i,e,n,t),r){let o=mv(t,n),a=e[Sn],c=rw(a,n[Js]);c!==null&&gH(i,n[lr],a,e,c,o)}let s=e[Ff];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function qf(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(fi(s)),gi(s)&&h4(s,r);let o=t.type;if(o&8)qf(n,e,t.child,r);else if(o&32){let a=nw(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=FN(e,t);if(Array.isArray(a))r.push(...a);else{let c=Xl(e[Rr]);qf(c[be],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function h4(n,e){for(let t=$n;t<n.length;t++){let r=n[t],i=r[be].firstChild;i!==null&&qf(r[be],r,i,e)}n[Js]!==n[mi]&&e.push(n[Js])}var eP=[];function f4(n){return n[Qs]??p4(n)}function p4(n){let e=eP.pop()??Object.create(g4);return e.lView=n,e}function m4(n){n.lView[Qs]!==n&&(n.lView=null,eP.push(n))}var g4=it(X({},KA),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Jl(n.lView)},consumerOnSignalRead(){this.lView[Qs]=this}}),tP=100;function nP(n,e=!0,t=0){let r=n[or],i=r.rendererFactory,s=!1;s||i.begin?.();try{_4(n,t)}catch(o){throw e&&JN(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function _4(n,e){yv(n,e);let t=0;for(;qv(n);){if(t===tP)throw new te(103,!1);t++,yv(n,1)}}function y4(n,e,t,r){let i=e[le];if((i&256)===256)return;let s=!1;!s&&e[or].inlineEffectRunner?.flush(),zv(e);let o=null,a=null;!s&&v4(n)&&(a=f4(e),o=QA(a));try{Wx(e),w$(n.bindingStartIndex),t!==null&&qN(n,e,t,2,r);let c=(i&3)===3;if(!s)if(c){let h=n.preOrderCheckHooks;h!==null&&Rf(e,h,null)}else{let h=n.preOrderHooks;h!==null&&xf(e,h,0,null),zy(e,0)}if(w4(e),rP(e,0),n.contentQueries!==null&&YN(n,e),!s)if(c){let h=n.contentCheckHooks;h!==null&&Rf(e,h)}else{let h=n.contentHooks;h!==null&&xf(e,h,1),zy(e,1)}kH(n,e);let l=n.components;l!==null&&sP(e,l,0);let d=n.viewQuery;if(d!==null&&_v(2,d,r),!s)if(c){let h=n.viewCheckHooks;h!==null&&Rf(e,h)}else{let h=n.viewHooks;h!==null&&xf(e,h,2),zy(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[qy]){for(let h of e[qy])h();e[qy]=null}s||(e[le]&=-73)}catch(c){throw Jl(e),c}finally{a!==null&&(YA(a,o),m4(a)),Wv()}}function v4(n){return n.type!==2}function rP(n,e){for(let t=EN(n);t!==null;t=TN(t))for(let r=$n;r<t.length;r++){let i=t[r];iP(i,e)}}function w4(n){for(let e=EN(n);e!==null;e=TN(e)){if(!(e[le]&Bv.HasTransplantedViews))continue;let t=e[Uf];for(let r=0;r<t.length;r++){let i=t[r],s=i[Gt];u$(i)}}}function I4(n,e,t){let r=Zs(e,n);iP(r,t)}function iP(n,e){Hv(n)&&yv(n,e)}function yv(n,e){let r=n[be],i=n[le],s=n[Qs],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Cy(s)),s&&(s.dirty=!1),n[le]&=-9217,o)y4(r,n,r.template,n[hi]);else if(i&8192){rP(n,1);let a=r.components;a!==null&&sP(n,a,1)}}function sP(n,e,t){for(let r=0;r<e.length;r++)I4(n,e[r],t)}function cw(n){for(n[or].changeDetectionScheduler?.notify();n;){n[le]|=64;let e=Xl(n);if(t$(n)&&!e)return n;n=e}return null}var xa=class{get rootNodes(){let e=this._lView,t=e[be];return qf(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[hi]}set context(e){this._lView[hi]=e}get destroyed(){return(this._lView[le]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Gt];if(gi(e)){let t=e[Vf],r=t?t.indexOf(this):-1;r>-1&&(pv(e,r),Of(t,r))}this._attachedToViewContainer=!1}kN(this._lView[be],this._lView)}onDestroy(e){Gx(this._lView,e)}markForCheck(){cw(this._cdRefInjectingView||this._lView)}detach(){this._lView[le]&=-129}reattach(){av(this._lView),this._lView[le]|=128}detectChanges(){this._lView[le]|=1024,nP(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new te(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,PN(this._lView[be],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new te(902,!1);this._appRef=e,av(this._lView)}};var dre=new RegExp(`^(\\d+)*(${tH}|${eH})*(.*)`);var E4=()=>null;function XR(n,e){return E4(n,e)}var zf=class{},vv=class{},Wf=class{};function T4(n){let e=Error(`No component factory found for ${Dn(n)}.`);return e[b4]=n,e}var b4="ngComponent";var wv=class{resolveComponentFactory(e){throw T4(e)}},lp=(()=>{let e=class e{};e.NULL=new wv;let n=e;return n})(),tu=class{},up=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>C4();let n=e;return n})();function C4(){let n=sn(),e=dr(),t=Zs(e.index,n);return(Gs(t)?t:n)[Sn]}var D4=(()=>{let e=class e{};e.\u0275prov=ne({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),Yy={};var ZR=new Set;function lw(n){ZR.has(n)||(ZR.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function ex(...n){}function S4(){let n=typeof Ut.requestAnimationFrame=="function",e=Ut[n?"requestAnimationFrame":"setTimeout"],t=Ut[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var $e=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new rn(!1),this.onMicrotaskEmpty=new rn(!1),this.onStable=new rn(!1),this.onError=new rn(!1),typeof Zone>"u")throw new te(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=S4().nativeRequestAnimationFrame,x4(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new te(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new te(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,A4,ex,ex);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},A4={};function uw(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function R4(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Ut,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Iv(n),n.isCheckStableRunning=!0,uw(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Iv(n))}function x4(n){let e=()=>{R4(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(N4(a))return t.invokeTask(i,s,o,a);try{return tx(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),nx(n)}},onInvoke:(t,r,i,s,o,a,c)=>{try{return tx(n),t.invoke(i,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),nx(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Iv(n),uw(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Iv(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function tx(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function nx(n){n._nesting--,uw(n)}var Ev=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new rn,this.onMicrotaskEmpty=new rn,this.onStable=new rn,this.onError=new rn}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function N4(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}function P4(n="zone.js",e){return n==="noop"?new Ev:n==="zone.js"?new $e(e):n}var Ta=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Ta||{}),M4={destroy(){}};function dp(n,e){!e&&XB(dp);let t=e?.injector??K(Nr);if(!hH(t))return M4;lw("NgAfterNextRender");let r=t.get(dw),i=r.handler??=new bv,s=e?.phase??Ta.MixedReadWrite,o=()=>{i.unregister(c),a()},a=t.get(Yv).onDestroy(o),c=pi(t,()=>new Tv(s,()=>{o(),n()}));return i.register(c),{destroy:o}}var Tv=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=K($e),this.errorHandler=K(xr,{optional:!0}),K(zf,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},bv=class{constructor(){this.executingCallbacks=!1,this.buckets={[Ta.EarlyRead]:new Set,[Ta.Write]:new Set,[Ta.MixedReadWrite]:new Set,[Ta.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},dw=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=ne({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function Cv(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=SR(i,a);else if(s==2){let c=a,l=e[++o];r=SR(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Gf=class extends lp{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=zi(e);return new Na(t,this.ngModule)}};function rx(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function k4(n){let e=n.toLowerCase();return e==="svg"?s$:e==="math"?o$:null}var Dv=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Zf(r);let i=this.injector.get(e,Yy,r);return i!==Yy||t===Yy?i:this.parentInjector.get(e,t,r)}},Na=class extends Wf{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=rx(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return rx(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=LB(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=ke(null);try{i=i||this.ngModule;let o=i instanceof _n?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Dv(e,o):e,c=a.get(tu,null);if(c===null)throw new te(407,!1);let l=a.get(D4,null),d=a.get(dw,null),h=a.get(zf,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},_=c.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",b=r?UH(_,r,this.componentDef.encapsulation,a):NN(_,w,k4(w)),R=512;this.componentDef.signals?R|=4096:this.componentDef.onPush||(R|=16);let L=null;b!==null&&(L=ew(b,a,!0));let H=GN(0,null,null,1,0,null,null,null,null,null,null),U=sw(null,H,null,R,null,null,p,_,a,null,L);zv(U);let Q,ie;try{let J=this.componentDef,T,v=null;J.findHostDirectiveDefs?(T=[],v=new Map,J.findHostDirectiveDefs(J,T,v),T.push(J)):T=[J];let I=O4(U,b),C=L4(I,b,J,T,U,p,_);ie=zx(H,Ys),b&&U4(_,J,b,r),t!==void 0&&j4(ie,this.ngContentSelectors,t),Q=V4(C,J,T,v,U,[B4]),ZN(H,U,null)}finally{Wv()}return new Sv(this.componentType,Q,Jv(ie,U),U,ie)}finally{ke(s)}}},Sv=class extends vv{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new xa(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;XN(s[be],s,i,e,t),this.previousInputValues.set(e,t);let o=Zs(this._tNode.index,s);cw(o)}}get injector(){return new Ks(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function O4(n,e){let t=n[be],r=Ys;return n[r]=e,ow(t,r,2,"#host",null)}function L4(n,e,t,r,i,s,o){let a=i[be];F4(r,n,e,o);let c=null;e!==null&&(c=ew(e,i[Aa]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let h=sw(i,WN(t),null,d,i[n.index],n,s,l,null,null,c);return a.firstCreatePass&&gv(a,n,r.length-1),aw(i,h),i[n.index]=h}function F4(n,e,t,r){for(let i of n)e.mergedAttrs=Lv(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(Cv(e,e.mergedAttrs,!0),t!==null&&UN(r,t,e))}function V4(n,e,t,r,i,s){let o=dr(),a=i[be],c=ur(o,i);KN(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let h=o.directiveStart+d,p=eu(i,a,h,o);Ra(p,i)}QN(a,i,o),c&&Ra(c,i);let l=eu(i,a,o.directiveStart+o.componentOffset,o);if(n[hi]=i[hi]=l,s!==null)for(let d of s)d(l,e);return zN(a,o,i),l}function U4(n,e,t,r){if(r)tv(n,t,["ng-version","17.3.12"]);else{let{attrs:i,classes:s}=FB(e.selectors[0]);i&&tv(n,t,i),s&&s.length>0&&VN(n,t,s.join(" "))}}function j4(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function B4(){let n=dr();oN(sn()[be],n)}var hp=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=$4;let n=e;return n})();function $4(){let n=dr();return q4(n,sn())}var H4=hp,oP=class extends H4{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Jv(this._hostTNode,this._hostLView)}get injector(){return new Ks(this._hostTNode,this._hostLView)}get parentInjector(){let e=Gv(this._hostTNode,this._hostLView);if(cN(e)){let t=Bf(e,this._hostLView),r=jf(e),i=t[be].data[r+8];return new Ks(i,t)}else return new Ks(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=ix(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-$n}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=XR(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,JR(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!e$(e),a;if(o)a=t;else{let w=t||{};a=w.index,r=w.injector,i=w.projectableNodes,s=w.environmentInjector||w.ngModuleRef}let c=o?e:new Na(zi(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let b=(o?l:this.parentInjector).get(_n,null);b&&(s=b)}let d=zi(c.componentType??{}),h=XR(this._lContainer,d?.id??null),p=h?.firstChild??null,_=c.create(l,i,p,s);return this.insertImpl(_.hostView,a,JR(this._hostTNode,h)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(l$(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Gt],l=new oP(c,c[lr],c[Gt]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return d4(o,i,s,r),e.attachToViewContainerRef(),Ix(Jy(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=ix(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=pv(this._lContainer,t);r&&(Of(Jy(this._lContainer),t),kN(r[be],r))}detach(e){let t=this._adjustIndex(e,-1),r=pv(this._lContainer,t);return r&&Of(Jy(this._lContainer),t)!=null?new xa(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function ix(n){return n[Vf]}function Jy(n){return n[Vf]||(n[Vf]=[])}function q4(n,e){let t,r=e[n.index];return gi(r)?t=r:(t=s4(r,e,null,n),e[n.index]=t,aw(e,t)),W4(t,e,n,r),new oP(t,n,e)}function z4(n,e){let t=n[Sn],r=t.createComment(""),i=ur(e,n),s=rw(t,i);return Hf(t,s,r,CH(t,i),!1),r}var W4=G4;function G4(n,e,t,r){if(n[Js])return;let i;t.type&8?i=fi(r):i=z4(e,t),n[Js]=i}function K4(n){let e=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=n(i);t.set(i,s=o.then(X4))}return s}return Kf.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,d=i.styleUrls;i.styleUrls.forEach((h,p)=>{a.push(""),o.push(r(h).then(_=>{a[l+p]=_,d.splice(d.indexOf(h),1),d.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>Z4(s));e.push(c)}),Y4(),Promise.all(e).then(()=>{})}var Kf=new Map,Q4=new Set;function Y4(){let n=Kf;return Kf=new Map,n}function J4(){return Kf.size===0}function X4(n){return typeof n=="string"?n:n.text()}function Z4(n){Q4.delete(n)}function hw(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var Wi=class{},nu=class{};var Qf=class extends Wi{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Gf(this);let i=xx(e);this._bootstrapComponents=xN(i.bootstrap),this._r3Injector=yN(e,t,[{provide:Wi,useValue:this},{provide:lp,useValue:this.componentFactoryResolver},...r],Dn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Yf=class extends nu{constructor(e){super(),this.moduleType=e}create(e){return new Qf(this.moduleType,e,[])}};function eq(n,e,t){return new Qf(n,e,t)}var Av=class extends Wi{constructor(e){super(),this.componentFactoryResolver=new Gf(this),this.instance=null;let t=new Kl([...e.providers,{provide:Wi,useValue:this},{provide:lp,useValue:this.componentFactoryResolver}],e.parent||Uv(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function fp(n,e,t=null){return new Av({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var pp=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Ft(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function tq(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function nq(n){return(n.flags&32)===32}function fw(n,e,t,r){let i=sn(),s=I$();if(tq(i,s,e)){let o=au(),a=S$();t4(a,i,n,e,t,r)}return fw}function sx(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";XN(n,t,s[o],o,r)}function rq(n,e,t,r,i,s){let o=e.consts,a=UR(o,i),c=ow(e,n,2,r,a);return qH(e,t,c,UR(o,s)),c.attrs!==null&&Cv(c,c.attrs,!1),c.mergedAttrs!==null&&Cv(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function S(n,e,t,r){let i=sn(),s=au(),o=Ys+n,a=i[Sn],c=s.firstCreatePass?rq(o,s,i,e,t,r):s.data[o],l=iq(s,i,c,a,e,n);i[o]=l;let d=jx(c);return ip(c,!0),UN(a,l,c),!nq(c)&&iN()&&LN(s,i,l,c),h$()===0&&Ra(l,i),f$(),d&&(LH(s,i,c),zN(s,c,i)),r!==null&&FH(i,c),S}function x(){let n=dr();Yx()?v$():(n=n.parent,ip(n,!1));let e=n;g$(e)&&_$(),p$();let t=au();return t.firstCreatePass&&(oN(t,n),Ux(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&P$(e)&&sx(t,e,sn(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&M$(e)&&sx(t,e,sn(),e.stylesWithoutHost,!1),x}function q(n,e,t,r){return S(n,e,t,r),x(),q}var iq=(n,e,t,r,i,s)=>(sN(!0),NN(r,i,A$()));var Jf="en-US";var sq=Jf;function oq(n){typeof n=="string"&&(sq=n.toLowerCase().replace(/_/g,"-"))}function he(n,e,t,r){let i=sn(),s=au(),o=dr();return cq(s,i,i[Sn],o,n,e,r),he}function aq(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[Ql],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function cq(n,e,t,r,i,s,o){let a=jx(r),l=n.firstCreatePass&&a4(n),d=e[hi],h=o4(e),p=!0;if(r.type&3||o){let b=ur(r,e),R=o?o(b):b,L=h.length,H=o?Q=>o(fi(Q[r.index])):r.index,U=null;if(!o&&a&&(U=aq(n,e,i,r.index)),U!==null){let Q=U.__ngLastListenerFn__||U;Q.__ngNextListenerFn__=s,U.__ngLastListenerFn__=s,p=!1}else{s=ax(r,e,d,s,!1);let Q=t.listen(R,i,s);h.push(s,Q),l&&l.push(i,H,L,L+1)}}else s=ax(r,e,d,s,!1);let _=r.outputs,w;if(p&&_!==null&&(w=_[i])){let b=w.length;if(b)for(let R=0;R<b;R+=2){let L=w[R],H=w[R+1],ie=e[L][H].subscribe(s),J=h.length;h.push(s,ie),l&&l.push(i,r.index,J,-(J+1))}}}function ox(n,e,t,r){let i=ke(null);try{return Dr(6,e,t),t(r)!==!1}catch(s){return JN(n,s),!1}finally{Dr(7,e,t),ke(i)}}function ax(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?Zs(n.index,e):e;cw(a);let c=ox(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)c=ox(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function O(n,e=""){let t=sn(),r=au(),i=n+Ys,s=r.firstCreatePass?ow(r,i,1,e,null):r.data[i],o=lq(r,t,s,e,n);t[i]=o,iN()&&LN(r,t,o,s),ip(s,!1)}var lq=(n,e,t,r,i)=>(sN(!0),pH(e[Sn],r));var uq=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=Mx(!1,r.type),s=i.length>0?fp([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=ne({token:e,providedIn:"environment",factory:()=>new e(se(_n))});let n=e;return n})();function aP(n){lw("NgStandalone"),n.getStandaloneInjector=e=>e.get(uq).getOrCreateStandaloneInjector(n)}var Sf=null;function dq(n){Sf!==null&&(n.defaultEncapsulation!==Sf.defaultEncapsulation||n.preserveWhitespaces!==Sf.preserveWhitespaces)||(Sf=n)}var mp=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var pw=new ue(""),lu=new ue(""),gp=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,mw||(hq(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{$e.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(se($e),se(_p),se(lu))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),_p=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return mw?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();function hq(n){mw=n}var mw;function uu(n){return!!n&&typeof n.then=="function"}function cP(n){return!!n&&typeof n.subscribe=="function"}var yp=new ue(""),lP=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=K(yp,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(uu(o))r.push(o);else if(cP(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),gw=new ue("");function fq(){XA(()=>{throw new te(600,!1)})}function pq(n){return n.isBoundToModule}function mq(n,e,t){try{let r=t();return uu(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function uP(n,e){return Array.isArray(e)?e.reduce(uP,n):X(X({},n),e)}var Pa=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=K(vN),this.afterRenderEffectManager=K(dw),this.externalTestViews=new Set,this.beforeRender=new Wt,this.afterTick=new Wt,this.componentTypes=[],this.components=[],this.isStable=K(pp).hasPendingTasks.pipe(Te(r=>!r)),this._injector=K(_n)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Wf;if(!this._injector.get(lP).done){let _=!s&&Rx(r),w=!1;throw new te(405,w)}let a;s?a=r:a=this._injector.get(lp).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=pq(a)?void 0:this._injector.get(Wi),l=i||a.selector,d=a.create(Nr.NULL,[],l,c),h=d.location.nativeElement,p=d.injector.get(pw,null);return p?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),Pf(this.components,d),p?.unregisterApplication(h)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new te(101,!1);let i=ke(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,ke(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===tP)throw new te(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)gq(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Rv(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Rv(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Pf(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(gw,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Pf(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new te(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Pf(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function gq(n,e,t){!e&&!Rv(n)||_q(n,t,e)}function Rv(n){return qv(n)}function _q(n,e,t){let r;t?(r=0,n[le]|=1024):n[le]&64?r=0:r=1,nP(n,e,r)}var xv=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},vp=(()=>{let e=class e{compileModuleSync(r){return new Yf(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=xx(r),o=xN(s.declarations).reduce((a,c)=>{let l=zi(c);return l&&a.push(new Na(l)),a},[]);return new xv(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),yq=new ue("");function vq(n,e,t){let r=new Yf(t);return Promise.resolve(r)}function cx(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var wq=(()=>{let e=class e{constructor(){this.zone=K($e),this.applicationRef=K(Pa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Iq(n){return[{provide:$e,useFactory:n},{provide:Sa,multi:!0,useFactory:()=>{let e=K(wq,{optional:!0});return()=>e.initialize()}},{provide:Sa,multi:!0,useFactory:()=>{let e=K(bq);return()=>{e.initialize()}}},{provide:vN,useFactory:Eq}]}function Eq(){let n=K($e),e=K(xr);return t=>n.runOutsideAngular(()=>e.handleError(t))}function Tq(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var bq=(()=>{let e=class e{constructor(){this.subscription=new Dt,this.initialized=!1,this.zone=K($e),this.pendingTasks=K(pp)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{$e.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{$e.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Cq(){return typeof $localize<"u"&&$localize.locale||Jf}var _w=new ue("",{providedIn:"root",factory:()=>K(_w,ye.Optional|ye.SkipSelf)||Cq()});var dP=new ue(""),hP=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=P4(i?.ngZone,Tq({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=eq(r.moduleType,this.injector,Iq(()=>s)),a=o.injector.get(xr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{Pf(this._modules,o),c.unsubscribe()})}),mq(a,s,()=>{let c=o.injector.get(lP);return c.runInitializers(),c.donePromise.then(()=>{let l=o.injector.get(_w,Jf);return oq(l||Jf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=uP({},i);return vq(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(Pa);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new te(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new te(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(dP,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(se(Nr))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),zl=null,fP=new ue("");function Dq(n){if(zl&&!zl.get(fP,!1))throw new te(400,!1);fq(),zl=n;let e=n.get(hP);return Rq(n),e}function yw(n,e,t=[]){let r=`Platform: ${e}`,i=new ue(r);return(s=[])=>{let o=pP();if(!o||o.injector.get(fP,!1)){let a=[...t,...s,{provide:i,useValue:!0}];n?n(a):Dq(Sq(a,r))}return Aq(i)}}function Sq(n=[],e){return Nr.create({name:e,providers:[{provide:tp,useValue:"platform"},{provide:dP,useValue:new Set([()=>zl=null])},...n]})}function Aq(n){let e=pP();if(!e)throw new te(401,!1);return e}function pP(){return zl?.get(hP)??null}function Rq(n){n.get(Xv,null)?.forEach(t=>t())}var du=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=xq;let n=e;return n})();function xq(n){return Nq(dr(),sn(),(n&16)===16)}function Nq(n,e,t){if($v(n)&&!t){let r=Zs(n.index,e);return new xa(r,r)}else if(n.type&47){let r=e[Rr];return new xa(r,e)}return null}var mP=yw(null,"core",[]),gP=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(se(Pa))},e.\u0275mod=cr({type:e}),e.\u0275inj=ar({});let n=e;return n})();function hu(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function _P(n){let e=zi(n);if(!e)return null;let t=new Na(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var IP=null;function to(){return IP}function EP(n){IP??=n}var wp=class{};var vn=new ue(""),Iw=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>K(Pq),providedIn:"platform"});let n=e;return n})(),TP=new ue(""),Pq=(()=>{let e=class e extends Iw{constructor(){super(),this._doc=K(vn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return to().getBaseHref(this._doc)}onPopState(r){let i=to().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=to().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function Ew(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function yP(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function yi(n){return n&&n[0]!=="?"?"?"+n:n}var hr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>K(Tw),providedIn:"root"});let n=e;return n})(),bP=new ue(""),Tw=(()=>{let e=class e extends hr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??K(vn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return Ew(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+yi(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+yi(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+yi(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(se(Iw),se(bP,8))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ep=(()=>{let e=class e extends hr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=Ew(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+yi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+yi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(se(Iw),se(bP,8))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Ma=(()=>{let e=class e{constructor(r){this._subject=new rn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=Oq(yP(vP(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+yi(i))}normalize(r){return e.stripTrailingSlash(kq(this._basePath,vP(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+yi(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+yi(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=yi,e.joinWithSlash=Ew,e.stripTrailingSlash=yP,e.\u0275fac=function(i){return new(i||e)(se(hr))},e.\u0275prov=ne({token:e,factory:()=>Mq(),providedIn:"root"});let n=e;return n})();function Mq(){return new Ma(se(hr))}function kq(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function vP(n){return n.replace(/\/index.html$/,"")}function Oq(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function CP(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var DP=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=cr({type:e}),e.\u0275inj=ar({});let n=e;return n})(),bw="browser",Lq="server";function Fq(n){return n===bw}function Cw(n){return n===Lq}var SP=(()=>{let e=class e{};e.\u0275prov=ne({token:e,providedIn:"root",factory:()=>Fq(K(Gi))?new vw(K(vn),window):new ww});let n=e;return n})(),vw=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=Vq(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function Vq(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var ww=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Ip=class{};var Aw=class extends wp{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Rw=class n extends Aw{static makeCurrent(){EP(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Bq();return t==null?null:$q(t)}resetBaseElement(){fu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return CP(document.cookie,e)}},fu=null;function Bq(){return fu=fu||document.querySelector("base"),fu?fu.getAttribute("href"):null}function $q(n){return new URL(n,document.baseURI).pathname}var xw=class{addToWindow(e){Ut.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new te(5103,!1);return s},Ut.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ut.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=Ut.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Ut.frameworkStabilizers||(Ut.frameworkStabilizers=[]),Ut.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?to().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},Hq=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Nw=new ue(""),NP=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new te(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(se(Nw),se($e))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Tp=class{constructor(e){this._doc=e}},Dw="ng-app-id",PP=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Cw(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${Dw}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(Dw),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Dw,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(se(vn),se(sp),se(Zv,8),se(Gi))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Sw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Mw=/%COMP%/g,MP="%COMP%",qq=`_nghost-${MP}`,zq=`_ngcontent-${MP}`,Wq=!0,Gq=new ue("",{providedIn:"root",factory:()=>Wq});function Kq(n){return zq.replace(Mw,n)}function Qq(n){return qq.replace(Mw,n)}function kP(n,e){return e.map(t=>t.replace(Mw,n))}var AP=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=Cw(c),this.defaultRenderer=new pu(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Ar.ShadowDom&&(i=it(X({},i),{encapsulation:Ar.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof bp?s.applyToHost(r):s instanceof mu&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(i.encapsulation){case Ar.Emulated:o=new bp(l,d,i,this.appId,h,a,c,p);break;case Ar.ShadowDom:return new Pw(l,d,r,i,a,c,this.nonce,p);default:o=new mu(l,d,i,h,a,c,p);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(se(NP),se(PP),se(sp),se(Gq),se(vn),se(Gi),se($e),se(Zv))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),pu=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Sw[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(RP(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(RP(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new te(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=Sw[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Sw[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(eo.DashCase|eo.Important)?e.style.setProperty(t,r,i&eo.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&eo.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=to().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function RP(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Pw=class extends pu{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=kP(i.id,i.styles);for(let d of l){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},mu=class extends pu{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?kP(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},bp=class extends mu{constructor(e,t,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,t,r,s,o,a,c,l),this.contentAttr=Kq(l),this.hostAttr=Qq(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},Yq=(()=>{let e=class e extends Tp{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(se(vn))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),xP=["alt","control","meta","shift"],Jq={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Xq={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Zq=(()=>{let e=class e extends Tp{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>to().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),xP.forEach(d=>{let h=i.indexOf(d);h>-1&&(i.splice(h,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=Jq[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),xP.forEach(a=>{if(a!==s){let c=Xq[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(se(vn))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})();function ez(){Rw.makeCurrent()}function tz(){return new xr}function nz(){return CN(document),document}var rz=[{provide:Gi,useValue:bw},{provide:Xv,useValue:ez,multi:!0},{provide:vn,useFactory:nz,deps:[]}],OP=yw(mP,"browser",rz),iz=new ue(""),sz=[{provide:lu,useClass:xw,deps:[]},{provide:pw,useClass:gp,deps:[$e,_p,lu]},{provide:gp,useClass:gp,deps:[$e,_p,lu]}],oz=[{provide:tp,useValue:"root"},{provide:xr,useFactory:tz,deps:[]},{provide:Nw,useClass:Yq,multi:!0,deps:[vn,$e,Gi]},{provide:Nw,useClass:Zq,multi:!0,deps:[vn]},AP,PP,NP,{provide:tu,useExisting:AP},{provide:Ip,useClass:Hq,deps:[]},[]],LP=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:sp,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(se(iz,12))},e.\u0275mod=cr({type:e}),e.\u0275inj=ar({providers:[...oz,...sz],imports:[DP,gP]});let n=e;return n})();var FP=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(se(vn))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var pe="primary",xu=Symbol("RouteTitle"),Vw=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Va(n){return new Vw(n)}function az(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function cz(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Pr(n[t],e[t]))return!1;return!0}function Pr(n,e){let t=n?Uw(n):void 0,r=e?Uw(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!GP(n[i],e[i]))return!1;return!0}function Uw(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function GP(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function KP(n){return n.length>0?n[n.length-1]:null}function Ji(n){return Fy(n)?n:uu(n)?ut(Promise.resolve(n)):oe(n)}var lz={exact:YP,subset:JP},QP={exact:uz,subset:dz,ignored:()=>!0};function UP(n,e,t){return lz[t.paths](n.root,e.root,t.matrixParams)&&QP[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function uz(n,e){return Pr(n,e)}function YP(n,e,t){if(!ro(n.segments,e.segments)||!Sp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!YP(n.children[r],e.children[r],t))return!1;return!0}function dz(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>GP(n[t],e[t]))}function JP(n,e,t){return XP(n,e,e.segments,t)}function XP(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!ro(i,t)||e.hasChildren()||!Sp(i,t,r))}else if(n.segments.length===t.length){if(!ro(n.segments,t)||!Sp(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!JP(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!ro(n.segments,i)||!Sp(n.segments,i,r)||!n.children[pe]?!1:XP(n.children[pe],e,s,r)}}function Sp(n,e,t){return e.every((r,i)=>QP[t](n[i].parameters,r.parameters))}var Ki=class{constructor(e=new Me([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Va(this.queryParams),this._queryParamMap}toString(){return pz.serialize(this)}},Me=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ap(this)}},no=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Va(this.parameters),this._parameterMap}toString(){return eM(this)}};function hz(n,e){return ro(n,e)&&n.every((t,r)=>Pr(t.parameters,e[r].parameters))}function ro(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function fz(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===pe&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==pe&&(t=t.concat(e(i,r)))}),t}var Nu=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>new Eu,providedIn:"root"});let n=e;return n})(),Eu=class{parse(e){let t=new Bw(e);return new Ki(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${gu(e.root,!0)}`,r=_z(e.queryParams),i=typeof e.fragment=="string"?`#${mz(e.fragment)}`:"";return`${t}${r}${i}`}},pz=new Eu;function Ap(n){return n.segments.map(e=>eM(e)).join("/")}function gu(n,e){if(!n.hasChildren())return Ap(n);if(e){let t=n.children[pe]?gu(n.children[pe],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==pe&&r.push(`${i}:${gu(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=fz(n,(r,i)=>i===pe?[gu(n.children[pe],!1)]:[`${i}:${gu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[pe]!=null?`${Ap(n)}/${t[0]}`:`${Ap(n)}/(${t.join("//")})`}}function ZP(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Cp(n){return ZP(n).replace(/%3B/gi,";")}function mz(n){return encodeURI(n)}function jw(n){return ZP(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Rp(n){return decodeURIComponent(n)}function jP(n){return Rp(n.replace(/\+/g,"%20"))}function eM(n){return`${jw(n.path)}${gz(n.parameters)}`}function gz(n){return Object.entries(n).map(([e,t])=>`;${jw(e)}=${jw(t)}`).join("")}function _z(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Cp(t)}=${Cp(i)}`).join("&"):`${Cp(t)}=${Cp(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var yz=/^[^\/()?;#]+/;function kw(n){let e=n.match(yz);return e?e[0]:""}var vz=/^[^\/()?;=#]+/;function wz(n){let e=n.match(vz);return e?e[0]:""}var Iz=/^[^=?&#]+/;function Ez(n){let e=n.match(Iz);return e?e[0]:""}var Tz=/^[^&#]+/;function bz(n){let e=n.match(Tz);return e?e[0]:""}var Bw=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Me([],{}):new Me([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[pe]=new Me(e,t)),r}parseSegment(){let e=kw(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new te(4009,!1);return this.capture(e),new no(Rp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=wz(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=kw(this.remaining);i&&(r=i,this.capture(r))}e[Rp(t)]=Rp(r)}parseQueryParam(e){let t=Ez(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=bz(this.remaining);o&&(r=o,this.capture(r))}let i=jP(t),s=jP(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=kw(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new te(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=pe);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[pe]:new Me([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new te(4011,!1)}};function tM(n){return n.segments.length>0?new Me([],{[pe]:n}):n}function nM(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=nM(i);if(r===pe&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Me(n.segments,e);return Cz(t)}function Cz(n){if(n.numberOfChildren===1&&n.children[pe]){let e=n.children[pe];return new Me(n.segments.concat(e.segments),e.children)}return n}function Ua(n){return n instanceof Ki}function Dz(n,e,t=null,r=null){let i=rM(n);return iM(i,e,t,r)}function rM(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new Me(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=tM(r);return e??i}function iM(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Ow(i,i,i,t,r);let s=Sz(e);if(s.toRoot())return Ow(i,i,new Me([],{}),t,r);let o=Az(s,i,n),a=o.processChildren?vu(o.segmentGroup,o.index,s.commands):oM(o.segmentGroup,o.index,s.commands);return Ow(i,o.segmentGroup,a,t,r)}function xp(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Tu(n){return typeof n=="object"&&n!=null&&n.outlets}function Ow(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=sM(n,e,t);let a=tM(nM(o));return new Ki(a,s,i)}function sM(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=sM(s,e,t)}),new Me(n.segments,r)}var Np=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&xp(r[0]))throw new te(4003,!1);let i=r.find(Tu);if(i&&i!==KP(r))throw new te(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Sz(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Np(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Np(t,e,r)}var La=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function Az(n,e,t){if(n.isAbsolute)return new La(e,!0,0);if(!t)return new La(e,!1,NaN);if(t.parent===null)return new La(t,!0,0);let r=xp(n.commands[0])?0:1,i=t.segments.length-1+r;return Rz(t,i,n.numberOfDoubleDots)}function Rz(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new te(4005,!1);i=r.segments.length}return new La(r,!1,i-s)}function xz(n){return Tu(n[0])?n[0].outlets:{[pe]:n}}function oM(n,e,t){if(n??=new Me([],{}),n.segments.length===0&&n.hasChildren())return vu(n,e,t);let r=Nz(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Me(n.segments.slice(0,r.pathIndex),{});return s.children[pe]=new Me(n.segments.slice(r.pathIndex),n.children),vu(s,0,i)}else return r.match&&i.length===0?new Me(n.segments,{}):r.match&&!n.hasChildren()?$w(n,e,t):r.match?vu(n,0,i):$w(n,e,t)}function vu(n,e,t){if(t.length===0)return new Me(n.segments,{});{let r=xz(t),i={};if(Object.keys(r).some(s=>s!==pe)&&n.children[pe]&&n.numberOfChildren===1&&n.children[pe].segments.length===0){let s=vu(n.children[pe],e,t);return new Me(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=oM(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Me(n.segments,i)}}function Nz(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(Tu(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!$P(c,l,o))return s;r+=2}else{if(!$P(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function $w(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Tu(s)){let c=Pz(s.outlets);return new Me(r,c)}if(i===0&&xp(t[0])){let c=n.segments[e];r.push(new no(c.path,BP(t[0]))),i++;continue}let o=Tu(s)?s.outlets[pe]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&xp(a)?(r.push(new no(o,BP(a))),i+=2):(r.push(new no(o,{})),i++)}return new Me(r,{})}function Pz(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=$w(new Me([],{}),0,r))}),e}function BP(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function $P(n,e,t){return n==t.path&&Pr(e,t.parameters)}var wu="imperative",Pt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Pt||{}),Hn=class{constructor(e,t){this.id=e,this.url=t}},ja=class extends Hn{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Pt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Mr=class extends Hn{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Pt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Rn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Rn||{}),Pp=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Pp||{}),Qi=class extends Hn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Pt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Yi=class extends Hn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Pt.NavigationSkipped}},bu=class extends Hn{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Pt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Mp=class extends Hn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Pt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Hw=class extends Hn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Pt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qw=class extends Hn{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Pt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},zw=class extends Hn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Pt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ww=class extends Hn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Pt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Gw=class{constructor(e){this.route=e,this.type=Pt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Kw=class{constructor(e){this.route=e,this.type=Pt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Qw=class{constructor(e){this.snapshot=e,this.type=Pt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Yw=class{constructor(e){this.snapshot=e,this.type=Pt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Jw=class{constructor(e){this.snapshot=e,this.type=Pt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Xw=class{constructor(e){this.snapshot=e,this.type=Pt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},kp=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=Pt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Cu=class{},Du=class{constructor(e){this.url=e}};var Zw=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Pu,this.attachRef=null}},Pu=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new Zw,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Op=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=eI(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=eI(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=tI(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return tI(e,this._root).map(t=>t.value)}};function eI(n,e){if(n===e.value)return e;for(let t of e.children){let r=eI(n,t);if(r)return r}return null}function tI(n,e){if(n===e.value)return[e];for(let t of e.children){let r=tI(n,t);if(r.length)return r.unshift(e),r}return[]}var An=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Oa(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Lp=class extends Op{constructor(e,t){super(e),this.snapshot=t,dI(this,e)}toString(){return this.snapshot.toString()}};function aM(n){let e=Mz(n),t=new Ft([new no("",{})]),r=new Ft({}),i=new Ft({}),s=new Ft({}),o=new Ft(""),a=new io(t,r,s,o,i,pe,n,e.root);return a.snapshot=e.root,new Lp(new An(a,[]),e)}function Mz(n){let e={},t={},r={},i="",s=new Su([],e,r,i,t,pe,n,null,{});return new Fp("",new An(s,[]))}var io=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Te(l=>l[xu]))??oe(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Te(e=>Va(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Te(e=>Va(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function uI(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:X(X({},e.params),n.params),data:X(X({},e.data),n.data),resolve:X(X(X(X({},n.data),e.data),i?.data),n._resolvedData)}:r={params:X({},n.params),data:X({},n.data),resolve:X(X({},n.data),n._resolvedData??{})},i&&lM(i)&&(r.resolve[xu]=i.title),r}var Su=class{get title(){return this.data?.[xu]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Va(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Va(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Fp=class extends Op{constructor(e,t){super(t),this.url=e,dI(this,t)}toString(){return cM(this._root)}};function dI(n,e){e.value._routerState=n,e.children.forEach(t=>dI(n,t))}function cM(n){let e=n.children.length>0?` { ${n.children.map(cM).join(", ")} } `:"";return`${n.value}${e}`}function Lw(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Pr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Pr(e.params,t.params)||n.paramsSubject.next(t.params),cz(e.url,t.url)||n.urlSubject.next(t.url),Pr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function nI(n,e){let t=Pr(n.params,e.params)&&hz(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||nI(n.parent,e.parent))}function lM(n){return typeof n.title=="string"||n.title===null}var hI=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=pe,this.activateEvents=new rn,this.deactivateEvents=new rn,this.attachEvents=new rn,this.detachEvents=new rn,this.parentContexts=K(Pu),this.location=K(hp),this.changeDetector=K(du),this.environmentInjector=K(_n),this.inputBinder=K($p,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new te(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new te(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new te(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new te(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new rI(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=ep({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ou]});let n=e;return n})(),rI=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===io?this.route:e===Pu?this.childContexts:this.parent.get(e,t)}},$p=new ue(""),HP=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=$l([i.queryParams,i.params,i.data]).pipe(Un(([o,a,c],l)=>(c=X(X(X({},o),a),c),l===0?oe(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=_P(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})();function kz(n,e,t){let r=Au(n,e._root,t?t._root:void 0);return new Lp(r,e)}function Au(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=Oz(n,e,t);return new An(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Au(n,a)),o}}let r=Lz(e.value),i=e.children.map(s=>Au(n,s));return new An(r,i)}}function Oz(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Au(n,r,i);return Au(n,r)})}function Lz(n){return new io(new Ft(n.url),new Ft(n.params),new Ft(n.queryParams),new Ft(n.fragment),new Ft(n.data),n.outlet,n.component,n)}var uM="ngNavigationCancelingError";function dM(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Ua(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=hM(!1,Rn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function hM(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[uM]=!0,t.cancellationCode=e,t}function Fz(n){return fM(n)&&Ua(n.url)}function fM(n){return!!n&&n[uM]}var Vz=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=st({type:e,selectors:[["ng-component"]],standalone:!0,features:[aP],decls:1,vars:0,template:function(i,s){i&1&&q(0,"router-outlet")},dependencies:[hI],encapsulation:2});let n=e;return n})();function Uz(n,e){return n.providers&&!n._injector&&(n._injector=fp(n.providers,e,`Route: ${n.path}`)),n._injector??e}function fI(n){let e=n.children&&n.children.map(fI),t=e?it(X({},n),{children:e}):X({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==pe&&(t.component=Vz),t}function kr(n){return n.outlet||pe}function jz(n,e){let t=n.filter(r=>kr(r)===e);return t.push(...n.filter(r=>kr(r)!==e)),t}function Mu(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Bz=(n,e,t,r)=>Te(i=>(new iI(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),iI=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Lw(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Oa(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Oa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Oa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Oa(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Xw(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Yw(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Lw(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Lw(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Mu(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Vp=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Fa=class{constructor(e,t){this.component=e,this.route=t}};function $z(n,e,t){let r=n._root,i=e?e._root:null;return _u(r,i,t,[r.value])}function Hz(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function $a(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!fx(n)?n:e.get(n):r}function _u(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Oa(e);return n.children.forEach(o=>{qz(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Iu(a,t.getContext(o),i)),i}function qz(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=zz(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Vp(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?_u(n,e,a?a.children:null,r,i):_u(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Fa(a.outlet.component,o))}else o&&Iu(e,a,i),i.canActivateChecks.push(new Vp(r)),s.component?_u(n,null,a?a.children:null,r,i):_u(n,null,t,r,i);return i}function zz(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!ro(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ro(n.url,e.url)||!Pr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!nI(n,e)||!Pr(n.queryParams,e.queryParams);case"paramsChange":default:return!nI(n,e)}}function Iu(n,e,t){let r=Oa(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Iu(o,e.children.getContext(s),t):Iu(o,null,t):Iu(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Fa(e.outlet.component,i)):t.canDeactivateChecks.push(new Fa(null,i)):t.canDeactivateChecks.push(new Fa(null,i))}function ku(n){return typeof n=="function"}function Wz(n){return typeof n=="boolean"}function Gz(n){return n&&ku(n.canLoad)}function Kz(n){return n&&ku(n.canActivate)}function Qz(n){return n&&ku(n.canActivateChild)}function Yz(n){return n&&ku(n.canDeactivate)}function Jz(n){return n&&ku(n.canMatch)}function pM(n){return n instanceof ui||n?.name==="EmptyError"}var Dp=Symbol("INITIAL_VALUE");function Ba(){return Un(n=>$l(n.map(e=>e.pipe(di(1),By(Dp)))).pipe(Te(e=>{for(let t of e)if(t!==!0){if(t===Dp)return Dp;if(t===!1||t instanceof Ki)return t}return!0}),Vn(e=>e!==Dp),di(1)))}function Xz(n,e){return gt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?oe(it(X({},t),{guardsResult:!0})):Zz(o,r,i,n).pipe(gt(a=>a&&Wz(a)?e3(r,s,n,e):oe(a)),Te(a=>it(X({},t),{guardsResult:a})))})}function Zz(n,e,t,r){return ut(n).pipe(gt(i=>s3(i.component,i.route,t,e,r)),br(i=>i!==!0,!0))}function e3(n,e,t,r){return ut(e).pipe(Ws(i=>ya(n3(i.route.parent,r),t3(i.route,r),i3(n,i.path,t),r3(n,i.route,t))),br(i=>i!==!0,!0))}function t3(n,e){return n!==null&&e&&e(new Jw(n)),oe(!0)}function n3(n,e){return n!==null&&e&&e(new Qw(n)),oe(!0)}function r3(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return oe(!0);let i=r.map(s=>Ef(()=>{let o=Mu(e)??t,a=$a(s,o),c=Kz(a)?a.canActivate(e,n):pi(o,()=>a(e,n));return Ji(c).pipe(br())}));return oe(i).pipe(Ba())}function i3(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>Hz(o)).filter(o=>o!==null).map(o=>Ef(()=>{let a=o.guards.map(c=>{let l=Mu(o.node)??t,d=$a(c,l),h=Qz(d)?d.canActivateChild(r,n):pi(l,()=>d(r,n));return Ji(h).pipe(br())});return oe(a).pipe(Ba())}));return oe(s).pipe(Ba())}function s3(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return oe(!0);let o=s.map(a=>{let c=Mu(e)??i,l=$a(a,c),d=Yz(l)?l.canDeactivate(n,e,t,r):pi(c,()=>l(n,e,t,r));return Ji(d).pipe(br())});return oe(o).pipe(Ba())}function o3(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return oe(!0);let s=i.map(o=>{let a=$a(o,n),c=Gz(a)?a.canLoad(e,t):pi(n,()=>a(e,t));return Ji(c)});return oe(s).pipe(Ba(),mM(r))}function mM(n){return My(Vt(e=>{if(Ua(e))throw dM(n,e)}),Te(e=>e===!0))}function a3(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return oe(!0);let s=i.map(o=>{let a=$a(o,n),c=Jz(a)?a.canMatch(e,t):pi(n,()=>a(e,t));return Ji(c)});return oe(s).pipe(Ba(),mM(r))}var Ru=class{constructor(e){this.segmentGroup=e||null}},Up=class extends Error{constructor(e){super(),this.urlTree=e}};function ka(n){return ga(new Ru(n))}function c3(n){return ga(new te(4e3,!1))}function l3(n){return ga(hM(!1,Rn.GuardRejected))}var sI=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return oe(r);if(i.numberOfChildren>1||!i.children[pe])return c3(e.redirectTo);i=i.children[pe]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new Up(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Ki(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Me(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new te(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},oI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function u3(n,e,t,r,i){let s=pI(n,e,t);return s.matched?(r=Uz(e,r),a3(r,e,t,i).pipe(Te(o=>o===!0?s:X({},oI)))):oe(s)}function pI(n,e,t){if(e.path==="**")return d3(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?X({},oI):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||az)(t,n,e);if(!i)return X({},oI);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?X(X({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function d3(n){return{matched:!0,parameters:n.length>0?KP(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function qP(n,e,t,r){return t.length>0&&p3(n,t,r)?{segmentGroup:new Me(e,f3(r,new Me(t,n.children))),slicedSegments:[]}:t.length===0&&m3(n,t,r)?{segmentGroup:new Me(n.segments,h3(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Me(n.segments,n.children),slicedSegments:t}}function h3(n,e,t,r){let i={};for(let s of t)if(Hp(n,e,s)&&!r[kr(s)]){let o=new Me([],{});i[kr(s)]=o}return X(X({},r),i)}function f3(n,e){let t={};t[pe]=e;for(let r of n)if(r.path===""&&kr(r)!==pe){let i=new Me([],{});t[kr(r)]=i}return t}function p3(n,e,t){return t.some(r=>Hp(n,e,r)&&kr(r)!==pe)}function m3(n,e,t){return t.some(r=>Hp(n,e,r))}function Hp(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function g3(n,e,t,r){return kr(n)!==r&&(r===pe||!Hp(e,t,n))?!1:pI(e,n,t).matched}function _3(n,e,t){return e.length===0&&!n.children[t]}var aI=class{};function y3(n,e,t,r,i,s,o="emptyOnly"){return new cI(n,e,t,r,i,o,s).recognize()}var v3=31,cI=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new sI(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new te(4002,`'${e.segmentGroup}'`)}recognize(){let e=qP(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Te(t=>{let r=new Su([],Object.freeze({}),Object.freeze(X({},this.urlTree.queryParams)),this.urlTree.fragment,{},pe,this.rootComponentType,null,{}),i=new An(r,t),s=new Fp("",i),o=Dz(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,pe).pipe(Bi(r=>{if(r instanceof Up)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Ru?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=uI(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(Te(s=>s instanceof An?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ut(i).pipe(Ws(s=>{let o=r.children[s],a=jz(t,s);return this.processSegmentGroup(e,a,o,s)}),jy((s,o)=>(s.push(...o),s)),$i(null),Uy(),gt(s=>{if(s===null)return ka(r);let o=gM(s);return w3(o),oe(o)}))}processSegment(e,t,r,i,s,o){return ut(t).pipe(Ws(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(Bi(c=>{if(c instanceof Ru)return oe(null);throw c}))),br(a=>!!a),Bi(a=>{if(pM(a))return _3(r,i,s)?oe(new aI):ka(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return g3(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):ka(i):ka(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:d}=pI(t,i,s);if(!a)return ka(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>v3&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,h).pipe(gt(p=>this.processSegment(e,r,t,p.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=u3(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(Un(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Un(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:p}=a,_=new Su(d,p,Object.freeze(X({},this.urlTree.queryParams)),this.urlTree.fragment,E3(r),kr(r),r.component??r._loadedComponent??null,r,T3(r)),{segmentGroup:w,slicedSegments:b}=qP(t,d,h,c);if(b.length===0&&w.hasChildren())return this.processChildren(l,c,w).pipe(Te(L=>L===null?null:new An(_,L)));if(c.length===0&&b.length===0)return oe(new An(_,[]));let R=kr(r)===s;return this.processSegment(l,c,w,b,R?pe:s,!0).pipe(Te(L=>new An(_,L instanceof An?[L]:[])))}))):ka(t)))}getChildConfig(e,t,r){return t.children?oe({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?oe({routes:t._loadedRoutes,injector:t._loadedInjector}):o3(e,t,r,this.urlSerializer).pipe(gt(i=>i?this.configLoader.loadChildren(e,t).pipe(Vt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):l3(t))):oe({routes:[],injector:e})}};function w3(n){n.sort((e,t)=>e.value.outlet===pe?-1:t.value.outlet===pe?1:e.value.outlet.localeCompare(t.value.outlet))}function I3(n){let e=n.value.routeConfig;return e&&e.path===""}function gM(n){let e=[],t=new Set;for(let r of n){if(!I3(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=gM(r.children);e.push(new An(r.value,i))}return e.filter(r=>!t.has(r))}function E3(n){return n.data||{}}function T3(n){return n.resolve||{}}function b3(n,e,t,r,i,s){return gt(o=>y3(n,e,t,r,o.extractedUrl,i,s).pipe(Te(({state:a,tree:c})=>it(X({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function C3(n,e){return gt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return oe(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of _M(c))o.add(l);let a=0;return ut(o).pipe(Ws(c=>s.has(c)?D3(c,r,n,e):(c.data=uI(c,c.parent,n).resolve,oe(void 0))),Vt(()=>a++),va(1),gt(c=>a===o.size?oe(t):Cn))})}function _M(n){let e=n.children.map(t=>_M(t)).flat();return[n,...e]}function D3(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!lM(i)&&(s[xu]=i.title),S3(s,n,e,r).pipe(Te(o=>(n._resolvedData=o,n.data=uI(n,n.parent,t).resolve,null)))}function S3(n,e,t,r){let i=Uw(n);if(i.length===0)return oe({});let s={};return ut(i).pipe(gt(o=>A3(n[o],e,t,r).pipe(br(),Vt(a=>{s[o]=a}))),va(1),Vy(s),Bi(o=>pM(o)?Cn:ga(o)))}function A3(n,e,t,r){let i=Mu(e)??r,s=$a(n,i),o=s.resolve?s.resolve(e,t):pi(i,()=>s(e,t));return Ji(o)}function Fw(n){return Un(e=>{let t=n(e);return t?ut(t).pipe(Te(()=>e)):oe(e)})}var yM=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===pe);return i}getResolvedTitleForRoute(r){return r.data[xu]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>K(R3),providedIn:"root"});let n=e;return n})(),R3=(()=>{let e=class e extends yM{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(se(FP))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ou=new ue("",{providedIn:"root",factory:()=>({})}),jp=new ue(""),mI=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=K(vp)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return oe(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Ji(r.loadComponent()).pipe(Te(vM),Vt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Hl(()=>{this.componentLoaders.delete(r)})),s=new ma(i,()=>new Wt).pipe(pa());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return oe({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=x3(i,this.compiler,r,this.onLoadEndListener).pipe(Hl(()=>{this.childrenLoaders.delete(i)})),a=new ma(o,()=>new Wt).pipe(pa());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function x3(n,e,t,r){return Ji(n.loadChildren()).pipe(Te(vM),gt(i=>i instanceof nu||Array.isArray(i)?oe(i):ut(e.compileModuleAsync(i))),Te(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(jp,[],{optional:!0,self:!0}).flat()),{routes:o.map(fI),injector:s}}))}function N3(n){return n&&typeof n=="object"&&"default"in n}function vM(n){return N3(n)?n.default:n}var gI=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>K(P3),providedIn:"root"});let n=e;return n})(),P3=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),wM=new ue(""),IM=new ue("");function M3(n,e,t){let r=n.get(IM),i=n.get(vn);return n.get($e).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),k3(n))),{onViewTransitionCreated:c}=r;return c&&pi(n,()=>c({transition:a,from:e,to:t})),o})}function k3(n){return new Promise(e=>{dp(e,{injector:n})})}var _I=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Wt,this.transitionAbortSubject=new Wt,this.configLoader=K(mI),this.environmentInjector=K(_n),this.urlSerializer=K(Nu),this.rootContexts=K(Pu),this.location=K(Ma),this.inputBindingEnabled=K($p,{optional:!0})!==null,this.titleStrategy=K(yM),this.options=K(Ou,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=K(gI),this.createViewTransition=K(wM,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>oe(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Gw(s)),i=s=>this.events.next(new Kw(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(it(X(X({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Ft({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:wu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Vn(o=>o.id!==0),Te(o=>it(X({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Un(o=>{let a=!1,c=!1;return oe(o).pipe(Un(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Rn.SupersededByNewNavigation),Cn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?it(X({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&h!=="reload"){let p="";return this.events.next(new Yi(l.id,this.urlSerializer.serialize(l.rawUrl),p,Pp.IgnoredSameUrlNavigation)),l.resolve(null),Cn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return oe(l).pipe(Un(p=>{let _=this.transitions?.getValue();return this.events.next(new ja(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),_!==this.transitions?.getValue()?Cn:Promise.resolve(p)}),b3(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Vt(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=it(X({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let _=new Mp(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(_)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:_,source:w,restoredState:b,extras:R}=l,L=new ja(p,this.urlSerializer.serialize(_),w,b);this.events.next(L);let H=aM(this.rootComponentType).snapshot;return this.currentTransition=o=it(X({},l),{targetSnapshot:H,urlAfterRedirects:_,extras:it(X({},R),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=_,oe(o)}else{let p="";return this.events.next(new Yi(l.id,this.urlSerializer.serialize(l.extractedUrl),p,Pp.IgnoredByUrlHandlingStrategy)),l.resolve(null),Cn}}),Vt(l=>{let d=new Hw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Te(l=>(this.currentTransition=o=it(X({},l),{guards:$z(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),Xz(this.environmentInjector,l=>this.events.next(l)),Vt(l=>{if(o.guardsResult=l.guardsResult,Ua(l.guardsResult))throw dM(this.urlSerializer,l.guardsResult);let d=new qw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),Vn(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Rn.GuardRejected),!1)),Fw(l=>{if(l.guards.canActivateChecks.length)return oe(l).pipe(Vt(d=>{let h=new zw(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),Un(d=>{let h=!1;return oe(d).pipe(C3(this.paramsInheritanceStrategy,this.environmentInjector),Vt({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(d,"",Rn.NoDataFromResolver)}}))}),Vt(d=>{let h=new Ww(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}))}),Fw(l=>{let d=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(Vt(_=>{h.component=_}),Te(()=>{})));for(let _ of h.children)p.push(...d(_));return p};return $l(d(l.targetSnapshot.root)).pipe($i(null),di(1))}),Fw(()=>this.afterPreactivation()),Un(()=>{let{currentSnapshot:l,targetSnapshot:d}=o,h=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return h?ut(h).pipe(Te(()=>o)):oe(o)}),Te(l=>{let d=kz(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=it(X({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),Vt(()=>{this.events.next(new Cu)}),Bz(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),di(1),Vt({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Mr(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),$y(this.transitionAbortSubject.pipe(Vt(l=>{throw l}))),Hl(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Rn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Bi(l=>{if(c=!0,fM(l))this.events.next(new Qi(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),Fz(l)?this.events.next(new Du(l.url)):o.resolve(!1);else{this.events.next(new bu(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return Cn}))}))}cancelNavigationTransition(r,i,s){let o=new Qi(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function O3(n){return n!==wu}var L3=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>K(F3),providedIn:"root"});let n=e;return n})(),lI=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},F3=(()=>{let e=class e extends lI{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Kv(e)))(s||e)}})(),e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),EM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>K(V3),providedIn:"root"});let n=e;return n})(),V3=(()=>{let e=class e extends EM{constructor(){super(...arguments),this.location=K(Ma),this.urlSerializer=K(Nu),this.options=K(Ou,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=K(gI),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ki,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=aM(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof ja)this.stateMemento=this.createStateMemento();else if(r instanceof Yi)this.rawUrlTree=i.initialUrl;else if(r instanceof Mp){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Cu?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Qi&&(r.code===Rn.GuardRejected||r.code===Rn.NoDataFromResolver)?this.restoreHistory(i):r instanceof bu?this.restoreHistory(i,!0):r instanceof Mr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=X(X({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=X(X({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Kv(e)))(s||e)}})(),e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),yu=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(yu||{});function TM(n,e){n.events.pipe(Vn(t=>t instanceof Mr||t instanceof Qi||t instanceof bu||t instanceof Yi),Te(t=>t instanceof Mr||t instanceof Yi?yu.COMPLETE:(t instanceof Qi?t.code===Rn.Redirect||t.code===Rn.SupersededByNewNavigation:!1)?yu.REDIRECTING:yu.FAILED),Vn(t=>t!==yu.REDIRECTING),di(1)).subscribe(()=>{e()})}function U3(n){throw n}var j3={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},B3={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Or=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=K(mp),this.stateManager=K(EM),this.options=K(Ou,{optional:!0})||{},this.pendingTasks=K(pp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=K(_I),this.urlSerializer=K(Nu),this.location=K(Ma),this.urlHandlingStrategy=K(gI),this._events=new Wt,this.errorHandler=this.options.errorHandler||U3,this.navigated=!1,this.routeReuseStrategy=K(L3),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=K(jp,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!K($p,{optional:!0}),this.eventsSubscription=new Dt,this.isNgZoneEnabled=K($e)instanceof $e&&$e.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Qi&&i.code!==Rn.Redirect&&i.code!==Rn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Mr)this.navigated=!0;else if(i instanceof Du){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||O3(s.source)};this.scheduleNavigation(a,wu,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}H3(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),wu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=X({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(fI),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,d=l?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=X(X({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let _=s?s.snapshot:this.routerState.snapshot.root;p=rM(_)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),p=this.currentUrlTree.root}return iM(p,r,h,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Ua(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,wu,null,i)}navigate(r,i={skipLocationChange:!1}){return $3(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=X({},j3):i===!1?s=X({},B3):s=i,Ua(r))return UP(this.currentUrlTree,r,s);let o=this.parseUrl(r);return UP(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,d;a?(c=a.resolve,l=a.reject,d=a.promise):d=new Promise((p,_)=>{c=p,l=_});let h=this.pendingTasks.add();return TM(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function $3(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new te(4008,!1)}function H3(n){return!(n instanceof Cu)&&!(n instanceof Du)}var Ha=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Wt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof Mr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:AN(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(yn(Or),yn(io),Qv("tabindex"),yn(up),yn(cu),yn(hr))},e.\u0275dir=ep({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&he("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&fw("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[sr.HasDecoratorInputTransform,"preserveFragment","preserveFragment",hu],skipLocationChange:[sr.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",hu],replaceUrl:[sr.HasDecoratorInputTransform,"replaceUrl","replaceUrl",hu],routerLink:"routerLink"},standalone:!0,features:[hw,ou]});let n=e;return n})();var Bp=class{};var q3=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Vn(r=>r instanceof Mr),Ws(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=fp(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return ut(s).pipe(_a())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=oe(null);let o=s.pipe(gt(a=>a===null?oe(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return ut([o,a]).pipe(_a())}else return o})}};e.\u0275fac=function(i){return new(i||e)(se(Or),se(vp),se(_n),se(Bp),se(mI))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),bM=new ue(""),z3=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=K(_n),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof ja?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof Mr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Yi&&r.code===Pp.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof kp&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>g(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),dp(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new kp(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){BN()},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})();function W3(n){return n.routerState.root}function Lu(n,e){return{\u0275kind:n,\u0275providers:e}}function G3(){let n=K(Nr);return e=>{let t=n.get(Pa);if(e!==t.components[0])return;let r=n.get(Or),i=n.get(CM);n.get(yI)===1&&r.initialNavigation(),n.get(DM,null,ye.Optional)?.setUpPreloading(),n.get(bM,null,ye.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var CM=new ue("",{factory:()=>new Wt}),yI=new ue("",{providedIn:"root",factory:()=>1});function K3(){return Lu(2,[{provide:yI,useValue:0},{provide:yp,multi:!0,deps:[Nr],useFactory:e=>{let t=e.get(TP,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(Or),s=e.get(CM);TM(i,()=>{r(!0)}),e.get(_I).afterPreactivation=()=>(r(!0),s.closed?oe(void 0):s),i.initialNavigation()}))}}])}function Q3(){return Lu(3,[{provide:yp,multi:!0,useFactory:()=>{let e=K(Or);return()=>{e.setUpLocationChangeListener()}}},{provide:yI,useValue:2}])}var DM=new ue("");function Y3(n){return Lu(0,[{provide:DM,useExisting:q3},{provide:Bp,useExisting:n}])}function J3(){return Lu(8,[HP,{provide:$p,useExisting:HP}])}function X3(n){let e=[{provide:wM,useValue:M3},{provide:IM,useValue:X({skipNextTransition:!!n?.skipInitialTransition},n)}];return Lu(9,e)}var zP=new ue("ROUTER_FORROOT_GUARD"),Z3=[Ma,{provide:Nu,useClass:Eu},Or,Pu,{provide:io,useFactory:W3,deps:[Or]},mI,[]],vI=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[Z3,[],{provide:jp,multi:!0,useValue:r},{provide:zP,useFactory:rW,deps:[[Or,new kv,new wx]]},{provide:Ou,useValue:i||{}},i?.useHash?tW():nW(),eW(),i?.preloadingStrategy?Y3(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?iW(i):[],i?.bindToComponentInputs?J3().\u0275providers:[],i?.enableViewTransitions?X3().\u0275providers:[],sW()]}}static forChild(r){return{ngModule:e,providers:[{provide:jp,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(se(zP,8))},e.\u0275mod=cr({type:e}),e.\u0275inj=ar({});let n=e;return n})();function eW(){return{provide:bM,useFactory:()=>{let n=K(SP),e=K($e),t=K(Ou),r=K(_I),i=K(Nu);return t.scrollOffset&&n.setOffset(t.scrollOffset),new z3(i,r,n,e,t)}}}function tW(){return{provide:hr,useClass:Ep}}function nW(){return{provide:hr,useClass:Tw}}function rW(n){return"guarded"}function iW(n){return[n.initialNavigation==="disabled"?Q3().\u0275providers:[],n.initialNavigation==="enabledBlocking"?K3().\u0275providers:[]]}var WP=new ue("");function sW(){return[{provide:WP,useFactory:G3},{provide:gw,multi:!0,useExisting:WP}]}var qn=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=st({type:e,selectors:[["app-footer"]],decls:28,vars:0,consts:[[1,"responsive-footer",2,"width","100%","display","flex","flex-direction","row","align-items","start","gap","3rem","justify-content","center","flex-wrap","wrap","background","black","padding-bottom","5rem"],["src","assets\\svg\\solo jj.svg",1,"responsive-image-2",2,"width","15rem"],[2,"display","flex","flex-direction","column","gap","0.2rem","width","15rem"],[2,"margin-bottom","0.2rem"],["routerLink","/home",1,"a1"],["routerLink","/menu",1,"a1"],["routerLink","/prenota",1,"a1"],["routerLink","/contattaci",1,"a1"],["routerLink","/dove_siamo",1,"a1",2,"margin-top","0rem","margin-bottom","0rem"],["routerLink","/privacy_policy",1,"a1",2,"margin-top","0rem","margin-bottom","0rem"],["routerLink","/lavora_con_noi",1,"a1"],[2,"display","flex","flex-direction","column","gap","0.2rem","width","15rem","margin-bottom","3rem"],["target","_blank","href","tel:+390402334609",1,"a1",2,"margin-top","0rem","margin-bottom","0rem"],["target","_blank","href","https://www.instagram.com/osteria_jamesjoyce?igsh=MTZseGsxcmpneWd2OQ%3D%3D&utm_source=qr",1,"a1",2,"margin-top","0rem","margin-bottom","0rem"],["target","_blank","href","mailto:lavorocristian9@gmail.com",1,"a1"]],template:function(i,s){i&1&&(S(0,"div",0),q(1,"img",1),S(2,"div",2)(3,"h1",3),O(4,"Indice"),x(),S(5,"a",4),O(6,"Home"),x(),S(7,"a",5),O(8,"Men\xF9"),x(),S(9,"a",6),O(10,"Prenota"),x(),S(11,"a",7),O(12,"Contattaci"),x(),S(13,"a",8),O(14,"Dove siamo"),x(),S(15,"a",9),O(16,"Privacy Policy"),x(),S(17,"a",10),O(18,"Lavora con noi"),x()(),S(19,"div",11)(20,"h1",3),O(21,"Contatti"),x(),S(22,"a",12),O(23,"+39 040 233 46 09"),x(),S(24,"a",13),O(25,"Instagram"),x(),S(26,"a",14),O(27,"Email"),x()()())},dependencies:[Ha]});let n=e;return n})();var SM=(()=>{let e=class e{ngOnInit(){let r=document.querySelector(".carousel-images"),s=document.querySelectorAll(".carousel-images img").length,o=0,a=document.querySelector(".parallax-div"),c=document.querySelector(".parallax-background"),l=document.querySelector(".responsive-title"),d=document.getElementById("piatto-sopra"),h=document.getElementById("piatto-sotto"),p=document.getElementById("jj-logo-parallax");a.addEventListener("scroll",function(){let L=a.scrollTop/(a.scrollHeight-a.clientHeight),H=L*800;L>5e-4&&(p.style.opacity=+("+"+L)*15+"",p.style.scale=+("+"+L)*15+""),L<5e-4&&(p.style.opacity=+("+"+L)*15+"",p.style.scale=+("-"+L)*15+""),innerWidth<999&&(l.style.transform=`translateY(+${H*5}%)`),d.style.transform=`translateY(-${H}%)`,h.style.transform=`translateY(+${H}%)`});function _(){o=(o+1)%s,b()}function w(){o=(o-1+s)%s,b()}function b(){let R=-o*100;r.style.transform=`translateX(${R}%)`}document.querySelector(".carousel-arrow.right").addEventListener("click",_),document.querySelector(".carousel-arrow.left").addEventListener("click",w),setInterval(_,3e3)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=st({type:e,selectors:[["app-home"]],decls:46,vars:0,consts:[[1,"parallax-div",2,"height","100%","width","100%","overflow-y","auto","overflow-x","hidden"],[1,"header",2,"height","105vh"],[1,"parallax-background"],[1,"overlay"],[2,"flex","1"],["id","hands-parallax-container",2,"width","100%","height","100%","display","flex","flex-direction","row","align-items","center","justify-content","center","flex-wrap","wrap","gap","2rem"],[1,"responsive-title",2,"font-size","2.5rem","text-align","start","margin-top","3rem","max-width","35rem"],[2,"display","flex","flex-direction","column","width","100%","max-width","35rem","align-items","center","justify-content","center"],[2,"display","flex","flex-direction","column","position","absolute","z-index","3"],["id","piatto-sopra","src","assets\\imgs\\header\\piatto sopra .png",2,"max-width","50rem","width","100%","object-fit","cover","z-index","1","position","relative"],["id","piatto-sotto","src","assets\\imgs\\header\\piatto sotto .png",2,"max-width","50rem","width","100%","object-fit","cover","z-index","1","position","relative"],["id","jj-logo-parallax","src","assets\\svg\\jj .svg",2,"height","18rem","width","100%","object-fit","cover","z-index","1","position","relative","opacity","0"],["src","assets\\svg\\wave.svg",2,"width","100%","height","11rem","object-fit","cover","object-position","bottom","overflow-y","visible","margin-bottom","-0.2rem","z-index","5"],[2,"height","50rem","display","flex","flex-direction","column","align-items","center","justify-content","center","gap","5rem","background","black","padding-bottom","1rem"],[1,"responsive-text-align-center",2,"margin-bottom","0rem","margin-top","0rem"],[1,"carousel"],[1,"carousel-images"],["src","assets\\imgs\\IMG_3725.jpeg","alt","Image 1"],["src","assets\\imgs\\IMG_3817.jpeg","alt","Image 2"],["src","assets\\imgs\\IMG_3826.jpeg","alt","Image 3"],["src","assets\\imgs\\IMG_3843.jpeg","alt","Image 4"],["src","assets\\imgs\\tempImage3RCXza.jpg","alt","Image 5"],[1,"carousel-arrow","left"],[1,"carousel-arrow","right"],["src","assets\\svg\\wave.svg",2,"width","100%","height","11rem","object-fit","cover","object-position","bottom","overflow-y","visible","margin-top","-0.5rem","rotate","-180deg"],[1,"column-reverse-responsive-div",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","5rem"],["src","assets\\imgs\\tempImageFEw6QP.jpg",2,"width","18rem","border-radius","1rem"],[1,"responsive-margin-left"],[2,"margin-bottom","0rem"],[2,"max-width","20rem","margin-top","0.5rem","margin-right","1rem"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","1rem","flex-wrap","wrap"],["href","tel:+390402334609",1,"button-a"],["href","mailto:lavorocristian9@gmail.com",1,"button-a"],["href","https://www.instagram.com/osteria_jamesjoyce?igsh=MTZseGsxcmpneWd2OQ%3D%3D&utm_source=qr",1,"button-a"],["src","assets\\svg\\wave.svg",2,"width","100%","height","11rem","object-fit","cover","object-position","bottom","overflow-y","visible","margin-bottom","-0.8rem"]],template:function(i,s){i&1&&(S(0,"div",0)(1,"div",1),q(2,"img",2),S(3,"div",3),q(4,"div",4),S(5,"div",5)(6,"h1",6),O(7,'"Nella realt\xE0 le avventure non capitano a chi se ne sta a casa: bisogna venirle a cercare qui da noi"'),x(),S(8,"div",7)(9,"div",8),q(10,"img",9)(11,"img",10),x(),q(12,"img",11),x()(),q(13,"div",4)(14,"img",12),x()(),S(15,"div",13)(16,"h1",14),O(17,"La nostra galleria immagini"),x(),S(18,"div",15)(19,"div",16),q(20,"img",17)(21,"img",18)(22,"img",19)(23,"img",20)(24,"img",21),x(),S(25,"button",22),O(26,"\u25C0"),x(),S(27,"button",23),O(28,"\u25B6"),x()()(),q(29,"img",24),S(30,"div",25),q(31,"img",26),S(32,"div",27)(33,"h1",28),O(34,"Contattaci"),x(),S(35,"p",29),O(36,"Contattaci e seguici sui nostri canali per restare aggiornato"),x(),S(37,"div",30)(38,"a",31),O(39,"+39 040 233 4609"),x(),S(40,"a",32),O(41,"Email"),x(),S(42,"a",33),O(43,"Instagram"),x()()()(),q(44,"img",34)(45,"app-footer"),x())},dependencies:[qn]});let n=e;return n})();var II={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var B=function(n,e){if(!n)throw so(e)},so=function(n){return new Error("Firebase Database ("+II.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var RM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},oW=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Wp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4,p=(a&15)<<2|l>>6,_=l&63;c||(_=64,o||(p=64)),r.push(t[d],t[h],t[p],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(RM(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):oW(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new EI;let p=s<<2|a>>4;if(r.push(p),l!==64){let _=a<<4&240|l>>2;if(r.push(_),h!==64){let w=l<<6&192|h;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},EI=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},bI=function(n){let e=RM(n);return Wp.encodeByteArray(e,!0)},Fu=function(n){return bI(n).replace(/\./g,"")},Vu=function(n){try{return Wp.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function xM(n){return Wa(void 0,n)}function Wa(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!aW(t)||(n[t]=Wa(n[t],e[t]));return n}function aW(n){return n!=="__proto__"}function CI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var cW=()=>CI().__FIREBASE_DEFAULTS__,lW=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},uW=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Vu(n[1]);return e&&JSON.parse(e)},DI=()=>{try{return cW()||lW()||uW()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var SI=()=>{var n;return(n=DI())===null||n===void 0?void 0:n.config},NM=n=>{var e;return(e=DI())===null||e===void 0?void 0:e[`_${n}`]};var St=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Ga(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Fu(JSON.stringify(t)),Fu(JSON.stringify(o)),""].join(".")}function He(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Uu(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(He())}function Gp(){var n;let e=(n=DI())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function PM(){return typeof window<"u"||AI()}function AI(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Kp(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function oo(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Qp(){let n=He();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Lr(){return II.NODE_CLIENT===!0||II.NODE_ADMIN===!0}function RI(){return!Gp()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Xi(){try{return typeof indexedDB=="object"}catch{return!1}}function MM(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var dW="FirebaseError",ot=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=dW,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zn.prototype.create)}},zn=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?hW(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ot(i,a,r)}};function hW(n,e){return n.replace(fW,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var fW=/\{\$([^}]+)}/g;function za(n){return JSON.parse(n)}function _t(n){return JSON.stringify(n)}var kM=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=za(Vu(s[0])||""),t=za(Vu(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var OM=function(n){let e=kM(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},LM=function(n){let e=kM(n).claims;return typeof e=="object"&&e.admin===!0};function on(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Zi(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Ka(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ju(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function es(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(AM(s)&&AM(o)){if(!es(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function AM(n){return n!==null&&typeof n=="object"}function vi(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ts(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Qa(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var zp=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)r[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){let p=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(p<<1|p>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,d;for(let h=0;h<80;h++){h<40?h<20?(l=a^s&(o^a),d=1518500249):(l=s^o^a,d=1859775393):h<60?(l=s&o|a&(s|o),d=2400959708):(l=s^o^a,d=3395469782);let p=(i<<5|i>>>27)+l+c+d+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=p}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function Yp(n,e){let t=new TI(n,e);return t.subscribe.bind(t)}var TI=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");pW(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=wI),i.error===void 0&&(i.error=wI),i.complete===void 0&&(i.complete=wI);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function pW(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function wI(){}var re=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){let s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function Qt(n,e){return`${n} failed: ${e} argument `}function At(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(Qt(n,e)+"must be a valid function.")}function xI(n,e,t,r){if(!(r&&!t)&&(typeof t!="object"||t===null))throw new Error(Qt(n,e)+"must be a valid context object.")}var FM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,B(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Bu=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var Sie=4*60*60*1e3;function z(n){return n&&n._delegate?n._delegate:n}var Fe=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var ao="[DEFAULT]";var co=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new St;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gW(e))try{this.getOrInitializeService({instanceIdentifier:ao})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ao){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=ao){return this.instances.has(e)}getOptions(e=ao){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:mW(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ao){return this.component?this.component.multipleInstances?e:ao:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function mW(n){return n===ao?void 0:n}function gW(n){return n.instantiationMode==="EAGER"}var ns=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new co(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var WI={};Oj(WI,{FirebaseError:()=>ot,SDK_VERSION:()=>cn,_DEFAULT_ENTRY_NAME:()=>Vr,_addComponent:()=>Xa,_addOrOverwriteComponent:()=>HI,_apps:()=>rs,_clearComponents:()=>rG,_components:()=>Ja,_getProvider:()=>Za,_isFirebaseApp:()=>XM,_isFirebaseServerApp:()=>Ze,_registerComponent:()=>an,_removeServiceInstance:()=>JM,_serverApps:()=>Ya,deleteApp:()=>tm,getApp:()=>Hu,getApps:()=>oG,initializeApp:()=>em,initializeServerApp:()=>sG,onLog:()=>qI,registerVersion:()=>dt,setLogLevel:()=>zI});var NI=[],me=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(me||{}),VM={debug:me.DEBUG,verbose:me.VERBOSE,info:me.INFO,warn:me.WARN,error:me.ERROR,silent:me.SILENT},_W=me.INFO,yW={[me.DEBUG]:"log",[me.VERBOSE]:"log",[me.INFO]:"info",[me.WARN]:"warn",[me.ERROR]:"error"},vW=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=yW[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},wn=class{constructor(e){this.name=e,this._logLevel=_W,this._logHandler=vW,this._userLogHandler=null,NI.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in me))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?VM[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,me.DEBUG,...e),this._logHandler(this,me.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,me.VERBOSE,...e),this._logHandler(this,me.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,me.INFO,...e),this._logHandler(this,me.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,me.WARN,...e),this._logHandler(this,me.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,me.ERROR,...e),this._logHandler(this,me.ERROR,...e)}};function UM(n){NI.forEach(e=>{e.setLogLevel(n)})}function jM(n,e){for(let t of NI){let r=null;e&&e.level&&(r=VM[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:me[s].toLowerCase(),message:a,args:o,type:i.name})}}}var wW=(n,e)=>e.some(t=>n instanceof t),BM,$M;function IW(){return BM||(BM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function EW(){return $M||($M=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var HM=new WeakMap,MI=new WeakMap,qM=new WeakMap,PI=new WeakMap,OI=new WeakMap;function TW(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Fr(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&HM.set(t,n)}).catch(()=>{}),OI.set(e,n),e}function bW(n){if(MI.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});MI.set(n,e)}var kI={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return MI.get(n);if(e==="objectStoreNames")return n.objectStoreNames||qM.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function zM(n){kI=n(kI)}function CW(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Jp(this),e,...t);return qM.set(r,e.sort?e.sort():[e]),Fr(r)}:EW().includes(n)?function(...e){return n.apply(Jp(this),e),Fr(HM.get(this))}:function(...e){return Fr(n.apply(Jp(this),e))}}function DW(n){return typeof n=="function"?CW(n):(n instanceof IDBTransaction&&bW(n),wW(n,IW())?new Proxy(n,kI):n)}function Fr(n){if(n instanceof IDBRequest)return TW(n);if(PI.has(n))return PI.get(n);let e=DW(n);return e!==n&&(PI.set(n,e),OI.set(e,n)),e}var Jp=n=>OI.get(n);function GM(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=Fr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Fr(o.result),c.oldVersion,c.newVersion,Fr(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var SW=["get","getKey","getAll","getAllKeys","count"],AW=["put","add","delete","clear"],LI=new Map;function WM(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(LI.get(e))return LI.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=AW.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||SW.includes(t)))return;let s=function(o,...a){return g(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&c.done]))[0]})};return LI.set(e,s),s}zM(n=>it(X({},n),{get:(e,t,r)=>WM(e,t)||n.get(e,t,r),has:(e,t)=>!!WM(e,t)||n.has(e,t)}));var VI=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(RW(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function RW(n){let e=n.getComponent();return e?.type==="VERSION"}var Xp="@firebase/app",UI="0.10.10";var wi=new wn("@firebase/app"),xW="@firebase/app-compat",NW="@firebase/analytics-compat",PW="@firebase/analytics",MW="@firebase/app-check-compat",kW="@firebase/app-check",OW="@firebase/auth",LW="@firebase/auth-compat",FW="@firebase/database",VW="@firebase/database-compat",UW="@firebase/functions",jW="@firebase/functions-compat",BW="@firebase/installations",$W="@firebase/installations-compat",HW="@firebase/messaging",qW="@firebase/messaging-compat",zW="@firebase/performance",WW="@firebase/performance-compat",GW="@firebase/remote-config",KW="@firebase/remote-config-compat",QW="@firebase/storage",YW="@firebase/storage-compat",JW="@firebase/firestore",XW="@firebase/vertexai-preview",ZW="@firebase/firestore-compat",eG="firebase",tG="10.13.1";var Vr="[DEFAULT]",nG={[Xp]:"fire-core",[xW]:"fire-core-compat",[PW]:"fire-analytics",[NW]:"fire-analytics-compat",[kW]:"fire-app-check",[MW]:"fire-app-check-compat",[OW]:"fire-auth",[LW]:"fire-auth-compat",[FW]:"fire-rtdb",[VW]:"fire-rtdb-compat",[UW]:"fire-fn",[jW]:"fire-fn-compat",[BW]:"fire-iid",[$W]:"fire-iid-compat",[HW]:"fire-fcm",[qW]:"fire-fcm-compat",[zW]:"fire-perf",[WW]:"fire-perf-compat",[GW]:"fire-rc",[KW]:"fire-rc-compat",[QW]:"fire-gcs",[YW]:"fire-gcs-compat",[JW]:"fire-fst",[ZW]:"fire-fst-compat",[XW]:"fire-vertex","fire-js":"fire-js",[eG]:"fire-js-all"};var rs=new Map,Ya=new Map,Ja=new Map;function Xa(n,e){try{n.container.addComponent(e)}catch(t){wi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function HI(n,e){n.container.addOrOverwriteComponent(e)}function an(n){let e=n.name;if(Ja.has(e))return wi.debug(`There were multiple attempts to register component ${e}.`),!1;Ja.set(e,n);for(let t of rs.values())Xa(t,n);for(let t of Ya.values())Xa(t,n);return!0}function Za(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function JM(n,e,t=Vr){Za(n,e).clearInstance(t)}function XM(n){return n.options!==void 0}function Ze(n){return n.settings!==void 0}function rG(){Ja.clear()}var iG={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Wn=new zn("app","Firebase",iG);var Zp=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Fe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wn.create("app-deleted",{appName:this._name})}};var jI=class extends Zp{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,dt(Xp,UI,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){tm(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Wn.create("server-app-deleted")}};var cn=tG;function em(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Vr,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Wn.create("bad-app-name",{appName:String(i)});if(t||(t=SI()),!t)throw Wn.create("no-options");let s=rs.get(i);if(s){if(es(t,s.options)&&es(r,s.config))return s;throw Wn.create("duplicate-app",{appName:i})}let o=new ns(i);for(let c of Ja.values())o.addComponent(c);let a=new Zp(t,r,o);return rs.set(i,a),a}function sG(n,e){if(PM()&&!AI())throw Wn.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;XM(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=l=>[...l].reduce((d,h)=>Math.imul(31,d)+h.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Wn.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=Ya.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let a=new ns(s);for(let l of Ja.values())a.addComponent(l);let c=new jI(t,e,s,a);return Ya.set(s,c),c}function Hu(n=Vr){let e=rs.get(n);if(!e&&n===Vr&&SI())return em();if(!e)throw Wn.create("no-app",{appName:n});return e}function oG(){return Array.from(rs.values())}function tm(n){return g(this,null,function*(){let e=!1,t=n.name;rs.has(t)?(e=!0,rs.delete(t)):Ya.has(t)&&n.decRefCount()<=0&&(Ya.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function dt(n,e,t){var r;let i=(r=nG[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wi.warn(a.join(" "));return}an(new Fe(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function qI(n,e){if(n!==null&&typeof n!="function")throw Wn.create("invalid-log-argument");jM(n,e)}function zI(n){UM(n)}var aG="firebase-heartbeat-database",cG=1,$u="firebase-heartbeat-store",FI=null;function ZM(){return FI||(FI=GM(aG,cG,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore($u)}catch(t){console.warn(t)}}}}).catch(n=>{throw Wn.create("idb-open",{originalErrorMessage:n.message})})),FI}function lG(n){return g(this,null,function*(){try{let t=(yield ZM()).transaction($u),r=yield t.objectStore($u).get(ek(n));return yield t.done,r}catch(e){if(e instanceof ot)wi.warn(e.message);else{let t=Wn.create("idb-get",{originalErrorMessage:e?.message});wi.warn(t.message)}}})}function KM(n,e){return g(this,null,function*(){try{let r=(yield ZM()).transaction($u,"readwrite");yield r.objectStore($u).put(e,ek(n)),yield r.done}catch(t){if(t instanceof ot)wi.warn(t.message);else{let r=Wn.create("idb-set",{originalErrorMessage:t?.message});wi.warn(r.message)}}})}function ek(n){return`${n.name}!${n.options.appId}`}var uG=1024,dG=30*24*60*60*1e3,BI=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new $I(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return g(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=QM();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=dG}),this._storage.overwrite(this._heartbeatsCache))}catch(r){wi.warn(r)}})}getHeartbeatsHeader(){return g(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=QM(),{heartbeatsToSend:r,unsentEntries:i}=hG(this._heartbeatsCache.heartbeats),s=Fu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return wi.warn(t),""}})}};function QM(){return new Date().toISOString().substring(0,10)}function hG(n,e=uG){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),YM(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),YM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var $I=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return Xi()?MM().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield lG(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return KM(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return KM(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function YM(n){return Fu(JSON.stringify({version:2,heartbeats:n})).length}function fG(n){an(new Fe("platform-logger",e=>new VI(e),"PRIVATE")),an(new Fe("heartbeat",e=>new BI(e),"PRIVATE")),dt(Xp,UI,n),dt(Xp,UI,"esm2017"),dt("fire-js","")}fG("");var GI=class{constructor(e,t){this._delegate=e,this.firebase=t,Xa(e,new Fe("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),tm(this._delegate)))}_getService(e,t=Vr){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=Vr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Xa(this._delegate,e)}_addOrOverwriteComponent(e){HI(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var pG={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},tk=new zn("app-compat","Firebase",pG);function mG(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:dt,setLogLevel:zI,onLog:qI,apps:null,SDK_VERSION:cn,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:WI}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(l){delete e[l]}function i(l){if(l=l||Vr,!on(e,l))throw tk.create("no-app",{appName:l});return e[l]}i.App=n;function s(l,d={}){let h=em(l,d);if(on(e,h.name))return e[h.name];let p=new n(h,t);return e[h.name]=p,p}function o(){return Object.keys(e).map(l=>e[l])}function a(l){let d=l.name,h=d.replace("-compat","");if(an(l)&&l.type==="PUBLIC"){let p=(_=i())=>{if(typeof _[h]!="function")throw tk.create("invalid-app-argument",{appName:d});return _[h]()};l.serviceProps!==void 0&&Wa(p,l.serviceProps),t[h]=p,n.prototype[h]=function(..._){return this._getService.bind(this,d).apply(this,l.multipleInstances?_:[])}}return l.type==="PUBLIC"?t[h]:null}function c(l,d){return d==="serverAuth"?null:d}return t}function rk(){let n=mG(GI);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:rk,extendNamespace:e,createSubscribe:Yp,ErrorFactory:zn,deepExtend:Wa});function e(t){Wa(n,t)}return n}var gG=rk();var nk=new wn("@firebase/app-compat"),_G="@firebase/app-compat",yG="0.2.40";function vG(n){dt(_G,yG,n)}try{let n=CI();if(n.firebase!==void 0){nk.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);let e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&nk.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}var Ne=gG;vG();var wG="firebase",IG="10.13.1";Ne.registerVersion(wG,IG,"app-compat");var mo={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};var cs={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function EG(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function vk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var bE=EG,wk=vk,Ik=new zn("auth","Firebase",vk());var sm=new wn("@firebase/auth");function TG(n,...e){sm.logLevel<=me.WARN&&sm.warn(`Auth (${cn}): ${n}`,...e)}function rm(n,...e){sm.logLevel<=me.ERROR&&sm.error(`Auth (${cn}): ${n}`,...e)}function wt(n,...e){throw DE(n,...e)}function vt(n,...e){return DE(n,...e)}function CE(n,e,t){let r=Object.assign(Object.assign({},wk()),{[e]:t});return new zn("auth","Firebase",r).create(e,{appName:n.name})}function Mt(n){return CE(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function nc(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&wt(n,"argument-error"),CE(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function DE(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Ik.create(n,...e)}function j(n,e,...t){if(!n)throw DE(e,...t)}function Ur(n){let e="INTERNAL ASSERTION FAILED: "+n;throw rm(e),new Error(e)}function Gn(n,e){n||Ur(e)}function Ku(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function SE(){return ik()==="http:"||ik()==="https:"}function ik(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function bG(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(SE()||Kp()||"connection"in navigator)?navigator.onLine:!0}function CG(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var lo=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Gn(t>e,"Short delay should be less than long delay!"),this.isMobile=Uu()||oo()}get(){return bG()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function AE(n,e){Gn(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Qu=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ur("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ur("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ur("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var DG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var SG=new lo(3e4,6e4);function at(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function ct(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){return Ek(n,i,()=>g(this,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let h=vi(Object.assign({key:n.config.apiKey},d)).slice(1),p=yield n._getAdditionalHeaders();return p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode),Qu.fetch()(Tk(n,n.config.apiHost,t,h),Object.assign({method:e,headers:p,referrerPolicy:"no-referrer"},l))}))})}function Ek(n,e,t){return g(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},DG),e);try{let i=new XI(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw qu(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw qu(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw qu(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw qu(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw CE(n,d,l);wt(n,d)}}catch(i){if(i instanceof ot)throw i;wt(n,"network-request-failed",{message:String(i)})}})}function Ti(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){let l=yield ct(n,e,t,r,i);return"mfaPendingCredential"in l&&wt(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function Tk(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?AE(n.config,i):`${n.config.apiScheme}://${i}`}function AG(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var XI=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(vt(this.auth,"network-request-failed")),SG.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function qu(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=vt(n,e,r);return i.customData._tokenResponse=t,i}function sk(n){return n!==void 0&&n.getResponse!==void 0}function ok(n){return n!==void 0&&n.enterprise!==void 0}var ZI=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return AG(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function RG(n){return g(this,null,function*(){return(yield ct(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})}function xG(n,e){return g(this,null,function*(){return ct(n,"GET","/v2/recaptchaConfig",at(n,e))})}function NG(n,e){return g(this,null,function*(){return ct(n,"POST","/v1/accounts:delete",e)})}function PG(n,e){return g(this,null,function*(){return ct(n,"POST","/v1/accounts:update",e)})}function bk(n,e){return g(this,null,function*(){return ct(n,"POST","/v1/accounts:lookup",e)})}function zu(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Ck(n,e=!1){return g(this,null,function*(){let t=z(n),r=yield t.getIdToken(e),i=gm(r);j(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:zu(KI(i.auth_time)),issuedAtTime:zu(KI(i.iat)),expirationTime:zu(KI(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function KI(n){return Number(n)*1e3}function gm(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return rm("JWT malformed, contained fewer than 3 sections"),null;try{let i=Vu(t);return i?JSON.parse(i):(rm("Failed to decode base64 JWT payload"),null)}catch(i){return rm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function ak(n){let e=gm(n);return j(e,"internal-error"),j(typeof e.exp<"u","internal-error"),j(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Ei(n,e,t=!1){return g(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof ot&&MG(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function MG({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var eE=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),t)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Yu=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=zu(this.lastLoginAt),this.creationTime=zu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Ju(n){return g(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Ei(n,bk(t,{idToken:r}));j(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Sk(s.providerUserInfo):[],a=kG(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,d=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Yu(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,h)})}function Dk(n){return g(this,null,function*(){let e=z(n);yield Ju(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function kG(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Sk(n){return n.map(e=>{var{providerId:t}=e,r=lf(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function OG(n,e){return g(this,null,function*(){let t=yield Ek(n,{},()=>g(this,null,function*(){let r=vi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=Tk(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Qu.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function LG(n,e){return g(this,null,function*(){return ct(n,"POST","/v2/accounts:revokeToken",at(n,e))})}var Wu=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){j(e.idToken,"internal-error"),j(typeof e.idToken<"u","internal-error"),j(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ak(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){j(e.length!==0,"internal-error");let t=ak(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return g(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(j(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return g(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield OG(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(j(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(j(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(j(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Ur("not implemented")}};function is(n,e){j(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var uo=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=lf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new eE(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Yu(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){let t=yield Ei(this,this.stsTokenManager.getToken(this.auth,e));return j(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Ck(this,e)}reload(){return Dk(this)}_assign(e){this!==e&&(j(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){j(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return g(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Ju(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){if(Ze(this.auth.app))return Promise.reject(Mt(this.auth));let e=yield this.getIdToken();return yield Ei(this,NG(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,l,d;let h=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,w=(o=t.photoURL)!==null&&o!==void 0?o:void 0,b=(a=t.tenantId)!==null&&a!==void 0?a:void 0,R=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,L=(l=t.createdAt)!==null&&l!==void 0?l:void 0,H=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:U,emailVerified:Q,isAnonymous:ie,providerData:J,stsTokenManager:T}=t;j(U&&T,e,"internal-error");let v=Wu.fromJSON(this.name,T);j(typeof U=="string",e,"internal-error"),is(h,e.name),is(p,e.name),j(typeof Q=="boolean",e,"internal-error"),j(typeof ie=="boolean",e,"internal-error"),is(_,e.name),is(w,e.name),is(b,e.name),is(R,e.name),is(L,e.name),is(H,e.name);let I=new n({uid:U,auth:e,email:p,emailVerified:Q,displayName:h,isAnonymous:ie,photoURL:w,phoneNumber:_,tenantId:b,stsTokenManager:v,createdAt:L,lastLoginAt:H});return J&&Array.isArray(J)&&(I.providerData=J.map(C=>Object.assign({},C))),R&&(I._redirectEventId=R),I}static _fromIdTokenResponse(e,t,r=!1){return g(this,null,function*(){let i=new Wu;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Ju(s),s})}static _fromGetAccountInfoResponse(e,t,r){return g(this,null,function*(){let i=t.users[0];j(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Sk(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new Wu;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Yu(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var ck=new Map;function Yt(n){Gn(n instanceof Function,"Expected a class definition");let e=ck.get(n);return e?(Gn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ck.set(n,e),e)}var FG=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(t,r){return g(this,null,function*(){this.storage[t]=r})}_get(t){return g(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return g(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),os=FG;function jr(n,e,t){return`firebase:${n}:${e}:${t}`}var om=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=jr(this.userKey,i.apiKey,s),this.fullPersistenceKey=jr("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?uo._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return g(this,null,function*(){if(!t.length)return new n(Yt(os),e,r);let i=(yield Promise.all(t.map(l=>g(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||Yt(os),o=jr(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let d=yield l._get(o);if(d){let h=uo._fromJSON(e,d);l!==s&&(a=h),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>g(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new n(s,e,r))})}};function lk(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Nk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ak(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Pk(e))return"Blackberry";if(Mk(e))return"Webos";if(Rk(e))return"Safari";if((e.includes("chrome/")||xk(e))&&!e.includes("edge/"))return"Chrome";if(rc(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Ak(n=He()){return/firefox\//i.test(n)}function Rk(n=He()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xk(n=He()){return/crios\//i.test(n)}function Nk(n=He()){return/iemobile/i.test(n)}function rc(n=He()){return/android/i.test(n)}function Pk(n=He()){return/blackberry/i.test(n)}function Mk(n=He()){return/webos/i.test(n)}function ic(n=He()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function kk(n=He()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function VG(n=He()){var e;return ic(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function UG(){return Qp()&&document.documentMode===10}function Ok(n=He()){return ic(n)||rc(n)||Mk(n)||Pk(n)||/windows phone/i.test(n)||Nk(n)}function RE(n,e=[]){let t;switch(n){case"Browser":t=lk(He());break;case"Worker":t=`${lk(He())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${cn}/${r}`}var tE=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function jG(t){return g(this,arguments,function*(n,e={}){return ct(n,"GET","/v2/passwordPolicy",at(n,e))})}var BG=6,nE=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:BG,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var am=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cm(this),this.idTokenSubscription=new cm(this),this.beforeStateQueue=new tE(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ik,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Yt(t)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield om.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return g(this,null,function*(){try{let t=yield bk(this,{idToken:e}),r=yield uo._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return g(this,null,function*(){var t;if(Ze(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return j(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return g(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield Ju(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=CG()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){if(Ze(this.app))return Promise.reject(Mt(this));let t=e?z(e):null;return t&&j(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return g(this,null,function*(){if(!this._deleted)return e&&j(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return Ze(this.app)?Promise.reject(Mt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Ze(this.app)?Promise.reject(Mt(this)):this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(Yt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return g(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return g(this,null,function*(){let e=yield jG(this),t=new nE(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new zn("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return g(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield LG(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return g(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Yt(e)||this._popupRedirectResolver;j(t,this,"argument-error"),this.redirectPersistenceManager=yield om.create(this,[Yt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(j(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return j(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=RE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return g(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&TG(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Ge(n){return z(n)}var cm=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Yp(t=>this.observer=t)}get next(){return j(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var ad={loadJS(){return g(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $G(n){ad=n}function xE(n){return ad.loadJS(n)}function HG(){return ad.recaptchaV2Script}function qG(){return ad.recaptchaEnterpriseScript}function zG(){return ad.gapiScript}function Lk(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var WG="recaptcha-enterprise",GG="NO_RECAPTCHA",rE=class{constructor(e){this.type=WG,this.auth=Ge(e)}verify(e="verify",t=!1){return g(this,null,function*(){function r(s){return g(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>g(this,null,function*(){xG(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let l=new ZI(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;ok(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(GG)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&ok(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=qG();c.length!==0&&(c+=a),xE(c).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})})}};function uk(n,e,t,r=!1){return g(this,null,function*(){let i=new rE(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function Xu(n,e,t,r){return g(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield uk(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>g(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield uk(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)}))})}function KG(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Yt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function NE(n,e,t){let r=Ge(n);j(r._canInitEmulator,r,"emulator-config-failed"),j(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Fk(e),{host:o,port:a}=QG(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||YG()}function Fk(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function QG(n){let e=Fk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:dk(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:dk(o)}}}function dk(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function YG(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Br=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ur("not implemented")}_getIdTokenResponse(e){return Ur("not implemented")}_linkToIdToken(e,t){return Ur("not implemented")}_getReauthenticationResolver(e){return Ur("not implemented")}};function Vk(n,e){return g(this,null,function*(){return ct(n,"POST","/v1/accounts:resetPassword",at(n,e))})}function JG(n,e){return g(this,null,function*(){return ct(n,"POST","/v1/accounts:update",e)})}function XG(n,e){return g(this,null,function*(){return ct(n,"POST","/v1/accounts:signUp",e)})}function ZG(n,e){return g(this,null,function*(){return ct(n,"POST","/v1/accounts:update",at(n,e))})}function e6(n,e){return g(this,null,function*(){return Ti(n,"POST","/v1/accounts:signInWithPassword",at(n,e))})}function _m(n,e){return g(this,null,function*(){return ct(n,"POST","/v1/accounts:sendOobCode",at(n,e))})}function t6(n,e){return g(this,null,function*(){return _m(n,e)})}function n6(n,e){return g(this,null,function*(){return _m(n,e)})}function r6(n,e){return g(this,null,function*(){return _m(n,e)})}function i6(n,e){return g(this,null,function*(){return _m(n,e)})}function s6(n,e){return g(this,null,function*(){return Ti(n,"POST","/v1/accounts:signInWithEmailLink",at(n,e))})}function o6(n,e){return g(this,null,function*(){return Ti(n,"POST","/v1/accounts:signInWithEmailLink",at(n,e))})}var Zu=class n extends Br{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return g(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xu(e,t,"signInWithPassword",e6);case"emailLink":return s6(e,{email:this._email,oobCode:this._password});default:wt(e,"internal-error")}})}_linkToIdToken(e,t){return g(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xu(e,r,"signUpPassword",XG);case"emailLink":return o6(e,{idToken:t,email:this._email,oobCode:this._password});default:wt(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Ii(n,e){return g(this,null,function*(){return Ti(n,"POST","/v1/accounts:signInWithIdp",at(n,e))})}var a6="http://localhost",fr=class n extends Br{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):wt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=lf(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return Ii(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Ii(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Ii(e,t)}buildRequest(){let e={requestUri:a6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=vi(t)}return e}};function c6(n,e){return g(this,null,function*(){return ct(n,"POST","/v1/accounts:sendVerificationCode",at(n,e))})}function l6(n,e){return g(this,null,function*(){return Ti(n,"POST","/v1/accounts:signInWithPhoneNumber",at(n,e))})}function u6(n,e){return g(this,null,function*(){let t=yield Ti(n,"POST","/v1/accounts:signInWithPhoneNumber",at(n,e));if(t.temporaryProof)throw qu(n,"account-exists-with-different-credential",t);return t})}var d6={USER_NOT_FOUND:"user-not-found"};function h6(n,e){return g(this,null,function*(){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Ti(n,"POST","/v1/accounts:signInWithPhoneNumber",at(n,t),d6)})}var ec=class n extends Br{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return l6(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return u6(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return h6(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function f6(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function p6(n){let e=ts(Qa(n)).link,t=e?ts(Qa(e)).deep_link_id:null,r=ts(Qa(n)).deep_link_id;return(r?ts(Qa(r)).link:null)||r||t||e||n}var ed=class n{constructor(e){var t,r,i,s,o,a;let c=ts(Qa(e)),l=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=f6((i=c.mode)!==null&&i!==void 0?i:null);j(l&&d&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=p6(e);try{return new n(t)}catch{return null}}};var cd=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Zu._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=ed.parseLink(r);return j(i,"argument-error"),Zu._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),pr=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var as=class extends pr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},tc=class n extends as{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return j("providerId"in t&&"signInMethod"in t,"argument-error"),fr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return j(e.idToken||e.accessToken,"argument-error"),fr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new n(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var ym=(()=>{class n extends as{constructor(){super("facebook.com")}static credential(t){return fr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.FACEBOOK_SIGN_IN_METHOD="facebook.com",n.PROVIDER_ID="facebook.com";return n})(),vm=(()=>{class n extends as{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return fr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})(),wm=(()=>{class n extends as{constructor(){super("github.com")}static credential(t){return fr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.GITHUB_SIGN_IN_METHOD="github.com",n.PROVIDER_ID="github.com";return n})(),m6="http://localhost",ho=class n extends Br{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return Ii(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Ii(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Ii(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:m6,returnSecureToken:!0,pendingToken:this.pendingToken}}};var g6="saml.",td=class n extends pr{constructor(e){j(e.startsWith(g6),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=ho.fromJSON(e);return j(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return ho._create(r,t)}catch{return null}}};var Im=(()=>{class n extends as{constructor(){super("twitter.com")}static credential(t,r){return fr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return n.credential(r,i)}catch{return null}}}n.TWITTER_SIGN_IN_METHOD="twitter.com",n.PROVIDER_ID="twitter.com";return n})();function Uk(n,e){return g(this,null,function*(){return Ti(n,"POST","/v1/accounts:signUp",at(n,e))})}var mr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return g(this,null,function*(){let s=yield uo._fromIdTokenResponse(e,r,i),o=hk(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return g(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=hk(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function hk(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function PE(n){return g(this,null,function*(){var e;if(Ze(n.app))return Promise.reject(Mt(n));let t=Ge(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new mr({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield Uk(t,{returnSecureToken:!0}),i=yield mr._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var iE=class n extends ot{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function jk(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?iE._fromErrorAndOperation(n,s,e,r):s})}function Bk(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}function ME(n,e){return g(this,null,function*(){let t=z(n);yield Em(!0,t,e);let{providerUserInfo:r}=yield PG(t.auth,{idToken:yield t.getIdToken(),deleteProvider:[e]}),i=Bk(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),yield t.auth._persistUserIfCurrent(t),t})}function kE(n,e,t=!1){return g(this,null,function*(){let r=yield Ei(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return mr._forOperation(n,"link",r)})}function Em(n,e,t){return g(this,null,function*(){yield Ju(e);let r=Bk(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";j(r.has(t)===n,e.auth,i)})}function $k(n,e,t=!1){return g(this,null,function*(){let{auth:r}=n;if(Ze(r.app))return Promise.reject(Mt(r));let i="reauthenticate";try{let s=yield Ei(n,jk(r,i,e,n),t);j(s.idToken,r,"internal-error");let o=gm(s.idToken);j(o,r,"internal-error");let{sub:a}=o;return j(n.uid===a,r,"user-mismatch"),mr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&wt(r,"user-mismatch"),s}})}function Hk(n,e,t=!1){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let r="signIn",i=yield jk(n,r,e),s=yield mr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function sc(n,e){return g(this,null,function*(){return Hk(Ge(n),e)})}function Tm(n,e){return g(this,null,function*(){let t=z(n);return yield Em(!1,t,e.providerId),kE(t,e)})}function bm(n,e){return g(this,null,function*(){return $k(z(n),e)})}function _6(n,e){return g(this,null,function*(){return Ti(n,"POST","/v1/accounts:signInWithCustomToken",at(n,e))})}function OE(n,e){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let t=Ge(n),r=yield _6(t,{token:e,returnSecureToken:!0}),i=yield mr._fromIdTokenResponse(t,"signIn",r);return yield t._updateCurrentUser(i.user),i})}var fo=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?sE._fromServerResponse(e,t):"totpInfo"in t?oE._fromServerResponse(e,t):wt(e,"internal-error")}},sE=class n extends fo{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},oE=class n extends fo{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function Cm(n,e,t){var r;j(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),j(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(j(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(j(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function LE(n){return g(this,null,function*(){let e=Ge(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function FE(n,e,t){return g(this,null,function*(){let r=Ge(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Cm(r,i,t),yield Xu(r,i,"getOobCode",n6)})}function VE(n,e,t){return g(this,null,function*(){yield Vk(z(n),{oobCode:e,newPassword:t}).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&LE(n),r}))})}function UE(n,e){return g(this,null,function*(){yield ZG(z(n),{oobCode:e})})}function Dm(n,e){return g(this,null,function*(){let t=z(n),r=yield Vk(t,{oobCode:e}),i=r.requestType;switch(j(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":j(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":j(r.mfaInfo,t,"internal-error");default:j(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=fo._fromServerResponse(Ge(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}})}function jE(n,e){return g(this,null,function*(){let{data:t}=yield Dm(z(n),e);return t.email})}function BE(n,e,t){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let r=Ge(n),o=yield Xu(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Uk).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&LE(n),c}),a=yield mr._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function $E(n,e,t){return Ze(n.app)?Promise.reject(Mt(n)):sc(z(n),cd.credential(e,t)).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&LE(n),r}))}function HE(n,e,t){return g(this,null,function*(){let r=Ge(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){j(a.handleCodeInApp,r,"argument-error"),a&&Cm(r,o,a)}s(i,t),yield Xu(r,i,"getOobCode",r6)})}function qE(n,e){let t=ed.parseLink(e);return t?.operation==="EMAIL_SIGNIN"}function zE(n,e,t){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let r=z(n),i=cd.credentialWithLink(e,t||Ku());return j(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),sc(r,i)})}function y6(n,e){return g(this,null,function*(){return ct(n,"POST","/v1/accounts:createAuthUri",at(n,e))})}function WE(n,e){return g(this,null,function*(){let t=SE()?Ku():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=yield y6(z(n),r);return i||[]})}function GE(n,e){return g(this,null,function*(){let t=z(n),i={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&Cm(t.auth,i,e);let{email:s}=yield t6(t.auth,i);s!==n.email&&(yield n.reload())})}function KE(n,e,t){return g(this,null,function*(){let r=z(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield n.getIdToken(),newEmail:e};t&&Cm(r.auth,s,t);let{email:o}=yield i6(r.auth,s);o!==n.email&&(yield n.reload())})}function v6(n,e){return g(this,null,function*(){return ct(n,"POST","/v1/accounts:update",e)})}function QE(r,i){return g(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=z(n),a={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=yield Ei(s,v6(s.auth,a));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;let l=s.providerData.find(({providerId:d})=>d==="password");l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),yield s._updateTokensIfNecessary(c)})}function YE(n,e){let t=z(n);return Ze(t.auth.app)?Promise.reject(Mt(t.auth)):qk(t,e,null)}function JE(n,e){return qk(z(n),null,e)}function qk(n,e,t){return g(this,null,function*(){let{auth:r}=n,s={idToken:yield n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=yield Ei(n,JG(r,s));yield n._updateTokensIfNecessary(o,!0)})}function w6(n){var e,t;if(!n)return null;let{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&n?.idToken){let o=(t=(e=gm(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){let a=o!=="anonymous"&&o!=="custom"?o:null;return new ss(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new aE(s,i);case"github.com":return new cE(s,i);case"google.com":return new lE(s,i);case"twitter.com":return new uE(s,i,n.screenName||null);case"custom":case"anonymous":return new ss(s,null);default:return new ss(s,r,i)}}var ss=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},lm=class extends ss{constructor(e,t,r,i){super(e,t,r),this.username=i}},aE=class extends ss{constructor(e,t){super(e,"facebook.com",t)}},cE=class extends lm{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},lE=class extends ss{constructor(e,t){super(e,"google.com",t)}},uE=class extends lm{constructor(e,t,r){super(e,"twitter.com",t,r)}};function XE(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:w6(t)}var um=class n{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e?.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var dE=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=Ge(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>fo._fromServerResponse(r,a));j(i.mfaPendingCredential,r,"internal-error");let o=um._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,a=>g(this,null,function*(){let c=yield a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let l=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":let d=yield mr._fromIdTokenResponse(r,t.operationType,l);return yield r._updateCurrentUser(d.user),d;case"reauthenticate":return j(t.user,r,"internal-error"),mr._forOperation(t.user,t.operationType,l);default:wt(r,"internal-error")}}))}resolveSignIn(e){return g(this,null,function*(){let t=e;return this.signInResolver(t)})}};function ZE(n,e){var t;let r=z(n),i=e;return j(e.customData.operationType,r,"argument-error"),j((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),dE._fromError(r,i)}function I6(n,e){return ct(n,"POST","/v2/accounts/mfaEnrollment:start",at(n,e))}function E6(n,e){return ct(n,"POST","/v2/accounts/mfaEnrollment:finalize",at(n,e))}function T6(n,e){return ct(n,"POST","/v2/accounts/mfaEnrollment:withdraw",at(n,e))}var hE=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>fo._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}getSession(){return g(this,null,function*(){return um._fromIdtoken(yield this.user.getIdToken(),this.user)})}enroll(e,t){return g(this,null,function*(){let r=e,i=yield this.getSession(),s=yield Ei(this.user,r._process(this.user.auth,i,t));return yield this.user._updateTokensIfNecessary(s),this.user.reload()})}unenroll(e){return g(this,null,function*(){let t=typeof e=="string"?e:e.uid,r=yield this.user.getIdToken();try{let i=yield Ei(this.user,T6(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),yield this.user._updateTokensIfNecessary(i),yield this.user.reload()}catch(i){throw i}})}},QI=new WeakMap;function eT(n){let e=z(n);return QI.has(e)||QI.set(e,hE._fromUser(e)),QI.get(e)}var dm="__sak";var hm=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(dm,"1"),this.storage.removeItem(dm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var b6=1e3,C6=10,D6=(()=>{class n extends hm{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ok(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);UG()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,C6):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},b6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return g(this,null,function*(){yield Tr(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return g(this,null,function*(){let r=yield Tr(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return g(this,null,function*(){yield Tr(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),oc=D6;var S6=(()=>{class n extends hm{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),$r=S6;function A6(n){return Promise.all(n.map(e=>g(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var R6=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return g(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>g(this,null,function*(){return d(r.origin,o)})),l=yield A6(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function go(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var fE=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return g(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=go("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let p=h;if(p.data.eventId===l)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function yt(){return window}function x6(n){yt().location.href=n}function tT(){return typeof yt().WorkerGlobalScope<"u"&&typeof yt().importScripts=="function"}function N6(){return g(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function P6(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function M6(){return tT()?self:null}var zk="firebaseLocalStorageDb",k6=1,fm="firebaseLocalStorage",Wk="fbase_key",po=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Sm(n,e){return n.transaction([fm],e?"readwrite":"readonly").objectStore(fm)}function O6(){let n=indexedDB.deleteDatabase(zk);return new po(n).toPromise()}function pE(){let n=indexedDB.open(zk,k6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(fm,{keyPath:Wk})}catch(i){t(i)}}),n.addEventListener("success",()=>g(this,null,function*(){let r=n.result;r.objectStoreNames.contains(fm)?e(r):(r.close(),yield O6(),e(yield pE()))}))})}function fk(n,e,t){return g(this,null,function*(){let r=Sm(n,!0).put({[Wk]:e,value:t});return new po(r).toPromise()})}function L6(n,e){return g(this,null,function*(){let t=Sm(n,!1).get(e),r=yield new po(t).toPromise();return r===void 0?null:r.value})}function pk(n,e){let t=Sm(n,!0).delete(e);return new po(t).toPromise()}var F6=800,V6=3,U6=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return g(this,null,function*(){return this.db?this.db:(this.db=yield pE(),this.db)})}_withRetries(t){return g(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>V6)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return g(this,null,function*(){return tT()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return g(this,null,function*(){this.receiver=R6._getInstance(M6()),this.receiver._subscribe("keyChanged",(t,r)=>g(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>g(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return g(this,null,function*(){var t,r;if(this.activeServiceWorker=yield N6(),!this.activeServiceWorker)return;this.sender=new fE(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return g(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||P6()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return g(this,null,function*(){try{if(!indexedDB)return!1;let t=yield pE();return yield fk(t,dm,"1"),yield pk(t,dm),!0}catch{}return!1})}_withPendingWrite(t){return g(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(i=>fk(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return g(this,null,function*(){let r=yield this._withRetries(i=>L6(i,t));return this.localCache[t]=r,r})}_remove(t){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(r=>pk(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return g(this,null,function*(){let t=yield this._withRetries(s=>{let o=Sm(s,!1).getAll();return new po(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>g(this,null,function*(){return this._poll()}),F6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),_o=U6;function j6(n,e){return ct(n,"POST","/v2/accounts/mfaSignIn:start",at(n,e))}function B6(n,e){return ct(n,"POST","/v2/accounts/mfaSignIn:finalize",at(n,e))}var $6=500,H6=6e4,nm=1e12,mE=class{constructor(e){this.auth=e,this.counter=nm,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new gE(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;let r=e||nm;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;let r=e||nm;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}execute(e){return g(this,null,function*(){var t;let r=e||nm;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""})}},gE=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;j(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=q6(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},H6)},$6))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function q6(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var YI=Lk("rcb"),z6=new lo(3e4,6e4),_E=class{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=yt().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return j(W6(t),e,"argument-error"),this.shouldResolveImmediately(t)&&sk(yt().grecaptcha)?Promise.resolve(yt().grecaptcha):new Promise((r,i)=>{let s=yt().setTimeout(()=>{i(vt(e,"network-request-failed"))},z6.get());yt()[YI]=()=>{yt().clearTimeout(s),delete yt()[YI];let a=yt().grecaptcha;if(!a||!sk(a)){i(vt(e,"internal-error"));return}let c=a.render;a.render=(l,d)=>{let h=c(l,d);return this.counter++,h},this.hostLanguage=t,r(a)};let o=`${HG()}?${vi({onload:YI,render:"explicit",hl:t})}`;xE(o).catch(()=>{clearTimeout(s),i(vt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=yt().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function W6(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var yE=class{load(e){return g(this,null,function*(){return new mE(e)})}clearedOneInstance(){}};var Gk="recaptcha",G6={theme:"light",type:"image"},nd=class{constructor(e,t,r=Object.assign({},G6)){this.parameters=r,this.type=Gk,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ge(e),this.isInvisible=this.parameters.size==="invisible",j(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof t=="string"?document.getElementById(t):t;j(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new yE:new _E,this.validateStartingState()}verify(){return g(this,null,function*(){this.assertNotDestroyed();let e=yield this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){j(!this.parameters.sitekey,this.auth,"argument-error"),j(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),j(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=yt()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){j(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){return g(this,null,function*(){if(yield this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId})}init(){return g(this,null,function*(){j(SE()&&!tT(),this.auth,"internal-error"),yield K6(),this.recaptcha=yield this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=yield RG(this.auth);j(e,this.auth,"internal-error"),this.parameters.sitekey=e})}getAssertedRecaptcha(){return j(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function K6(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var rd=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=ec._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};function nT(n,e,t){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let r=Ge(n),i=yield Am(r,e,z(t));return new rd(i,s=>sc(r,s))})}function rT(n,e,t){return g(this,null,function*(){let r=z(n);yield Em(!1,r,"phone");let i=yield Am(r.auth,e,z(t));return new rd(i,s=>Tm(r,s))})}function iT(n,e,t){return g(this,null,function*(){let r=z(n);if(Ze(r.auth.app))return Promise.reject(Mt(r.auth));let i=yield Am(r.auth,e,z(t));return new rd(i,s=>bm(r,s))})}function Am(n,e,t){return g(this,null,function*(){var r;let i=yield t.verify();try{j(typeof i=="string",n,"argument-error"),j(t.type===Gk,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return j(o.type==="enroll",n,"internal-error"),(yield I6(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{j(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return j(a,n,"missing-multi-factor-info"),(yield j6(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=yield c6(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}})}function sT(n,e){return g(this,null,function*(){let t=z(n);if(Ze(t.auth.app))return Promise.reject(Mt(t.auth));yield kE(t,e)})}var yo=(()=>{class n{constructor(t){this.providerId=n.PROVIDER_ID,this.auth=Ge(t)}verifyPhoneNumber(t,r){return Am(this.auth,t,z(r))}static credential(t,r){return ec._fromVerification(t,r)}static credentialFromResult(t){let r=t;return n.credentialFromTaggedObject(r)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{phoneNumber:r,temporaryProof:i}=t;return r&&i?ec._fromTokenResponse(r,i):null}}n.PROVIDER_ID="phone",n.PHONE_SIGN_IN_METHOD="phone";return n})();function vo(n,e){return e?Yt(e):(j(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var id=class extends Br{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ii(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ii(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ii(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Q6(n){return Hk(n.auth,new id(n),n.bypassAuthState)}function Y6(n){let{auth:e,user:t}=n;return j(t,e,"internal-error"),$k(t,new id(n),n.bypassAuthState)}function J6(n){return g(this,null,function*(){let{auth:e,user:t}=n;return j(t,e,"internal-error"),kE(t,new id(n),n.bypassAuthState)})}var pm=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>g(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return g(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Q6;case"linkViaPopup":case"linkViaRedirect":return J6;case"reauthViaPopup":case"reauthViaRedirect":return Y6;default:wt(this.auth,"internal-error")}}resolve(e){Gn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Gn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var X6=new lo(2e3,1e4);function oT(n,e,t){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(vt(n,"operation-not-supported-in-this-environment"));let r=Ge(n);nc(n,e,pr);let i=vo(r,t);return new lT(r,"signInViaPopup",e,i).executeNotNull()})}function aT(n,e,t){return g(this,null,function*(){let r=z(n);if(Ze(r.auth.app))return Promise.reject(vt(r.auth,"operation-not-supported-in-this-environment"));nc(r.auth,e,pr);let i=vo(r.auth,t);return new lT(r.auth,"reauthViaPopup",e,i,r).executeNotNull()})}function cT(n,e,t){return g(this,null,function*(){let r=z(n);nc(r.auth,e,pr);let i=vo(r.auth,t);return new lT(r.auth,"linkViaPopup",e,i,r).executeNotNull()})}var lT=(()=>{class n extends pm{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return g(this,null,function*(){let t=yield this.execute();return j(t,this.auth,"internal-error"),t})}onExecution(){return g(this,null,function*(){Gn(this.filter.length===1,"Popup operations only handle one event");let t=go();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(vt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(vt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(vt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,X6.get())};t()}}n.currentPopupAction=null;return n})(),Z6="pendingRedirect",Gu=new Map,vE=class n extends pm{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return g(this,null,function*(){let e=Gu.get(this.auth._key());if(!e){try{let r=(yield e9(this.resolver,this.auth))?yield Tr(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Gu.set(this.auth._key(),e)}return this.bypassAuthState||Gu.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return g(this,null,function*(){if(e.type==="signInViaRedirect")return Tr(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Tr(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return g(this,null,function*(){})}cleanUp(){}};function e9(n,e){return g(this,null,function*(){let t=Yk(e),r=Qk(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function uT(n,e){return g(this,null,function*(){return Qk(n)._set(Yk(e),"true")})}function Kk(){Gu.clear()}function ac(n,e){Gu.set(n._key(),e)}function Qk(n){return Yt(n._redirectPersistence)}function Yk(n){return jr(Z6,n.config.apiKey,n.name)}function dT(n,e,t){return t9(n,e,t)}function t9(n,e,t){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let r=Ge(n);nc(n,e,pr),yield r._initializationPromise;let i=vo(r,t);return yield uT(i,r),i._openRedirect(r,e,"signInViaRedirect")})}function hT(n,e,t){return n9(n,e,t)}function n9(n,e,t){return g(this,null,function*(){let r=z(n);if(nc(r.auth,e,pr),Ze(r.auth.app))return Promise.reject(Mt(r.auth));yield r.auth._initializationPromise;let i=vo(r.auth,t);yield uT(i,r.auth);let s=yield Jk(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)})}function fT(n,e,t){return r9(n,e,t)}function r9(n,e,t){return g(this,null,function*(){let r=z(n);nc(r.auth,e,pr),yield r.auth._initializationPromise;let i=vo(r.auth,t);yield Em(!1,r,e.providerId),yield uT(i,r.auth);let s=yield Jk(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)})}function pT(n,e){return g(this,null,function*(){return yield Ge(n)._initializationPromise,wo(n,e,!1)})}function wo(n,e,t=!1){return g(this,null,function*(){if(Ze(n.app))return Promise.reject(Mt(n));let r=Ge(n),i=vo(r,e),o=yield new vE(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}function Jk(n){return g(this,null,function*(){let e=go(`${n.uid}:::`);return n._redirectEventId=e,yield n.auth._setRedirectUser(n),yield n.auth._persistUserIfCurrent(n),e})}var i9=10*60*1e3,sd=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!s9(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Xk(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(vt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=i9&&this.cachedEventUids.clear(),this.cachedEventUids.has(mk(e))}saveEventToCache(e){this.cachedEventUids.add(mk(e)),this.lastProcessedEventTime=Date.now()}};function mk(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Xk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function s9(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Xk(n);default:return!1}}function mT(t){return g(this,arguments,function*(n,e={}){return ct(n,"GET","/v1/projects",e)})}var o9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,a9=/^https?/;function c9(n){return g(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield mT(n);for(let t of e)try{if(l9(t))return}catch{}wt(n,"unauthorized-domain")})}function l9(n){let e=Ku(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!a9.test(t))return!1;if(o9.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var u9=new lo(3e4,6e4);function gk(){let n=yt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function d9(n){return new Promise((e,t)=>{var r,i,s;function o(){gk(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gk(),t(vt(n,"network-request-failed"))},timeout:u9.get()})}if(!((i=(r=yt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=yt().gapi)===null||s===void 0)&&s.load)o();else{let a=Lk("iframefcb");return yt()[a]=()=>{gapi.load?o():t(vt(n,"network-request-failed"))},xE(`${zG()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw im=null,e})}var im=null;function h9(n){return im=im||d9(n),im}var f9=new lo(5e3,15e3),p9="__/auth/iframe",m9="emulator/auth/iframe",g9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function y9(n){let e=n.config;j(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?AE(e,m9):`https://${n.config.authDomain}/${p9}`,r={apiKey:e.apiKey,appName:n.name,v:cn},i=_9.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${vi(r).slice(1)}`}function v9(n){return g(this,null,function*(){let e=yield h9(n),t=yt().gapi;return j(t,n,"internal-error"),e.open({where:document.body,url:y9(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:g9,dontclear:!0},r=>new Promise((i,s)=>g(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=vt(n,"network-request-failed"),a=yt().setTimeout(()=>{s(o)},f9.get());function c(){yt().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var w9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},I9=500,E9=600,T9="_blank",b9="http://localhost",od=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function C9(n,e,t,r=I9,i=E9){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},w9),{width:r.toString(),height:i.toString(),top:s,left:o}),l=He().toLowerCase();t&&(a=xk(l)?T9:t),Ak(l)&&(e=e||b9,c.scrollbars="yes");let d=Object.entries(c).reduce((p,[_,w])=>`${p}${_}=${w},`,"");if(VG(l)&&a!=="_self")return D9(e||"",a),new od(null);let h=window.open(e||"",a,d);j(h,n,"popup-blocked");try{h.focus()}catch{}return new od(h)}function D9(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var S9="__/auth/handler",A9="emulator/auth/handler",R9=encodeURIComponent("fac");function mm(n,e,t,r,i,s){return g(this,null,function*(){j(n.config.authDomain,n,"auth-domain-config-required"),j(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:cn,eventId:i};if(e instanceof pr){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Ka(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(s||{}))o[d]=h}if(e instanceof as){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),l=c?`#${R9}=${encodeURIComponent(c)}`:"";return`${x9(n)}?${vi(a).slice(1)}${l}`})}function x9({config:n}){return n.emulator?AE(n,A9):`https://${n.authDomain}/${S9}`}var JI="webStorageSupport",wE=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$r,this._completeRedirectFn=wo,this._overrideRedirectResult=ac}_openPopup(e,t,r,i){return g(this,null,function*(){var s;Gn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield mm(e,t,r,Ku(),i);return C9(e,o,go())})}_openRedirect(e,t,r,i){return g(this,null,function*(){yield this._originValidation(e);let s=yield mm(e,t,r,Ku(),i);return x6(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Gn(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return g(this,null,function*(){let t=yield v9(e),r=new sd(e);return t.register("authEvent",i=>(j(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(JI,{type:JI},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[JI];o!==void 0&&t(!!o),wt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=c9(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ok()||Rk()||ic()}},gT=wE,IE=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Ur("unexpected MultiFactorSessionType")}}},EE=class n extends IE{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return E6(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return B6(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},_T=(()=>{class n{constructor(){}static assertion(t){return EE._fromCredential(t)}}return n.FACTOR_ID="phone",n})();var _k="@firebase/auth",yk="1.7.8";var TE=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){j(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function N9(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function P9(n){an(new Fe("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;j(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:RE(n)},l=new am(r,i,s,c);return KG(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),an(new Fe("auth-internal",e=>{let t=Ge(e.getProvider("auth").getImmediate());return(r=>new TE(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),dt(_k,yk,N9(n)),dt(_k,yk,"esm2017")}var M9=5*60,ise=NM("authIdTokenMaxAge")||M9;function k9(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}$G({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=vt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",k9().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});P9("Browser");function Io(){return window}var O9=2e3;function L9(n,e,t){return g(this,null,function*(){var r;let{BuildInfo:i}=Io();Gn(e.sessionId,"AuthEvent did not contain a session ID");let s=yield B9(e.sessionId),o={};return ic()?o.ibi=i.packageName:rc()?o.apn=i.packageName:wt(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,mm(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)})}function F9(n){return g(this,null,function*(){let{BuildInfo:e}=Io(),t={};ic()?t.iosBundleId=e.packageName:rc()?t.androidPackageName=e.packageName:wt(n,"operation-not-supported-in-this-environment"),yield mT(n,t)})}function V9(n){let{cordova:e}=Io();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,kk()?"_blank":"_system","location=yes"),t(i)})})}function U9(n,e,t){return g(this,null,function*(){let{cordova:r}=Io(),i=()=>{};try{yield new Promise((s,o)=>{let a=null;function c(){var h;s();let p=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof p=="function"&&p(),typeof t?.close=="function"&&t.close()}function l(){a||(a=window.setTimeout(()=>{o(vt(n,"redirect-cancelled-by-user"))},O9))}function d(){document?.visibilityState==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),rc()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{i()}})}function j9(n){var e,t,r,i,s,o,a,c,l,d;let h=Io();j(typeof((e=h?.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),j(typeof((t=h?.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),j(typeof((s=(i=(r=h?.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),j(typeof((c=(a=(o=h?.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),j(typeof((d=(l=h?.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||d===void 0?void 0:d.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function B9(n){return g(this,null,function*(){let e=$9(n),t=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")})}function $9(n){if(Gn(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var H9=20,yT=class extends sd{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}initialized(){return g(this,null,function*(){yield this.initPromise})}};function q9(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:G9(),postBody:null,tenantId:n.tenantId,error:vt(n,"no-auth-event")}}function z9(n,e){return vT()._set(wT(n),e)}function Zk(n){return g(this,null,function*(){let e=yield vT()._get(wT(n));return e&&(yield vT()._remove(wT(n))),e})}function W9(n,e){var t,r;let i=Q9(e);if(i.includes("/__/auth/callback")){let s=Rm(i),o=s.firebaseError?K9(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o?.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],c=a?vt(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function G9(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<H9;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function vT(){return Yt(oc)}function wT(n){return jr("authEvent",n.config.apiKey,n.name)}function K9(n){try{return JSON.parse(n)}catch{return null}}function Q9(n){let e=Rm(n),t=e.link?decodeURIComponent(e.link):void 0,r=Rm(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Rm(i).link||i||r||t||n}function Rm(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return ts(t.join("?"))}var Y9=500,IT=class{constructor(){this._redirectPersistence=$r,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=wo,this._overrideRedirectResult=ac}_initialize(e){return g(this,null,function*(){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new yT(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r})}_openPopup(e){wt(e,"operation-not-supported-in-this-environment")}_openRedirect(e,t,r,i){return g(this,null,function*(){j9(e);let s=yield this._initialize(e);yield s.initialized(),s.resetRedirect(),Kk(),yield this._originValidation(e);let o=q9(e,r,i);yield z9(e,o);let a=yield L9(e,o,t),c=yield V9(a);return U9(e,s,c)})}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=F9(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Io(),o=setTimeout(()=>g(this,null,function*(){yield Zk(e),t.onEvent(eO())}),Y9),a=d=>g(this,null,function*(){clearTimeout(o);let h=yield Zk(e),p=null;h&&d?.url&&(p=W9(h,d.url)),t.onEvent(p||eO())});typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);let c=i,l=`${s.packageName.toLowerCase()}://`;Io().handleOpenURL=d=>g(this,null,function*(){if(d.toLowerCase().startsWith(l)&&a({url:d}),typeof c=="function")try{c(d)}catch(h){console.error(h)}})}},tO=IT;function eO(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:vt("no-auth-event")}}function nO(n,e){Ge(n)._logFramework(e)}var X9="@firebase/auth-compat",Z9="0.5.13";var e5=1e3;function dd(){var n;return((n=self?.location)===null||n===void 0?void 0:n.protocol)||null}function t5(){return dd()==="http:"||dd()==="https:"}function sO(n=He()){return!!((dd()==="file:"||dd()==="ionic:"||dd()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function n5(){return oo()||Gp()}function r5(){return Qp()&&document?.documentMode===11}function i5(n=He()){return/Edge\/\d+/.test(n)}function s5(n=He()){return r5()||i5(n)}function oO(){try{let n=self.localStorage,e=go();if(n)return n.setItem(e,"1"),n.removeItem(e),s5()?Xi():!0}catch{return ST()&&Xi()}return!1}function ST(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function ET(){return(t5()||Kp()||sO())&&!n5()&&oO()&&!ST()}function aO(){return sO()&&typeof document<"u"}function o5(){return g(this,null,function*(){return aO()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},e5);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1})}function a5(){return typeof window<"u"?window:null}var xn={LOCAL:"local",NONE:"none",SESSION:"session"},ld=j,cO="persistence";function c5(n,e){if(ld(Object.values(xn).includes(e),n,"invalid-persistence-type"),oo()){ld(e!==xn.SESSION,n,"unsupported-persistence-type");return}if(Gp()){ld(e===xn.NONE,n,"unsupported-persistence-type");return}if(ST()){ld(e===xn.NONE||e===xn.LOCAL&&Xi(),n,"unsupported-persistence-type");return}ld(e===xn.NONE||oO(),n,"unsupported-persistence-type")}function TT(n){return g(this,null,function*(){yield n._initializationPromise;let e=lO(),t=jr(cO,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())})}function l5(n,e){let t=lO();if(!t)return[];let r=jr(cO,n,e);switch(t.getItem(r)){case xn.NONE:return[os];case xn.LOCAL:return[_o,$r];case xn.SESSION:return[$r];default:return[]}}function lO(){var n;try{return((n=a5())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}var u5=j,Hr=class{constructor(){this.browserResolver=Yt(gT),this.cordovaResolver=Yt(tO),this.underlyingResolver=null,this._redirectPersistence=$r,this._completeRedirectFn=wo,this._overrideRedirectResult=ac}_initialize(e){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)})}_openPopup(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)})}_openRedirect(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)})}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return aO()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return u5(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){return g(this,null,function*(){if(this.underlyingResolver)return;let e=yield o5();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver})}};function uO(n){return n.unwrap()}function d5(n){return n.wrapped()}function h5(n){return dO(n)}function f5(n,e){var t;let r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let i=e;i.resolver=new CT(n,ZE(n,e))}else if(r){let i=dO(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function dO(n){let{_tokenResponse:e}=n instanceof ot?n.customData:n;if(!e)return null;if(!(n instanceof ot)&&"temporaryProof"in e&&"phoneNumber"in e)return yo.credentialFromResult(n);let t=e.providerId;if(!t||t===mo.PASSWORD)return null;let r;switch(t){case mo.GOOGLE:r=vm;break;case mo.FACEBOOK:r=ym;break;case mo.GITHUB:r=wm;break;case mo.TWITTER:r=Im;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?ho._create(t,a):fr._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new tc(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof ot?r.credentialFromError(n):r.credentialFromResult(n)}function In(n,e){return e.catch(t=>{throw t instanceof ot&&f5(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:h5(t),additionalUserInfo:XE(t),user:cc.getOrCreate(i)}})}function bT(n,e){return g(this,null,function*(){let t=yield e;return{verificationId:t.verificationId,confirm:r=>In(n,t.confirm(r))}})}var CT=class{constructor(e,t){this.resolver=t,this.auth=d5(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return In(uO(this.auth),this.resolver.resolveSignIn(e))}};var cc=class n{constructor(e){this._delegate=e,this.multiFactor=eT(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}linkWithCredential(e){return g(this,null,function*(){return In(this.auth,Tm(this._delegate,e))})}linkWithPhoneNumber(e,t){return g(this,null,function*(){return bT(this.auth,rT(this._delegate,e,t))})}linkWithPopup(e){return g(this,null,function*(){return In(this.auth,cT(this._delegate,e,Hr))})}linkWithRedirect(e){return g(this,null,function*(){return yield TT(Ge(this.auth)),fT(this._delegate,e,Hr)})}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}reauthenticateWithCredential(e){return g(this,null,function*(){return In(this.auth,bm(this._delegate,e))})}reauthenticateWithPhoneNumber(e,t){return bT(this.auth,iT(this._delegate,e,t))}reauthenticateWithPopup(e){return In(this.auth,aT(this._delegate,e,Hr))}reauthenticateWithRedirect(e){return g(this,null,function*(){return yield TT(Ge(this.auth)),hT(this._delegate,e,Hr)})}sendEmailVerification(e){return GE(this._delegate,e)}unlink(e){return g(this,null,function*(){return yield ME(this._delegate,e),this})}updateEmail(e){return YE(this._delegate,e)}updatePassword(e){return JE(this._delegate,e)}updatePhoneNumber(e){return sT(this._delegate,e)}updateProfile(e){return QE(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return KE(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};cc.USER_MAP=new WeakMap;var ud=j,rO=(()=>{class n{constructor(t,r){if(this.app=t,r.isInitialized()){this._delegate=r.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:i}=t.options;ud(i,"invalid-api-key",{appName:t.name}),ud(i,"invalid-api-key",{appName:t.name});let s=typeof window<"u"?Hr:void 0;this._delegate=r.initialize({options:{persistence:p5(i,t.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(bE),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?cc.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,r){NE(this._delegate,t,r)}applyActionCode(t){return UE(this._delegate,t)}checkActionCode(t){return Dm(this._delegate,t)}confirmPasswordReset(t,r){return VE(this._delegate,t,r)}createUserWithEmailAndPassword(t,r){return g(this,null,function*(){return In(this._delegate,BE(this._delegate,t,r))})}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return WE(this._delegate,t)}isSignInWithEmailLink(t){return qE(this._delegate,t)}getRedirectResult(){return g(this,null,function*(){ud(ET(),this._delegate,"operation-not-supported-in-this-environment");let t=yield pT(this._delegate,Hr);return t?In(this._delegate,Promise.resolve(t)):{credential:null,user:null}})}addFrameworkForLogging(t){nO(this._delegate,t)}onAuthStateChanged(t,r,i){let{next:s,error:o,complete:a}=iO(t,r,i);return this._delegate.onAuthStateChanged(s,o,a)}onIdTokenChanged(t,r,i){let{next:s,error:o,complete:a}=iO(t,r,i);return this._delegate.onIdTokenChanged(s,o,a)}sendSignInLinkToEmail(t,r){return HE(this._delegate,t,r)}sendPasswordResetEmail(t,r){return FE(this._delegate,t,r||void 0)}setPersistence(t){return g(this,null,function*(){c5(this._delegate,t);let r;switch(t){case xn.SESSION:r=$r;break;case xn.LOCAL:r=(yield Yt(_o)._isAvailable())?_o:oc;break;case xn.NONE:r=os;break;default:return wt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(r)})}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return In(this._delegate,PE(this._delegate))}signInWithCredential(t){return In(this._delegate,sc(this._delegate,t))}signInWithCustomToken(t){return In(this._delegate,OE(this._delegate,t))}signInWithEmailAndPassword(t,r){return In(this._delegate,$E(this._delegate,t,r))}signInWithEmailLink(t,r){return In(this._delegate,zE(this._delegate,t,r))}signInWithPhoneNumber(t,r){return bT(this._delegate,nT(this._delegate,t,r))}signInWithPopup(t){return g(this,null,function*(){return ud(ET(),this._delegate,"operation-not-supported-in-this-environment"),In(this._delegate,oT(this._delegate,t,Hr))})}signInWithRedirect(t){return g(this,null,function*(){return ud(ET(),this._delegate,"operation-not-supported-in-this-environment"),yield TT(this._delegate),dT(this._delegate,t,Hr)})}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return jE(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return n.Persistence=xn,n})();function iO(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&cc.getOrCreate(o)),error:e,complete:t}}function p5(n,e){let t=l5(n,e);if(typeof self<"u"&&!t.includes(_o)&&t.push(_o),typeof window<"u")for(let r of[oc,$r])t.includes(r)||t.push(r);return t.includes(os)||t.push(os),t}var hd=class{constructor(){this.providerId="phone",this._delegate=new yo(uO(Ne.auth()))}static credential(e,t){return yo.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};hd.PHONE_SIGN_IN_METHOD=yo.PHONE_SIGN_IN_METHOD;hd.PROVIDER_ID=yo.PROVIDER_ID;var m5=j,DT=class{constructor(e,t,r=Ne.app()){var i;m5((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new nd(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var g5="auth-compat";function _5(n){n.INTERNAL.registerComponent(new Fe(g5,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new rO(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:cs.EMAIL_SIGNIN,PASSWORD_RESET:cs.PASSWORD_RESET,RECOVER_EMAIL:cs.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:cs.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:cs.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:cs.VERIFY_EMAIL}},EmailAuthProvider:cd,FacebookAuthProvider:ym,GithubAuthProvider:wm,GoogleAuthProvider:vm,OAuthProvider:tc,SAMLAuthProvider:td,PhoneAuthProvider:hd,PhoneMultiFactorGenerator:_T,RecaptchaVerifier:DT,TwitterAuthProvider:Im,Auth:rO,AuthCredential:Br,Error:ot}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(X9,Z9)}_5(Ne);var hO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fO={};var ls,AT;(function(){var n;function e(T,v){function I(){}I.prototype=v.prototype,T.D=v.prototype,T.prototype=new I,T.prototype.constructor=T,T.C=function(C,D,N){for(var E=Array(arguments.length-2),ai=2;ai<arguments.length;ai++)E[ai-2]=arguments[ai];return v.prototype[D].apply(C,E)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,v,I){I||(I=0);var C=Array(16);if(typeof v=="string")for(var D=0;16>D;++D)C[D]=v.charCodeAt(I++)|v.charCodeAt(I++)<<8|v.charCodeAt(I++)<<16|v.charCodeAt(I++)<<24;else for(D=0;16>D;++D)C[D]=v[I++]|v[I++]<<8|v[I++]<<16|v[I++]<<24;v=T.g[0],I=T.g[1],D=T.g[2];var N=T.g[3],E=v+(N^I&(D^N))+C[0]+3614090360&4294967295;v=I+(E<<7&4294967295|E>>>25),E=N+(D^v&(I^D))+C[1]+3905402710&4294967295,N=v+(E<<12&4294967295|E>>>20),E=D+(I^N&(v^I))+C[2]+606105819&4294967295,D=N+(E<<17&4294967295|E>>>15),E=I+(v^D&(N^v))+C[3]+3250441966&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(N^I&(D^N))+C[4]+4118548399&4294967295,v=I+(E<<7&4294967295|E>>>25),E=N+(D^v&(I^D))+C[5]+1200080426&4294967295,N=v+(E<<12&4294967295|E>>>20),E=D+(I^N&(v^I))+C[6]+2821735955&4294967295,D=N+(E<<17&4294967295|E>>>15),E=I+(v^D&(N^v))+C[7]+4249261313&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(N^I&(D^N))+C[8]+1770035416&4294967295,v=I+(E<<7&4294967295|E>>>25),E=N+(D^v&(I^D))+C[9]+2336552879&4294967295,N=v+(E<<12&4294967295|E>>>20),E=D+(I^N&(v^I))+C[10]+4294925233&4294967295,D=N+(E<<17&4294967295|E>>>15),E=I+(v^D&(N^v))+C[11]+2304563134&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(N^I&(D^N))+C[12]+1804603682&4294967295,v=I+(E<<7&4294967295|E>>>25),E=N+(D^v&(I^D))+C[13]+4254626195&4294967295,N=v+(E<<12&4294967295|E>>>20),E=D+(I^N&(v^I))+C[14]+2792965006&4294967295,D=N+(E<<17&4294967295|E>>>15),E=I+(v^D&(N^v))+C[15]+1236535329&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(D^N&(I^D))+C[1]+4129170786&4294967295,v=I+(E<<5&4294967295|E>>>27),E=N+(I^D&(v^I))+C[6]+3225465664&4294967295,N=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(N^v))+C[11]+643717713&4294967295,D=N+(E<<14&4294967295|E>>>18),E=I+(N^v&(D^N))+C[0]+3921069994&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^N&(I^D))+C[5]+3593408605&4294967295,v=I+(E<<5&4294967295|E>>>27),E=N+(I^D&(v^I))+C[10]+38016083&4294967295,N=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(N^v))+C[15]+3634488961&4294967295,D=N+(E<<14&4294967295|E>>>18),E=I+(N^v&(D^N))+C[4]+3889429448&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^N&(I^D))+C[9]+568446438&4294967295,v=I+(E<<5&4294967295|E>>>27),E=N+(I^D&(v^I))+C[14]+3275163606&4294967295,N=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(N^v))+C[3]+4107603335&4294967295,D=N+(E<<14&4294967295|E>>>18),E=I+(N^v&(D^N))+C[8]+1163531501&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^N&(I^D))+C[13]+2850285829&4294967295,v=I+(E<<5&4294967295|E>>>27),E=N+(I^D&(v^I))+C[2]+4243563512&4294967295,N=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(N^v))+C[7]+1735328473&4294967295,D=N+(E<<14&4294967295|E>>>18),E=I+(N^v&(D^N))+C[12]+2368359562&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(I^D^N)+C[5]+4294588738&4294967295,v=I+(E<<4&4294967295|E>>>28),E=N+(v^I^D)+C[8]+2272392833&4294967295,N=v+(E<<11&4294967295|E>>>21),E=D+(N^v^I)+C[11]+1839030562&4294967295,D=N+(E<<16&4294967295|E>>>16),E=I+(D^N^v)+C[14]+4259657740&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^N)+C[1]+2763975236&4294967295,v=I+(E<<4&4294967295|E>>>28),E=N+(v^I^D)+C[4]+1272893353&4294967295,N=v+(E<<11&4294967295|E>>>21),E=D+(N^v^I)+C[7]+4139469664&4294967295,D=N+(E<<16&4294967295|E>>>16),E=I+(D^N^v)+C[10]+3200236656&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^N)+C[13]+681279174&4294967295,v=I+(E<<4&4294967295|E>>>28),E=N+(v^I^D)+C[0]+3936430074&4294967295,N=v+(E<<11&4294967295|E>>>21),E=D+(N^v^I)+C[3]+3572445317&4294967295,D=N+(E<<16&4294967295|E>>>16),E=I+(D^N^v)+C[6]+76029189&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^N)+C[9]+3654602809&4294967295,v=I+(E<<4&4294967295|E>>>28),E=N+(v^I^D)+C[12]+3873151461&4294967295,N=v+(E<<11&4294967295|E>>>21),E=D+(N^v^I)+C[15]+530742520&4294967295,D=N+(E<<16&4294967295|E>>>16),E=I+(D^N^v)+C[2]+3299628645&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(D^(I|~N))+C[0]+4096336452&4294967295,v=I+(E<<6&4294967295|E>>>26),E=N+(I^(v|~D))+C[7]+1126891415&4294967295,N=v+(E<<10&4294967295|E>>>22),E=D+(v^(N|~I))+C[14]+2878612391&4294967295,D=N+(E<<15&4294967295|E>>>17),E=I+(N^(D|~v))+C[5]+4237533241&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~N))+C[12]+1700485571&4294967295,v=I+(E<<6&4294967295|E>>>26),E=N+(I^(v|~D))+C[3]+2399980690&4294967295,N=v+(E<<10&4294967295|E>>>22),E=D+(v^(N|~I))+C[10]+4293915773&4294967295,D=N+(E<<15&4294967295|E>>>17),E=I+(N^(D|~v))+C[1]+2240044497&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~N))+C[8]+1873313359&4294967295,v=I+(E<<6&4294967295|E>>>26),E=N+(I^(v|~D))+C[15]+4264355552&4294967295,N=v+(E<<10&4294967295|E>>>22),E=D+(v^(N|~I))+C[6]+2734768916&4294967295,D=N+(E<<15&4294967295|E>>>17),E=I+(N^(D|~v))+C[13]+1309151649&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~N))+C[4]+4149444226&4294967295,v=I+(E<<6&4294967295|E>>>26),E=N+(I^(v|~D))+C[11]+3174756917&4294967295,N=v+(E<<10&4294967295|E>>>22),E=D+(v^(N|~I))+C[2]+718787259&4294967295,D=N+(E<<15&4294967295|E>>>17),E=I+(N^(D|~v))+C[9]+3951481745&4294967295,T.g[0]=T.g[0]+v&4294967295,T.g[1]=T.g[1]+(D+(E<<21&4294967295|E>>>11))&4294967295,T.g[2]=T.g[2]+D&4294967295,T.g[3]=T.g[3]+N&4294967295}r.prototype.u=function(T,v){v===void 0&&(v=T.length);for(var I=v-this.blockSize,C=this.B,D=this.h,N=0;N<v;){if(D==0)for(;N<=I;)i(this,T,N),N+=this.blockSize;if(typeof T=="string"){for(;N<v;)if(C[D++]=T.charCodeAt(N++),D==this.blockSize){i(this,C),D=0;break}}else for(;N<v;)if(C[D++]=T[N++],D==this.blockSize){i(this,C),D=0;break}}this.h=D,this.o+=v},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var v=1;v<T.length-8;++v)T[v]=0;var I=8*this.o;for(v=T.length-8;v<T.length;++v)T[v]=I&255,I/=256;for(this.u(T),T=Array(16),v=I=0;4>v;++v)for(var C=0;32>C;C+=8)T[I++]=this.g[v]>>>C&255;return T};function s(T,v){var I=a;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=v(T)}function o(T,v){this.h=v;for(var I=[],C=!0,D=T.length-1;0<=D;D--){var N=T[D]|0;C&&N==v||(I[D]=N,C=!1)}this.g=I}var a={};function c(T){return-128<=T&&128>T?s(T,function(v){return new o([v|0],0>v?-1:0)}):new o([T|0],0>T?-1:0)}function l(T){if(isNaN(T)||!isFinite(T))return h;if(0>T)return R(l(-T));for(var v=[],I=1,C=0;T>=I;C++)v[C]=T/I|0,I*=4294967296;return new o(v,0)}function d(T,v){if(T.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(T.charAt(0)=="-")return R(d(T.substring(1),v));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=l(Math.pow(v,8)),C=h,D=0;D<T.length;D+=8){var N=Math.min(8,T.length-D),E=parseInt(T.substring(D,D+N),v);8>N?(N=l(Math.pow(v,N)),C=C.j(N).add(l(E))):(C=C.j(I),C=C.add(l(E)))}return C}var h=c(0),p=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(b(this))return-R(this).m();for(var T=0,v=1,I=0;I<this.g.length;I++){var C=this.i(I);T+=(0<=C?C:4294967296+C)*v,v*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(w(this))return"0";if(b(this))return"-"+R(this).toString(T);for(var v=l(Math.pow(T,6)),I=this,C="";;){var D=Q(I,v).g;I=L(I,D.j(v));var N=((0<I.g.length?I.g[0]:I.h)>>>0).toString(T);if(I=D,w(I))return N+C;for(;6>N.length;)N="0"+N;C=N+C}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function w(T){if(T.h!=0)return!1;for(var v=0;v<T.g.length;v++)if(T.g[v]!=0)return!1;return!0}function b(T){return T.h==-1}n.l=function(T){return T=L(this,T),b(T)?-1:w(T)?0:1};function R(T){for(var v=T.g.length,I=[],C=0;C<v;C++)I[C]=~T.g[C];return new o(I,~T.h).add(p)}n.abs=function(){return b(this)?R(this):this},n.add=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0,D=0;D<=v;D++){var N=C+(this.i(D)&65535)+(T.i(D)&65535),E=(N>>>16)+(this.i(D)>>>16)+(T.i(D)>>>16);C=E>>>16,N&=65535,E&=65535,I[D]=E<<16|N}return new o(I,I[I.length-1]&-2147483648?-1:0)};function L(T,v){return T.add(R(v))}n.j=function(T){if(w(this)||w(T))return h;if(b(this))return b(T)?R(this).j(R(T)):R(R(this).j(T));if(b(T))return R(this.j(R(T)));if(0>this.l(_)&&0>T.l(_))return l(this.m()*T.m());for(var v=this.g.length+T.g.length,I=[],C=0;C<2*v;C++)I[C]=0;for(C=0;C<this.g.length;C++)for(var D=0;D<T.g.length;D++){var N=this.i(C)>>>16,E=this.i(C)&65535,ai=T.i(D)>>>16,Il=T.i(D)&65535;I[2*C+2*D]+=E*Il,H(I,2*C+2*D),I[2*C+2*D+1]+=N*Il,H(I,2*C+2*D+1),I[2*C+2*D+1]+=E*ai,H(I,2*C+2*D+1),I[2*C+2*D+2]+=N*ai,H(I,2*C+2*D+2)}for(C=0;C<v;C++)I[C]=I[2*C+1]<<16|I[2*C];for(C=v;C<2*v;C++)I[C]=0;return new o(I,0)};function H(T,v){for(;(T[v]&65535)!=T[v];)T[v+1]+=T[v]>>>16,T[v]&=65535,v++}function U(T,v){this.g=T,this.h=v}function Q(T,v){if(w(v))throw Error("division by zero");if(w(T))return new U(h,h);if(b(T))return v=Q(R(T),v),new U(R(v.g),R(v.h));if(b(v))return v=Q(T,R(v)),new U(R(v.g),v.h);if(30<T.g.length){if(b(T)||b(v))throw Error("slowDivide_ only works with positive integers.");for(var I=p,C=v;0>=C.l(T);)I=ie(I),C=ie(C);var D=J(I,1),N=J(C,1);for(C=J(C,2),I=J(I,2);!w(C);){var E=N.add(C);0>=E.l(T)&&(D=D.add(I),N=E),C=J(C,1),I=J(I,1)}return v=L(T,D.j(v)),new U(D,v)}for(D=h;0<=T.l(v);){for(I=Math.max(1,Math.floor(T.m()/v.m())),C=Math.ceil(Math.log(I)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),N=l(I),E=N.j(v);b(E)||0<E.l(T);)I-=C,N=l(I),E=N.j(v);w(N)&&(N=p),D=D.add(N),T=L(T,E)}return new U(D,T)}n.A=function(T){return Q(this,T).h},n.and=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0;C<v;C++)I[C]=this.i(C)&T.i(C);return new o(I,this.h&T.h)},n.or=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0;C<v;C++)I[C]=this.i(C)|T.i(C);return new o(I,this.h|T.h)},n.xor=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0;C<v;C++)I[C]=this.i(C)^T.i(C);return new o(I,this.h^T.h)};function ie(T){for(var v=T.g.length+1,I=[],C=0;C<v;C++)I[C]=T.i(C)<<1|T.i(C-1)>>>31;return new o(I,T.h)}function J(T,v){var I=v>>5;v%=32;for(var C=T.g.length-I,D=[],N=0;N<C;N++)D[N]=0<v?T.i(N+I)>>>v|T.i(N+I+1)<<32-v:T.i(N+I);return new o(D,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,AT=fO.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,ls=fO.Integer=o}).apply(typeof hO<"u"?hO:typeof self<"u"?self:typeof window<"u"?window:{});var xm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},bi={};var RT,xT,lc,NT,fd,Nm,PT,MT,kT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,m){return u==Array.prototype||u==Object.prototype||(u[f]=m.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof xm=="object"&&xm];for(var f=0;f<u.length;++f){var m=u[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=t(this);function i(u,f){if(f)e:{var m=r;u=u.split(".");for(var y=0;y<u.length-1;y++){var A=u[y];if(!(A in m))break e;m=m[A]}u=u[u.length-1],y=m[u],f=f(y),f!=y&&f!=null&&e(m,u,{configurable:!0,writable:!0,value:f})}}function s(u,f){u instanceof String&&(u+="");var m=0,y=!1,A={next:function(){if(!y&&m<u.length){var k=m++;return{value:f(k,u[k]),done:!1}}return y=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(u){return u||function(){return s(this,function(f,m){return m})}});var o=o||{},a=this||self;function c(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function l(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function d(u,f,m){return u.call.apply(u.bind,arguments)}function h(u,f,m){if(!u)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,y),u.apply(f,A)}}return function(){return u.apply(f,arguments)}}function p(u,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function _(u,f){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),u.apply(this,y)}}function w(u,f){function m(){}m.prototype=f.prototype,u.aa=f.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(y,A,k){for(var $=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)$[Ve-2]=arguments[Ve];return f.prototype[A].apply(y,$)}}function b(u){let f=u.length;if(0<f){let m=Array(f);for(let y=0;y<f;y++)m[y]=u[y];return m}return[]}function R(u,f){for(let m=1;m<arguments.length;m++){let y=arguments[m];if(c(y)){let A=u.length||0,k=y.length||0;u.length=A+k;for(let $=0;$<k;$++)u[A+$]=y[$]}else u.push(y)}}class L{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function H(u){return/^[\s\xa0]*$/.test(u)}function U(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function Q(u){return Q[" "](u),u}Q[" "]=function(){};var ie=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function J(u,f,m){for(let y in u)f.call(m,u[y],y,u)}function T(u,f){for(let m in u)f.call(void 0,u[m],m,u)}function v(u){let f={};for(let m in u)f[m]=u[m];return f}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,f){let m,y;for(let A=1;A<arguments.length;A++){y=arguments[A];for(m in y)u[m]=y[m];for(let k=0;k<I.length;k++)m=I[k],Object.prototype.hasOwnProperty.call(y,m)&&(u[m]=y[m])}}function D(u){var f=1;u=u.split(":");let m=[];for(;0<f&&u.length;)m.push(u.shift()),f--;return u.length&&m.push(u.join(":")),m}function N(u){a.setTimeout(()=>{throw u},0)}function E(){var u=Z_;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class ai{constructor(){this.h=this.g=null}add(f,m){let y=Il.get();y.set(f,m),this.h?this.h.next=y:this.g=y,this.h=y}}var Il=new L(()=>new QU,u=>u.reset());class QU{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let El,Tl=!1,Z_=new ai,$S=()=>{let u=a.Promise.resolve(void 0);El=()=>{u.then(YU)}};var YU=()=>{for(var u;u=E();){try{u.h.call(u.g)}catch(m){N(m)}var f=Il;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}Tl=!1};function Li(){this.s=this.s,this.C=this.C}Li.prototype.s=!1,Li.prototype.ma=function(){this.s||(this.s=!0,this.N())},Li.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $t(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}$t.prototype.h=function(){this.defaultPrevented=!0};var JU=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let m=()=>{};a.addEventListener("test",m,f),a.removeEventListener("test",m,f)}catch{}return u}();function bl(u,f){if($t.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,y=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(ie){e:{try{Q(f.nodeName);var A=!0;break e}catch{}A=!1}A||(f=null)}}else m=="mouseover"?f=u.fromElement:m=="mouseout"&&(f=u.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:XU[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&bl.aa.h.call(this)}}w(bl,$t);var XU={2:"touch",3:"pen",4:"mouse"};bl.prototype.h=function(){bl.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Cl="closure_listenable_"+(1e6*Math.random()|0),ZU=0;function ej(u,f,m,y,A){this.listener=u,this.proxy=null,this.src=f,this.type=m,this.capture=!!y,this.ha=A,this.key=++ZU,this.da=this.fa=!1}function Uh(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function jh(u){this.src=u,this.g={},this.h=0}jh.prototype.add=function(u,f,m,y,A){var k=u.toString();u=this.g[k],u||(u=this.g[k]=[],this.h++);var $=ty(u,f,y,A);return-1<$?(f=u[$],m||(f.fa=!1)):(f=new ej(f,this.src,k,!!y,A),f.fa=m,u.push(f)),f};function ey(u,f){var m=f.type;if(m in u.g){var y=u.g[m],A=Array.prototype.indexOf.call(y,f,void 0),k;(k=0<=A)&&Array.prototype.splice.call(y,A,1),k&&(Uh(f),u.g[m].length==0&&(delete u.g[m],u.h--))}}function ty(u,f,m,y){for(var A=0;A<u.length;++A){var k=u[A];if(!k.da&&k.listener==f&&k.capture==!!m&&k.ha==y)return A}return-1}var ny="closure_lm_"+(1e6*Math.random()|0),ry={};function HS(u,f,m,y,A){if(y&&y.once)return zS(u,f,m,y,A);if(Array.isArray(f)){for(var k=0;k<f.length;k++)HS(u,f[k],m,y,A);return null}return m=ay(m),u&&u[Cl]?u.K(f,m,l(y)?!!y.capture:!!y,A):qS(u,f,m,!1,y,A)}function qS(u,f,m,y,A,k){if(!f)throw Error("Invalid event type");var $=l(A)?!!A.capture:!!A,Ve=sy(u);if(Ve||(u[ny]=Ve=new jh(u)),m=Ve.add(f,m,y,$,k),m.proxy)return m;if(y=tj(),m.proxy=y,y.src=u,y.listener=m,u.addEventListener)JU||(A=$),A===void 0&&(A=!1),u.addEventListener(f.toString(),y,A);else if(u.attachEvent)u.attachEvent(GS(f.toString()),y);else if(u.addListener&&u.removeListener)u.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function tj(){function u(m){return f.call(u.src,u.listener,m)}let f=nj;return u}function zS(u,f,m,y,A){if(Array.isArray(f)){for(var k=0;k<f.length;k++)zS(u,f[k],m,y,A);return null}return m=ay(m),u&&u[Cl]?u.L(f,m,l(y)?!!y.capture:!!y,A):qS(u,f,m,!0,y,A)}function WS(u,f,m,y,A){if(Array.isArray(f))for(var k=0;k<f.length;k++)WS(u,f[k],m,y,A);else y=l(y)?!!y.capture:!!y,m=ay(m),u&&u[Cl]?(u=u.i,f=String(f).toString(),f in u.g&&(k=u.g[f],m=ty(k,m,y,A),-1<m&&(Uh(k[m]),Array.prototype.splice.call(k,m,1),k.length==0&&(delete u.g[f],u.h--)))):u&&(u=sy(u))&&(f=u.g[f.toString()],u=-1,f&&(u=ty(f,m,y,A)),(m=-1<u?f[u]:null)&&iy(m))}function iy(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[Cl])ey(f.i,u);else{var m=u.type,y=u.proxy;f.removeEventListener?f.removeEventListener(m,y,u.capture):f.detachEvent?f.detachEvent(GS(m),y):f.addListener&&f.removeListener&&f.removeListener(y),(m=sy(f))?(ey(m,u),m.h==0&&(m.src=null,f[ny]=null)):Uh(u)}}}function GS(u){return u in ry?ry[u]:ry[u]="on"+u}function nj(u,f){if(u.da)u=!0;else{f=new bl(f,this);var m=u.listener,y=u.ha||u.src;u.fa&&iy(u),u=m.call(y,f)}return u}function sy(u){return u=u[ny],u instanceof jh?u:null}var oy="__closure_events_fn_"+(1e9*Math.random()>>>0);function ay(u){return typeof u=="function"?u:(u[oy]||(u[oy]=function(f){return u.handleEvent(f)}),u[oy])}function Ht(){Li.call(this),this.i=new jh(this),this.M=this,this.F=null}w(Ht,Li),Ht.prototype[Cl]=!0,Ht.prototype.removeEventListener=function(u,f,m,y){WS(this,u,f,m,y)};function tn(u,f){var m,y=u.F;if(y)for(m=[];y;y=y.F)m.push(y);if(u=u.M,y=f.type||f,typeof f=="string")f=new $t(f,u);else if(f instanceof $t)f.target=f.target||u;else{var A=f;f=new $t(y,u),C(f,A)}if(A=!0,m)for(var k=m.length-1;0<=k;k--){var $=f.g=m[k];A=Bh($,y,!0,f)&&A}if($=f.g=u,A=Bh($,y,!0,f)&&A,A=Bh($,y,!1,f)&&A,m)for(k=0;k<m.length;k++)$=f.g=m[k],A=Bh($,y,!1,f)&&A}Ht.prototype.N=function(){if(Ht.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var m=u.g[f],y=0;y<m.length;y++)Uh(m[y]);delete u.g[f],u.h--}}this.F=null},Ht.prototype.K=function(u,f,m,y){return this.i.add(String(u),f,!1,m,y)},Ht.prototype.L=function(u,f,m,y){return this.i.add(String(u),f,!0,m,y)};function Bh(u,f,m,y){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var A=!0,k=0;k<f.length;++k){var $=f[k];if($&&!$.da&&$.capture==m){var Ve=$.listener,Lt=$.ha||$.src;$.fa&&ey(u.i,$),A=Ve.call(Lt,y)!==!1&&A}}return A&&!y.defaultPrevented}function KS(u,f,m){if(typeof u=="function")m&&(u=p(u,m));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function QS(u){u.g=KS(()=>{u.g=null,u.i&&(u.i=!1,QS(u))},u.l);let f=u.h;u.h=null,u.m.apply(null,f)}class rj extends Li{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:QS(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Dl(u){Li.call(this),this.h=u,this.g={}}w(Dl,Li);var YS=[];function JS(u){J(u.g,function(f,m){this.g.hasOwnProperty(m)&&iy(f)},u),u.g={}}Dl.prototype.N=function(){Dl.aa.N.call(this),JS(this)},Dl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cy=a.JSON.stringify,ij=a.JSON.parse,sj=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function ly(){}ly.prototype.h=null;function XS(u){return u.h||(u.h=u.i())}function ZS(){}var Sl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function uy(){$t.call(this,"d")}w(uy,$t);function dy(){$t.call(this,"c")}w(dy,$t);var Us={},eA=null;function $h(){return eA=eA||new Ht}Us.La="serverreachability";function tA(u){$t.call(this,Us.La,u)}w(tA,$t);function Al(u){let f=$h();tn(f,new tA(f))}Us.STAT_EVENT="statevent";function nA(u,f){$t.call(this,Us.STAT_EVENT,u),this.stat=f}w(nA,$t);function nn(u){let f=$h();tn(f,new nA(f,u))}Us.Ma="timingevent";function rA(u,f){$t.call(this,Us.Ma,u),this.size=f}w(rA,$t);function Rl(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function xl(){this.g=!0}xl.prototype.xa=function(){this.g=!1};function oj(u,f,m,y,A,k){u.info(function(){if(u.g)if(k)for(var $="",Ve=k.split("&"),Lt=0;Lt<Ve.length;Lt++){var Ae=Ve[Lt].split("=");if(1<Ae.length){var qt=Ae[0];Ae=Ae[1];var zt=qt.split("_");$=2<=zt.length&&zt[1]=="type"?$+(qt+"="+Ae+"&"):$+(qt+"=redacted&")}}else $=null;else $=k;return"XMLHTTP REQ ("+y+") [attempt "+A+"]: "+f+`
`+m+`
`+$})}function aj(u,f,m,y,A,k,$){u.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+A+"]: "+f+`
`+m+`
`+k+" "+$})}function sa(u,f,m,y){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+lj(u,m)+(y?" "+y:"")})}function cj(u,f){u.info(function(){return"TIMEOUT: "+f})}xl.prototype.info=function(){};function lj(u,f){if(!u.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var y=m[u];if(!(2>y.length)){var A=y[1];if(Array.isArray(A)&&!(1>A.length)){var k=A[0];if(k!="noop"&&k!="stop"&&k!="close")for(var $=1;$<A.length;$++)A[$]=""}}}}return cy(m)}catch{return f}}var Hh={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},iA={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},hy;function qh(){}w(qh,ly),qh.prototype.g=function(){return new XMLHttpRequest},qh.prototype.i=function(){return{}},hy=new qh;function Fi(u,f,m,y){this.j=u,this.i=f,this.l=m,this.R=y||1,this.U=new Dl(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new sA}function sA(){this.i=null,this.g="",this.h=!1}var oA={},fy={};function py(u,f,m){u.L=1,u.v=Kh(ci(f)),u.m=m,u.P=!0,aA(u,null)}function aA(u,f){u.F=Date.now(),zh(u),u.A=ci(u.v);var m=u.A,y=u.R;Array.isArray(y)||(y=[String(y)]),IA(m.i,"t",y),u.C=0,m=u.j.J,u.h=new sA,u.g=UA(u.j,m?f:null,!u.m),0<u.O&&(u.M=new rj(p(u.Y,u,u.g),u.O)),f=u.U,m=u.g,y=u.ca;var A="readystatechange";Array.isArray(A)||(A&&(YS[0]=A.toString()),A=YS);for(var k=0;k<A.length;k++){var $=HS(m,A[k],y||f.handleEvent,!1,f.h||f);if(!$)break;f.g[$.key]=$}f=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),Al(),oj(u.i,u.u,u.A,u.l,u.R,u.m)}Fi.prototype.ca=function(u){u=u.target;let f=this.M;f&&li(u)==3?f.j():this.Y(u)},Fi.prototype.Y=function(u){try{if(u==this.g)e:{let zt=li(this.g);var f=this.g.Ba();let ca=this.g.Z();if(!(3>zt)&&(zt!=3||this.g&&(this.h.h||this.g.oa()||AA(this.g)))){this.J||zt!=4||f==7||(f==8||0>=ca?Al(3):Al(2)),my(this);var m=this.g.Z();this.X=m;t:if(cA(this)){var y=AA(this.g);u="";var A=y.length,k=li(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){js(this),Nl(this);var $="";break t}this.h.i=new a.TextDecoder}for(f=0;f<A;f++)this.h.h=!0,u+=this.h.i.decode(y[f],{stream:!(k&&f==A-1)});y.length=0,this.h.g+=u,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=m==200,aj(this.i,this.u,this.A,this.l,this.R,zt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Ve,Lt=this.g;if((Ve=Lt.g?Lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Ve)){var Ae=Ve;break t}}Ae=null}if(m=Ae)sa(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gy(this,m);else{this.o=!1,this.s=3,nn(12),js(this),Nl(this);break e}}if(this.P){m=!0;let tr;for(;!this.J&&this.C<$.length;)if(tr=uj(this,$),tr==fy){zt==4&&(this.s=4,nn(14),m=!1),sa(this.i,this.l,null,"[Incomplete Response]");break}else if(tr==oA){this.s=4,nn(15),sa(this.i,this.l,$,"[Invalid Chunk]"),m=!1;break}else sa(this.i,this.l,tr,null),gy(this,tr);if(cA(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),zt!=4||$.length!=0||this.h.h||(this.s=1,nn(16),m=!1),this.o=this.o&&m,!m)sa(this.i,this.l,$,"[Invalid Chunked Response]"),js(this),Nl(this);else if(0<$.length&&!this.W){this.W=!0;var qt=this.j;qt.g==this&&qt.ba&&!qt.M&&(qt.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),Ey(qt),qt.M=!0,nn(11))}}else sa(this.i,this.l,$,null),gy(this,$);zt==4&&js(this),this.o&&!this.J&&(zt==4?OA(this.j,this):(this.o=!1,zh(this)))}else Sj(this.g),m==400&&0<$.indexOf("Unknown SID")?(this.s=3,nn(12)):(this.s=0,nn(13)),js(this),Nl(this)}}}catch{}finally{}};function cA(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function uj(u,f){var m=u.C,y=f.indexOf(`
`,m);return y==-1?fy:(m=Number(f.substring(m,y)),isNaN(m)?oA:(y+=1,y+m>f.length?fy:(f=f.slice(y,y+m),u.C=y+m,f)))}Fi.prototype.cancel=function(){this.J=!0,js(this)};function zh(u){u.S=Date.now()+u.I,lA(u,u.I)}function lA(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Rl(p(u.ba,u),f)}function my(u){u.B&&(a.clearTimeout(u.B),u.B=null)}Fi.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(cj(this.i,this.A),this.L!=2&&(Al(),nn(17)),js(this),this.s=2,Nl(this)):lA(this,this.S-u)};function Nl(u){u.j.G==0||u.J||OA(u.j,u)}function js(u){my(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,JS(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function gy(u,f){try{var m=u.j;if(m.G!=0&&(m.g==u||_y(m.h,u))){if(!u.K&&_y(m.h,u)&&m.G==3){try{var y=m.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var A=y;if(A[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)Zh(m),Jh(m);else break e;Iy(m),nn(18)}}else m.za=A[1],0<m.za-m.T&&37500>A[2]&&m.F&&m.v==0&&!m.C&&(m.C=Rl(p(m.Za,m),6e3));if(1>=hA(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else $s(m,11)}else if((u.K||m.g==u)&&Zh(m),!H(f))for(A=m.Da.g.parse(f),f=0;f<A.length;f++){let Ae=A[f];if(m.T=Ae[0],Ae=Ae[1],m.G==2)if(Ae[0]=="c"){m.K=Ae[1],m.ia=Ae[2];let qt=Ae[3];qt!=null&&(m.la=qt,m.j.info("VER="+m.la));let zt=Ae[4];zt!=null&&(m.Aa=zt,m.j.info("SVER="+m.Aa));let ca=Ae[5];ca!=null&&typeof ca=="number"&&0<ca&&(y=1.5*ca,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;let tr=u.g;if(tr){let tf=tr.g?tr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(tf){var k=y.h;k.g||tf.indexOf("spdy")==-1&&tf.indexOf("quic")==-1&&tf.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(yy(k,k.h),k.h=null))}if(y.D){let Ty=tr.g?tr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ty&&(y.ya=Ty,We(y.I,y.D,Ty))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var $=u;if(y.qa=VA(y,y.J?y.ia:null,y.W),$.K){fA(y.h,$);var Ve=$,Lt=y.L;Lt&&(Ve.I=Lt),Ve.B&&(my(Ve),zh(Ve)),y.g=$}else MA(y);0<m.i.length&&Xh(m)}else Ae[0]!="stop"&&Ae[0]!="close"||$s(m,7);else m.G==3&&(Ae[0]=="stop"||Ae[0]=="close"?Ae[0]=="stop"?$s(m,7):wy(m):Ae[0]!="noop"&&m.l&&m.l.ta(Ae),m.v=0)}}Al(4)}catch{}}var dj=class{constructor(u,f){this.g=u,this.map=f}};function uA(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function dA(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function hA(u){return u.h?1:u.g?u.g.size:0}function _y(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function yy(u,f){u.g?u.g.add(f):u.h=f}function fA(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}uA.prototype.cancel=function(){if(this.i=pA(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function pA(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(let m of u.g.values())f=f.concat(m.D);return f}return b(u.i)}function hj(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var f=[],m=u.length,y=0;y<m;y++)f.push(u[y]);return f}f=[],m=0;for(y in u)f[m++]=u[y];return f}function fj(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var f=[];u=u.length;for(var m=0;m<u;m++)f.push(m);return f}f=[],m=0;for(let y in u)f[m++]=y;return f}}}function mA(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var m=fj(u),y=hj(u),A=y.length,k=0;k<A;k++)f.call(void 0,y[k],m&&m[k],u)}var gA=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pj(u,f){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var y=u[m].indexOf("="),A=null;if(0<=y){var k=u[m].substring(0,y);A=u[m].substring(y+1)}else k=u[m];f(k,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function Bs(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Bs){this.h=u.h,Wh(this,u.j),this.o=u.o,this.g=u.g,Gh(this,u.s),this.l=u.l;var f=u.i,m=new kl;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),_A(this,m),this.m=u.m}else u&&(f=String(u).match(gA))?(this.h=!1,Wh(this,f[1]||"",!0),this.o=Pl(f[2]||""),this.g=Pl(f[3]||"",!0),Gh(this,f[4]),this.l=Pl(f[5]||"",!0),_A(this,f[6]||"",!0),this.m=Pl(f[7]||"")):(this.h=!1,this.i=new kl(null,this.h))}Bs.prototype.toString=function(){var u=[],f=this.j;f&&u.push(Ml(f,yA,!0),":");var m=this.g;return(m||f=="file")&&(u.push("//"),(f=this.o)&&u.push(Ml(f,yA,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(Ml(m,m.charAt(0)=="/"?_j:gj,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",Ml(m,vj)),u.join("")};function ci(u){return new Bs(u)}function Wh(u,f,m){u.j=m?Pl(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function Gh(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function _A(u,f,m){f instanceof kl?(u.i=f,wj(u.i,u.h)):(m||(f=Ml(f,yj)),u.i=new kl(f,u.h))}function We(u,f,m){u.i.set(f,m)}function Kh(u){return We(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Pl(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Ml(u,f,m){return typeof u=="string"?(u=encodeURI(u).replace(f,mj),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function mj(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var yA=/[#\/\?@]/g,gj=/[#\?:]/g,_j=/[#\?]/g,yj=/[#\?@]/g,vj=/#/g;function kl(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function Vi(u){u.g||(u.g=new Map,u.h=0,u.i&&pj(u.i,function(f,m){u.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=kl.prototype,n.add=function(u,f){Vi(this),this.i=null,u=oa(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(f),this.h+=1,this};function vA(u,f){Vi(u),f=oa(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function wA(u,f){return Vi(u),f=oa(u,f),u.g.has(f)}n.forEach=function(u,f){Vi(this),this.g.forEach(function(m,y){m.forEach(function(A){u.call(f,A,y,this)},this)},this)},n.na=function(){Vi(this);let u=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let y=0;y<f.length;y++){let A=u[y];for(let k=0;k<A.length;k++)m.push(f[y])}return m},n.V=function(u){Vi(this);let f=[];if(typeof u=="string")wA(this,u)&&(f=f.concat(this.g.get(oa(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)f=f.concat(u[m])}return f},n.set=function(u,f){return Vi(this),this.i=null,u=oa(this,u),wA(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function IA(u,f,m){vA(u,f),0<m.length&&(u.i=null,u.g.set(oa(u,f),b(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var y=f[m];let k=encodeURIComponent(String(y)),$=this.V(y);for(y=0;y<$.length;y++){var A=k;$[y]!==""&&(A+="="+encodeURIComponent(String($[y]))),u.push(A)}}return this.i=u.join("&")};function oa(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function wj(u,f){f&&!u.j&&(Vi(u),u.i=null,u.g.forEach(function(m,y){var A=y.toLowerCase();y!=A&&(vA(this,y),IA(this,A,m))},u)),u.j=f}function Ij(u,f){let m=new xl;if(a.Image){let y=new Image;y.onload=_(Ui,m,"TestLoadImage: loaded",!0,f,y),y.onerror=_(Ui,m,"TestLoadImage: error",!1,f,y),y.onabort=_(Ui,m,"TestLoadImage: abort",!1,f,y),y.ontimeout=_(Ui,m,"TestLoadImage: timeout",!1,f,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=u}else f(!1)}function Ej(u,f){let m=new xl,y=new AbortController,A=setTimeout(()=>{y.abort(),Ui(m,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:y.signal}).then(k=>{clearTimeout(A),k.ok?Ui(m,"TestPingServer: ok",!0,f):Ui(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(A),Ui(m,"TestPingServer: error",!1,f)})}function Ui(u,f,m,y,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),y(m)}catch{}}function Tj(){this.g=new sj}function bj(u,f,m){let y=m||"";try{mA(u,function(A,k){let $=A;l(A)&&($=cy(A)),f.push(y+k+"="+encodeURIComponent($))})}catch(A){throw f.push(y+"type="+encodeURIComponent("_badmap")),A}}function Ol(u){this.l=u.Ub||null,this.j=u.eb||!1}w(Ol,ly),Ol.prototype.g=function(){return new Qh(this.l,this.j)},Ol.prototype.i=function(u){return function(){return u}}({});function Qh(u,f){Ht.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Qh,Ht),n=Qh.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,Fl(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ll(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Fl(this)),this.g&&(this.readyState=3,Fl(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;EA(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function EA(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?Ll(this):Fl(this),this.readyState==3&&EA(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Ll(this))},n.Qa=function(u){this.g&&(this.response=u,Ll(this))},n.ga=function(){this.g&&Ll(this)};function Ll(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Fl(u)}n.setRequestHeader=function(u,f){this.u.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=f.next();return u.join(`\r
`)};function Fl(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Qh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function TA(u){let f="";return J(u,function(m,y){f+=y,f+=":",f+=m,f+=`\r
`}),f}function vy(u,f,m){e:{for(y in m){var y=!1;break e}y=!0}y||(m=TA(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):We(u,f,m))}function rt(u){Ht.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(rt,Ht);var Cj=/^https?$/i,Dj=["POST","PUT"];n=rt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,f,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():hy.g(),this.v=this.o?XS(this.o):XS(hy),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(k){bA(this,k);return}if(u=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var A in y)m.set(A,y[A]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let k of y.keys())m.set(k,y.get(k));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(k=>k.toLowerCase()=="content-type"),A=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Dj,f,void 0))||y||A||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[k,$]of m)this.g.setRequestHeader(k,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{SA(this),this.u=!0,this.g.send(u),this.u=!1}catch(k){bA(this,k)}};function bA(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,CA(u),Yh(u)}function CA(u){u.A||(u.A=!0,tn(u,"complete"),tn(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,tn(this,"complete"),tn(this,"abort"),Yh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yh(this,!0)),rt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?DA(this):this.bb())},n.bb=function(){DA(this)};function DA(u){if(u.h&&typeof o<"u"&&(!u.v[1]||li(u)!=4||u.Z()!=2)){if(u.u&&li(u)==4)KS(u.Ea,0,u);else if(tn(u,"readystatechange"),li(u)==4){u.h=!1;try{let $=u.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var y;if(y=$===0){var A=String(u.D).match(gA)[1]||null;!A&&a.self&&a.self.location&&(A=a.self.location.protocol.slice(0,-1)),y=!Cj.test(A?A.toLowerCase():"")}m=y}if(m)tn(u,"complete"),tn(u,"success");else{u.m=6;try{var k=2<li(u)?u.g.statusText:""}catch{k=""}u.l=k+" ["+u.Z()+"]",CA(u)}}finally{Yh(u)}}}}function Yh(u,f){if(u.g){SA(u);let m=u.g,y=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||tn(u,"ready");try{m.onreadystatechange=y}catch{}}}function SA(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function li(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<li(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),ij(f)}};function AA(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Sj(u){let f={};u=(u.g&&2<=li(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<u.length;y++){if(H(u[y]))continue;var m=D(u[y]);let A=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let k=f[A]||[];f[A]=k,k.push(m)}T(f,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vl(u,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||f}function RA(u){this.Aa=0,this.i=[],this.j=new xl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Vl("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Vl("baseRetryDelayMs",5e3,u),this.cb=Vl("retryDelaySeedMs",1e4,u),this.Wa=Vl("forwardChannelMaxRetries",2,u),this.wa=Vl("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new uA(u&&u.concurrentRequestLimit),this.Da=new Tj,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=RA.prototype,n.la=8,n.G=1,n.connect=function(u,f,m,y){nn(0),this.W=u,this.H=f||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=VA(this,null,this.W),Xh(this)};function wy(u){if(xA(u),u.G==3){var f=u.U++,m=ci(u.I);if(We(m,"SID",u.K),We(m,"RID",f),We(m,"TYPE","terminate"),Ul(u,m),f=new Fi(u,u.j,f),f.L=2,f.v=Kh(ci(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=f.v,m=!0),m||(f.g=UA(f.j,null),f.g.ea(f.v)),f.F=Date.now(),zh(f)}FA(u)}function Jh(u){u.g&&(Ey(u),u.g.cancel(),u.g=null)}function xA(u){Jh(u),u.u&&(a.clearTimeout(u.u),u.u=null),Zh(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Xh(u){if(!dA(u.h)&&!u.s){u.s=!0;var f=u.Ga;El||$S(),Tl||(El(),Tl=!0),Z_.add(f,u),u.B=0}}function Aj(u,f){return hA(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Rl(p(u.Ga,u,f),LA(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let A=new Fi(this,this.j,u),k=this.o;if(this.S&&(k?(k=v(k),C(k,this.S)):k=this.S),this.m!==null||this.O||(A.H=k,k=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=PA(this,A,f),m=ci(this.I),We(m,"RID",u),We(m,"CVER",22),this.D&&We(m,"X-HTTP-Session-Id",this.D),Ul(this,m),k&&(this.O?f="headers="+encodeURIComponent(String(TA(k)))+"&"+f:this.m&&vy(m,this.m,k)),yy(this.h,A),this.Ua&&We(m,"TYPE","init"),this.P?(We(m,"$req",f),We(m,"SID","null"),A.T=!0,py(A,m,null)):py(A,m,f),this.G=2}}else this.G==3&&(u?NA(this,u):this.i.length==0||dA(this.h)||NA(this))};function NA(u,f){var m;f?m=f.l:m=u.U++;let y=ci(u.I);We(y,"SID",u.K),We(y,"RID",m),We(y,"AID",u.T),Ul(u,y),u.m&&u.o&&vy(y,u.m,u.o),m=new Fi(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),f&&(u.i=f.D.concat(u.i)),f=PA(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),yy(u.h,m),py(m,y,f)}function Ul(u,f){u.H&&J(u.H,function(m,y){We(f,y,m)}),u.l&&mA({},function(m,y){We(f,y,m)})}function PA(u,f,m){m=Math.min(u.i.length,m);var y=u.l?p(u.l.Na,u.l,u):null;e:{var A=u.i;let k=-1;for(;;){let $=["count="+m];k==-1?0<m?(k=A[0].g,$.push("ofs="+k)):k=0:$.push("ofs="+k);let Ve=!0;for(let Lt=0;Lt<m;Lt++){let Ae=A[Lt].g,qt=A[Lt].map;if(Ae-=k,0>Ae)k=Math.max(0,A[Lt].g-100),Ve=!1;else try{bj(qt,$,"req"+Ae+"_")}catch{y&&y(qt)}}if(Ve){y=$.join("&");break e}}}return u=u.i.splice(0,m),f.D=u,y}function MA(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;El||$S(),Tl||(El(),Tl=!0),Z_.add(f,u),u.v=0}}function Iy(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Rl(p(u.Fa,u),LA(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,kA(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Rl(p(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,nn(10),Jh(this),kA(this))};function Ey(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function kA(u){u.g=new Fi(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=ci(u.qa);We(f,"RID","rpc"),We(f,"SID",u.K),We(f,"AID",u.T),We(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&We(f,"TO",u.ja),We(f,"TYPE","xmlhttp"),Ul(u,f),u.m&&u.o&&vy(f,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=Kh(ci(f)),m.m=null,m.P=!0,aA(m,u)}n.Za=function(){this.C!=null&&(this.C=null,Jh(this),Iy(this),nn(19))};function Zh(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function OA(u,f){var m=null;if(u.g==f){Zh(u),Ey(u),u.g=null;var y=2}else if(_y(u.h,f))m=f.D,fA(u.h,f),y=1;else return;if(u.G!=0){if(f.o)if(y==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var A=u.B;y=$h(),tn(y,new rA(y,m)),Xh(u)}else MA(u);else if(A=f.s,A==3||A==0&&0<f.X||!(y==1&&Aj(u,f)||y==2&&Iy(u)))switch(m&&0<m.length&&(f=u.h,f.i=f.i.concat(m)),A){case 1:$s(u,5);break;case 4:$s(u,10);break;case 3:$s(u,6);break;default:$s(u,2)}}}function LA(u,f){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*f}function $s(u,f){if(u.j.info("Error code "+f),f==2){var m=p(u.fb,u),y=u.Xa;let A=!y;y=new Bs(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Wh(y,"https"),Kh(y),A?Ij(y.toString(),m):Ej(y.toString(),m)}else nn(2);u.G=0,u.l&&u.l.sa(f),FA(u),xA(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),nn(2)):(this.j.info("Failed to ping google.com"),nn(1))};function FA(u){if(u.G=0,u.ka=[],u.l){let f=pA(u.h);(f.length!=0||u.i.length!=0)&&(R(u.ka,f),R(u.ka,u.i),u.h.i.length=0,b(u.i),u.i.length=0),u.l.ra()}}function VA(u,f,m){var y=m instanceof Bs?ci(m):new Bs(m);if(y.g!="")f&&(y.g=f+"."+y.g),Gh(y,y.s);else{var A=a.location;y=A.protocol,f=f?f+"."+A.hostname:A.hostname,A=+A.port;var k=new Bs(null);y&&Wh(k,y),f&&(k.g=f),A&&Gh(k,A),m&&(k.l=m),y=k}return m=u.D,f=u.ya,m&&f&&We(y,m,f),We(y,"VER",u.la),Ul(u,y),y}function UA(u,f,m){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new rt(new Ol({eb:m})):new rt(u.pa),f.Ha(u.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function jA(){}n=jA.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ef(){}ef.prototype.g=function(u,f){return new Tn(u,f)};function Tn(u,f){Ht.call(this),this.g=new RA(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!H(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!H(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new aa(this)}w(Tn,Ht),Tn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Tn.prototype.close=function(){wy(this.g)},Tn.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=cy(u),u=m);f.i.push(new dj(f.Ya++,u)),f.G==3&&Xh(f)},Tn.prototype.N=function(){this.g.l=null,delete this.j,wy(this.g),delete this.g,Tn.aa.N.call(this)};function BA(u){uy.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(let m in f){u=m;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}w(BA,uy);function $A(){dy.call(this),this.status=1}w($A,dy);function aa(u){this.g=u}w(aa,jA),aa.prototype.ua=function(){tn(this.g,"a")},aa.prototype.ta=function(u){tn(this.g,new BA(u))},aa.prototype.sa=function(u){tn(this.g,new $A)},aa.prototype.ra=function(){tn(this.g,"b")},ef.prototype.createWebChannel=ef.prototype.g,Tn.prototype.send=Tn.prototype.o,Tn.prototype.open=Tn.prototype.m,Tn.prototype.close=Tn.prototype.close,kT=bi.createWebChannelTransport=function(){return new ef},MT=bi.getStatEventTarget=function(){return $h()},PT=bi.Event=Us,Nm=bi.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Hh.NO_ERROR=0,Hh.TIMEOUT=8,Hh.HTTP_ERROR=6,fd=bi.ErrorCode=Hh,iA.COMPLETE="complete",NT=bi.EventType=iA,ZS.EventType=Sl,Sl.OPEN="a",Sl.CLOSE="b",Sl.ERROR="c",Sl.MESSAGE="d",Ht.prototype.listen=Ht.prototype.K,lc=bi.WebChannel=ZS,xT=bi.FetchXmlHttpFactory=Ol,rt.prototype.listenOnce=rt.prototype.L,rt.prototype.getLastError=rt.prototype.Ka,rt.prototype.getLastErrorCode=rt.prototype.Ba,rt.prototype.getStatus=rt.prototype.Z,rt.prototype.getResponseJson=rt.prototype.Oa,rt.prototype.getResponseText=rt.prototype.oa,rt.prototype.send=rt.prototype.ea,rt.prototype.setWithCredentials=rt.prototype.Ha,RT=bi.XhrIo=rt}).apply(typeof xm<"u"?xm:typeof self<"u"?self:typeof window<"u"?window:{});var pO="@firebase/firestore";var Tt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Tt.UNAUTHENTICATED=new Tt(null),Tt.GOOGLE_CREDENTIALS=new Tt("google-credentials-uid"),Tt.FIRST_PARTY=new Tt("first-party-uid"),Tt.MOCK_USER=new Tt("mock-user");var jc="10.13.1";var gs=new wn("@firebase/firestore");function pc(){return gs.logLevel}function _1(n){gs.setLogLevel(n)}function V(n,...e){if(gs.logLevel<=me.DEBUG){let t=e.map(Ub);gs.debug(`Firestore (${jc}): ${n}`,...t)}}function ht(n,...e){if(gs.logLevel<=me.ERROR){let t=e.map(Ub);gs.error(`Firestore (${jc}): ${n}`,...t)}}function Qn(n,...e){if(gs.logLevel<=me.WARN){let t=e.map(Ub);gs.warn(`Firestore (${jc}): ${n}`,...t)}}function Ub(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function Y(n="Unexpected state"){let e=`FIRESTORE (${jc}) INTERNAL ASSERTION FAILED: `+n;throw ht(e),new Error(e)}function Z(n,e){n||Y()}function y1(n,e){n||Y()}function W(n,e){return n}var M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},F=class extends ot{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var bt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var $m=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},UT=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Tt.UNAUTHENTICATED))}shutdown(){}},jT=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},BT=class{constructor(e){this.t=e,this.currentUser=Tt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new bt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new bt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new bt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Z(typeof r.accessToken=="string"),new $m(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return Z(e===null||typeof e=="string"),new Tt(e)}},$T=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Tt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},HT=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new $T(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Tt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},qT=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},zT=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,V("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Z(typeof t.token=="string"),this.R=t.token,new qT(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function y5(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Hm=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=y5(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function ae(n,e){return n<e?-1:n>e?1:0}function Tc(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function v1(n){return n+"\0"}var et=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new F(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new F(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new F(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new F(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ae(this.nanoseconds,e.nanoseconds):ae(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var ee=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new et(0,0))}static max(){return new n(new et(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var qm=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&Y(),r===void 0?r=e.length-t:r>e.length-t&&Y(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},De=class n extends qm{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new F(M.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},v5=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ft=class n extends qm{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return v5.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new F(M.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new F(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new F(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new F(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var G=class n{constructor(e){this.path=e}static fromPath(e){return new n(De.fromString(e))}static fromName(e){return new n(De.fromString(e).popFirst(5))}static empty(){return new n(De.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&De.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return De.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new De(e.slice()))}};var bc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function WT(n){return n.fields.find(e=>e.kind===2)}function To(n){return n.fields.filter(e=>e.kind!==2)}bc.UNKNOWN_ID=-1;var wc=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Cd=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Yn.min())}};function w1(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ee.fromTimestamp(r===1e9?new et(t+1,0):new et(t,r));return new Yn(i,G.empty(),e)}function I1(n){return new Yn(n.readTime,n.key,-1)}var Yn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(ee.min(),G.empty(),-1)}static max(){return new n(ee.max(),G.empty(),-1)}};function jb(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=G.comparator(n.documentKey,e.documentKey),t!==0?t:ae(n.largestBatchId,e.largestBatchId))}var E1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",zm=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ds(n){return g(this,null,function*(){if(n.code!==M.FAILED_PRECONDITION||n.message!==E1)throw n;V("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var Wm=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new bt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ro(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=Bb(r.target.error);this.V.reject(new Ro(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new Ro(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(V("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new KT(t)}},_s=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(He())===12.2&&ht("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return V("SimpleDb","Removing database:",e),bo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Xi())return!1;if(n.v())return!0;let e=He(),t=n.S(e),r=0<t&&t<10,i=T1(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return g(this,null,function*(){return this.db||(V("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new Ro(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new F(M.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new F(M.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ro(e,o))},i.onupgradeneeded=s=>{V("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{V("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return g(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=Wm.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),P.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(V("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function T1(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var GT=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return bo(this.B.delete())}},Ro=class extends F{constructor(e,t){super(M.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Ss(n){return n.name==="IndexedDbTransactionError"}var KT=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(V("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(V("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),bo(r)}add(e){return V("SimpleDb","ADD",this.store.name,e,e),bo(this.store.add(e))}get(e){return bo(this.store.get(e)).next(t=>(t===void 0&&(t=null),V("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return V("SimpleDb","DELETE",this.store.name,e),bo(this.store.delete(e))}count(){return V("SimpleDb","COUNT",this.store.name),bo(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new P((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new P((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){V("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new P((r,i)=>{t.onerror=s=>{let o=Bb(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new P((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new GT(a),l=t(a.primaryKey,a.value,c);if(l instanceof P){let d=l.catch(h=>(c.done(),P.reject(h)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>P.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function bo(n){return new P((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=Bb(r.target.error);t(i)}})}var mO=!1;function Bb(n){let e=_s.S(He());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new F("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return mO||(mO=!0,setTimeout(()=>{throw r},0)),r}}return n}var QT=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){V("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{V("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){Ss(t)?V("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield Ds(t)}yield this.X(6e4)}))}},YT=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return P.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return V("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(V("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=I1(s);jb(o,r)>0&&(r=o)}),new Yn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Nn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Kd(n){return n==null}function Dd(n){return n===0&&1/n==-1/0}function b1(n){return typeof n=="number"&&Number.isInteger(n)&&!Dd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function ln(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=gO(e)),e=w5(n.get(t),e);return gO(e)}function w5(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function gO(n){return n+""}function qr(n){let e=n.length;if(Z(e>=2),e===2)return Z(n.charAt(0)===""&&n.charAt(1)===""),De.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&Y(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:Y()}s=o+2}return new De(r)}var _O=["userId","batchId"];function Lm(n,e){return[n,ln(e)]}function C1(n,e,t){return[n,ln(e),t]}var I5={},E5=["prefixPath","collectionGroup","readTime","documentId"],T5=["prefixPath","collectionGroup","documentId"],b5=["collectionGroup","readTime","prefixPath","documentId"],C5=["canonicalId","targetId"],D5=["targetId","path"],S5=["path","targetId"],A5=["collectionId","parent"],R5=["indexId","uid"],x5=["uid","sequenceNumber"],N5=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],P5=["indexId","uid","orderedDocumentKey"],M5=["userId","collectionPath","documentId"],k5=["userId","collectionPath","largestBatchId"],O5=["userId","collectionGroup","largestBatchId"],D1=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],L5=[...D1,"documentOverlays"],S1=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],A1=S1,$b=[...A1,"indexConfiguration","indexState","indexEntries"],F5=$b,V5=[...$b,"globals"];var Sd=class extends zm{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function Rt(n,e){let t=W(n);return _s.F(t._e,e)}function yO(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Bo(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function R1(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ke=class n{constructor(e,t){this.comparator=e,this.root=t||Wr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Wr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vc(this.root,e,this.comparator,!1)}getReverseIterator(){return new vc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vc(this.root,e,this.comparator,!0)}},vc=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Wr=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Y();let e=this.left.check();if(e!==this.right.check())throw Y();return e+(this.isRed()?0:1)}};Wr.EMPTY=null,Wr.RED=!0,Wr.BLACK=!1;Wr.EMPTY=new class{constructor(){this.size=0}get key(){throw Y()}get value(){throw Y()}get color(){throw Y()}get left(){throw Y()}get right(){throw Y()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Wr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var je=class n{constructor(e){this.comparator=e,this.data=new Ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Gm(this.data.getIterator())}getIteratorFrom(e){return new Gm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Gm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function uc(n){return n.hasNext()?n.getNext():void 0}var Pn=class n{constructor(e){this.fields=e,e.sort(ft.comparator)}static empty(){return new n([])}unionWith(e){let t=new je(ft.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Tc(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Km=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function x1(){return typeof atob<"u"}var mt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Km("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ae(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};mt.EMPTY_BYTE_STRING=new mt("");var U5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Si(n){if(Z(!!n),typeof n=="string"){let e=0,t=U5.exec(n);if(Z(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qe(n.seconds),nanos:Qe(n.nanos)}}function Qe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ys(n){return typeof n=="string"?mt.fromBase64String(n):mt.fromUint8Array(n)}function Vg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Hb(n){let e=n.mapValue.fields.__previous_value__;return Vg(e)?Hb(e):e}function Ad(n){let e=Si(n.mapValue.fields.__local_write_time__.timestampValue);return new et(e.seconds,e.nanos)}var JT=class{constructor(e,t,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},vs=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var ps={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Fm={nullValue:"NULL_VALUE"};function xo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Vg(n)?4:N1(n)?9007199254740991:Ug(n)?10:11:Y()}function Qr(n,e){if(n===e)return!0;let t=xo(n);if(t!==xo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ad(n).isEqual(Ad(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Si(i.timestampValue),a=Si(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return ys(i.bytesValue).isEqual(ys(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Qe(i.geoPointValue.latitude)===Qe(s.geoPointValue.latitude)&&Qe(i.geoPointValue.longitude)===Qe(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Qe(i.integerValue)===Qe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Qe(i.doubleValue),a=Qe(s.doubleValue);return o===a?Dd(o)===Dd(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Tc(n.arrayValue.values||[],e.arrayValue.values||[],Qr);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(yO(o)!==yO(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Qr(o[c],a[c])))return!1;return!0}(n,e);default:return Y()}}function Rd(n,e){return(n.values||[]).find(t=>Qr(t,e))!==void 0}function ws(n,e){if(n===e)return 0;let t=xo(n),r=xo(e);if(t!==r)return ae(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ae(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Qe(s.integerValue||s.doubleValue),c=Qe(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return vO(n.timestampValue,e.timestampValue);case 4:return vO(Ad(n),Ad(e));case 5:return ae(n.stringValue,e.stringValue);case 6:return function(s,o){let a=ys(s),c=ys(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=ae(a[l],c[l]);if(d!==0)return d}return ae(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ae(Qe(s.latitude),Qe(o.latitude));return a!==0?a:ae(Qe(s.longitude),Qe(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return wO(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,c,l,d;let h=s.fields||{},p=o.fields||{},_=(a=h.value)===null||a===void 0?void 0:a.arrayValue,w=(c=p.value)===null||c===void 0?void 0:c.arrayValue,b=ae(((l=_?.values)===null||l===void 0?void 0:l.length)||0,((d=w?.values)===null||d===void 0?void 0:d.length)||0);return b!==0?b:wO(_,w)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===ps.mapValue&&o===ps.mapValue)return 0;if(s===ps.mapValue)return 1;if(o===ps.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){let p=ae(c[h],d[h]);if(p!==0)return p;let _=ws(a[c[h]],l[d[h]]);if(_!==0)return _}return ae(c.length,d.length)}(n.mapValue,e.mapValue);default:throw Y()}}function vO(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ae(n,e);let t=Si(n),r=Si(e),i=ae(t.seconds,r.seconds);return i!==0?i:ae(t.nanos,r.nanos)}function wO(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=ws(t[i],r[i]);if(s)return s}return ae(t.length,r.length)}function Cc(n){return XT(n)}function XT(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Si(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ys(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return G.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=XT(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${XT(t.fields[o])}`;return i+"}"}(n.mapValue):Y()}function No(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ZT(n){return!!n&&"integerValue"in n}function xd(n){return!!n&&"arrayValue"in n}function IO(n){return!!n&&"nullValue"in n}function EO(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Vm(n){return!!n&&"mapValue"in n}function Ug(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function wd(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Bo(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=wd(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=wd(n.arrayValue.values[t]);return e}return Object.assign({},n)}function N1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var P1={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function j5(n){return"nullValue"in n?Fm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?No(vs.empty(),G.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Ug(n)?P1:{mapValue:{}}:Y()}function B5(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?No(vs.empty(),G.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?P1:"mapValue"in n?Ug(n)?{mapValue:{}}:ps:Y()}function TO(n,e){let t=ws(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function bO(n,e){let t=ws(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Xt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Vm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wd(t)}setAll(e){let t=ft.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=wd(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Vm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Qr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Vm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Bo(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(wd(this.value))}};function M1(n){let e=[];return Bo(n.fields,(t,r)=>{let i=new ft([t]);if(Vm(r)){let s=M1(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Pn(e)}var Ct=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,ee.min(),ee.min(),ee.min(),Xt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,ee.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,ee.min(),ee.min(),Xt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,ee.min(),ee.min(),Xt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ee.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Yr=class{constructor(e,t){this.position=e,this.inclusive=t}};function CO(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),t.key):r=ws(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function DO(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Qr(n.position[t],e.position[t]))return!1;return!0}var Po=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function $5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Qm=class{},we=class n extends Qm{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new n0(e,t,r):t==="array-contains"?new s0(e,r):t==="in"?new Ym(e,r):t==="not-in"?new o0(e,r):t==="array-contains-any"?new a0(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new r0(e,r):new i0(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ws(t,this.value)):t!==null&&xo(this.value)===xo(t)&&this.matchesComparison(ws(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Oe=class n extends Qm{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Dc(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Dc(n){return n.op==="and"}function e0(n){return n.op==="or"}function qb(n){return k1(n)&&Dc(n)}function k1(n){for(let e of n.filters)if(e instanceof Oe)return!1;return!0}function t0(n){if(n instanceof we)return n.field.canonicalString()+n.op.toString()+Cc(n.value);if(qb(n))return n.filters.map(e=>t0(e)).join(",");{let e=n.filters.map(t=>t0(t)).join(",");return`${n.op}(${e})`}}function O1(n,e){return n instanceof we?function(r,i){return i instanceof we&&r.op===i.op&&r.field.isEqual(i.field)&&Qr(r.value,i.value)}(n,e):n instanceof Oe?function(r,i){return i instanceof Oe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&O1(o,i.filters[a]),!0):!1}(n,e):void Y()}function L1(n,e){let t=n.filters.concat(e);return Oe.create(t,n.op)}function F1(n){return n instanceof we?function(t){return`${t.field.canonicalString()} ${t.op} ${Cc(t.value)}`}(n):n instanceof Oe?function(t){return t.op.toString()+" {"+t.getFilters().map(F1).join(" ,")+"}"}(n):"Filter"}var n0=class extends we{constructor(e,t,r){super(e,t,r),this.key=G.fromName(r.referenceValue)}matches(e){let t=G.comparator(e.key,this.key);return this.matchesComparison(t)}},r0=class extends we{constructor(e,t){super(e,"in",t),this.keys=V1("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},i0=class extends we{constructor(e,t){super(e,"not-in",t),this.keys=V1("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function V1(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>G.fromName(r.referenceValue))}var s0=class extends we{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return xd(t)&&Rd(t.arrayValue,this.value)}},Ym=class extends we{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Rd(this.value.arrayValue,t)}},o0=class extends we{constructor(e,t){super(e,"not-in",t)}matches(e){if(Rd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Rd(this.value.arrayValue,t)}},a0=class extends we{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!xd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Rd(this.value.arrayValue,r))}};var c0=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function l0(n,e=null,t=[],r=[],i=null,s=null,o=null){return new c0(n,e,t,r,i,s,o)}function Mo(n){let e=W(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>t0(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Kd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Cc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Cc(r)).join(",")),e.ue=t}return e.ue}function Qd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!$5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!O1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!DO(n.startAt,e.startAt)&&DO(n.endAt,e.endAt)}function Jm(n){return G.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Xm(n,e){return n.filters.filter(t=>t instanceof we&&t.field.isEqual(e))}function SO(n,e,t){let r=Fm,i=!0;for(let s of Xm(n,e)){let o=Fm,a=!0;switch(s.op){case"<":case"<=":o=j5(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Fm}TO({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];TO({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function AO(n,e,t){let r=ps,i=!0;for(let s of Xm(n,e)){let o=ps,a=!0;switch(s.op){case">=":case">":o=B5(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=ps}bO({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];bO({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var gr=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function U1(n,e,t,r,i,s,o,a){return new gr(n,e,t,r,i,s,o,a)}function Bc(n){return new gr(n)}function RO(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function zb(n){return n.collectionGroup!==null}function Ic(n){let e=W(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new je(ft.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Po(s,r))}),t.has(ft.keyField().canonicalString())||e.ce.push(new Po(ft.keyField(),r))}return e.ce}function un(n){let e=W(n);return e.le||(e.le=H5(e,Ic(n))),e.le}function H5(n,e){if(n.limitType==="F")return l0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Po(i.field,s)});let t=n.endAt?new Yr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Yr(n.startAt.position,n.startAt.inclusive):null;return l0(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function u0(n,e){let t=n.filters.concat([e]);return new gr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Zm(n,e,t){return new gr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Yd(n,e){return Qd(un(n),un(e))&&n.limitType===e.limitType}function j1(n){return`${Mo(un(n))}|lt:${n.limitType}`}function mc(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>F1(i)).join(", ")}]`),Kd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Cc(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Cc(i)).join(",")),`Target(${r})`}(un(n))}; limitType=${n.limitType})`}function Jd(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):G.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of Ic(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=CO(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,Ic(r),i)||r.endAt&&!function(o,a,c){let l=CO(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,Ic(r),i))}(n,e)}function B1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function $1(n){return(e,t)=>{let r=!1;for(let i of Ic(n)){let s=q5(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function q5(n,e,t){let r=n.field.isKeyField()?G.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?ws(c,l):Y()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Y()}}var Jr=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Bo(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return R1(this.inner)}size(){return this.innerSize}};var z5=new Ke(G.comparator);function En(){return z5}var H1=new Ke(G.comparator);function yd(...n){let e=H1;for(let t of n)e=e.insert(t.key,t);return e}function q1(n){let e=H1;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function zr(){return Id()}function z1(){return Id()}function Id(){return new Jr(n=>n.toString(),(n,e)=>n.isEqual(e))}var W5=new Ke(G.comparator),G5=new je(G.comparator);function fe(...n){let e=G5;for(let t of n)e=e.add(t);return e}var K5=new je(ae);function Wb(){return K5}function Gb(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dd(e)?"-0":e}}function W1(n){return{integerValue:""+n}}function G1(n,e){return b1(e)?W1(e):Gb(n,e)}var Sc=class{constructor(){this._=void 0}};function Q5(n,e,t){return n instanceof Is?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Vg(s)&&(s=Hb(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Ai?Q1(n,e):n instanceof Ri?Y1(n,e):function(i,s){let o=K1(i,s),a=xO(o)+xO(i.Pe);return ZT(o)&&ZT(i.Pe)?W1(a):Gb(i.serializer,a)}(n,e)}function Y5(n,e,t){return n instanceof Ai?Q1(n,e):n instanceof Ri?Y1(n,e):t}function K1(n,e){return n instanceof Es?function(r){return ZT(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Is=class extends Sc{},Ai=class extends Sc{constructor(e){super(),this.elements=e}};function Q1(n,e){let t=J1(e);for(let r of n.elements)t.some(i=>Qr(i,r))||t.push(r);return{arrayValue:{values:t}}}var Ri=class extends Sc{constructor(e){super(),this.elements=e}};function Y1(n,e){let t=J1(e);for(let r of n.elements)t=t.filter(i=>!Qr(i,r));return{arrayValue:{values:t}}}var Es=class extends Sc{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function xO(n){return Qe(n.integerValue||n.doubleValue)}function J1(n){return xd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var ko=class{constructor(e,t){this.field=e,this.transform=t}};function J5(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Ai&&i instanceof Ai||r instanceof Ri&&i instanceof Ri?Tc(r.elements,i.elements,Qr):r instanceof Es&&i instanceof Es?Qr(r.Pe,i.Pe):r instanceof Is&&i instanceof Is}(n.transform,e.transform)}var d0=class{constructor(e,t){this.version=e,this.transformResults=t}},lt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Um(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Ac=class{};function X1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new bs(n.key,lt.none()):new Ts(n.key,n.data,lt.none());{let t=n.data,r=Xt.empty(),i=new je(ft.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new _r(n.key,r,new Pn(i.toArray()),lt.none())}}function X5(n,e,t){n instanceof Ts?function(i,s,o){let a=i.value.clone(),c=PO(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof _r?function(i,s,o){if(!Um(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=PO(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Z1(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Ed(n,e,t,r){return n instanceof Ts?function(s,o,a,c){if(!Um(s.precondition,o))return a;let l=s.value.clone(),d=MO(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof _r?function(s,o,a,c){if(!Um(s.precondition,o))return a;let l=MO(s.fieldTransforms,c,o),d=o.data;return d.setAll(Z1(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return Um(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function Z5(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=K1(r.transform,i||null);s!=null&&(t===null&&(t=Xt.empty()),t.set(r.field,s))}return t||null}function NO(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Tc(r,i,(s,o)=>J5(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Ts=class extends Ac{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},_r=class extends Ac{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Z1(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function PO(n,e,t){let r=new Map;Z(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Y5(o,a,t[i]))}return r}function MO(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,Q5(s,o,e))}return r}var bs=class extends Ac{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Nd=class extends Ac{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Pd=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&X5(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ed(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ed(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=z1();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=X1(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(ee.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),fe())}isEqual(e){return this.batchId===e.batchId&&Tc(this.mutations,e.mutations,(t,r)=>NO(t,r))&&Tc(this.baseMutations,e.baseMutations,(t,r)=>NO(t,r))}},h0=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Z(e.mutations.length===r.length);let i=function(){return W5}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Md=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var f0=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var It,Ce;function eL(n){switch(n){default:return Y();case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0}}function tL(n){if(n===void 0)return ht("GRPC error has no .code"),M.UNKNOWN;switch(n){case It.OK:return M.OK;case It.CANCELLED:return M.CANCELLED;case It.UNKNOWN:return M.UNKNOWN;case It.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case It.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case It.INTERNAL:return M.INTERNAL;case It.UNAVAILABLE:return M.UNAVAILABLE;case It.UNAUTHENTICATED:return M.UNAUTHENTICATED;case It.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case It.NOT_FOUND:return M.NOT_FOUND;case It.ALREADY_EXISTS:return M.ALREADY_EXISTS;case It.PERMISSION_DENIED:return M.PERMISSION_DENIED;case It.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case It.ABORTED:return M.ABORTED;case It.OUT_OF_RANGE:return M.OUT_OF_RANGE;case It.UNIMPLEMENTED:return M.UNIMPLEMENTED;case It.DATA_LOSS:return M.DATA_LOSS;default:return Y()}}(Ce=It||(It={}))[Ce.OK=0]="OK",Ce[Ce.CANCELLED=1]="CANCELLED",Ce[Ce.UNKNOWN=2]="UNKNOWN",Ce[Ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ce[Ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ce[Ce.NOT_FOUND=5]="NOT_FOUND",Ce[Ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ce[Ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ce[Ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ce[Ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ce[Ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ce[Ce.ABORTED=10]="ABORTED",Ce[Ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ce[Ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ce[Ce.INTERNAL=13]="INTERNAL",Ce[Ce.UNAVAILABLE=14]="UNAVAILABLE",Ce[Ce.DATA_LOSS=15]="DATA_LOSS";var kO=null;function nL(){return new TextEncoder}var e8=new ls([4294967295,4294967295],0);function OO(n){let e=nL().encode(n),t=new AT;return t.update(e),new Uint8Array(t.digest())}function LO(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ls([t,r],0),new ls([i,s],0)]}var p0=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ao(`Invalid padding: ${t}`);if(r<0)throw new Ao(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ao(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ao(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ls.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(ls.fromNumber(r)));return i.compare(e8)===1&&(i=new ls([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=OO(e),[r,i]=LO(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=OO(e),[r,i]=LO(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Ao=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var kd=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Od.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(ee.min(),i,new Ke(ae),En(),fe())}},Od=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,fe(),fe(),fe())}};var Ec=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},eg=class{constructor(e,t){this.targetId=e,this.me=t}},tg=class{constructor(e,t,r=mt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},ng=class{constructor(){this.fe=0,this.ge=VO(),this.pe=mt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=fe(),t=fe(),r=fe();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Y()}}),new Od(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=VO()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Z(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},m0=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=En(),this.qe=FO(),this.Qe=new Ke(ae)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Y()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(Jm(s))if(r===0){let o=new G(s.path);this.Ue(t,o,Ct.newNoDocument(o,ee.min()))}else Z(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}kO?.et(function(d,h,p,_,w){var b,R,L,H,U,Q;let ie={localCacheCount:d,existenceFilterCount:h.count,databaseId:p.database,projectId:p.projectId},J=h.unchangedNames;return J&&(ie.bloomFilter={applied:w===0,hashCount:(b=J?.hashCount)!==null&&b!==void 0?b:0,bitmapLength:(H=(L=(R=J?.bits)===null||R===void 0?void 0:R.bitmap)===null||L===void 0?void 0:L.length)!==null&&H!==void 0?H:0,padding:(Q=(U=J?.bits)===null||U===void 0?void 0:U.padding)!==null&&Q!==void 0?Q:0,mightContain:T=>{var v;return(v=_?.mightContain(T))!==null&&v!==void 0&&v}}),ie}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=ys(r).toUint8Array()}catch(c){if(c instanceof Km)return Qn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new p0(o,i,s)}catch(c){return Qn(c instanceof Ao?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&Jm(a.target)){let c=new G(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Ct.newNoDocument(c,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=fe();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new kd(e,t,this.Qe,this.ke,r);return this.ke=En(),this.qe=FO(),this.Qe=new Ke(ae),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new ng,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new je(ae),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ng),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function FO(){return new Ke(G.comparator)}function VO(){return new Ke(G.comparator)}var t8={asc:"ASCENDING",desc:"DESCENDING"},n8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},r8={and:"AND",or:"OR"},g0=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function _0(n,e){return n.useProto3Json||Kd(e)?e:{value:e}}function Rc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function rL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function i8(n,e){return Rc(n,e.toTimestamp())}function pt(n){return Z(!!n),ee.fromTimestamp(function(t){let r=Si(t);return new et(r.seconds,r.nanos)}(n))}function Kb(n,e){return y0(n,e).canonicalString()}function y0(n,e){let t=function(i){return new De(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function iL(n){let e=De.fromString(n);return Z(pL(e)),e}function Ld(n,e){return Kb(n.databaseId,e.path)}function Gr(n,e){let t=iL(e);if(t.get(1)!==n.databaseId.projectId)throw new F(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new F(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new G(aL(t))}function sL(n,e){return Kb(n.databaseId,e)}function oL(n){let e=iL(n);return e.length===4?De.emptyPath():aL(e)}function v0(n){return new De(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function aL(n){return Z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function UO(n,e,t){return{name:Ld(n,e),fields:t.value.mapValue.fields}}function cL(n,e,t){let r=Gr(n,e.name),i=pt(e.updateTime),s=e.createTime?pt(e.createTime):ee.min(),o=new Xt({mapValue:{fields:e.fields}}),a=Ct.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function s8(n,e){return"found"in e?function(r,i){Z(!!i.found),i.found.name,i.found.updateTime;let s=Gr(r,i.found.name),o=pt(i.found.updateTime),a=i.found.createTime?pt(i.found.createTime):ee.min(),c=new Xt({mapValue:{fields:i.found.fields}});return Ct.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){Z(!!i.missing),Z(!!i.readTime);let s=Gr(r,i.missing),o=pt(i.readTime);return Ct.newNoDocument(s,o)}(n,e):Y()}function o8(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Y()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(Z(d===void 0||typeof d=="string"),mt.fromBase64String(d||"")):(Z(d===void 0||d instanceof Buffer||d instanceof Uint8Array),mt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?M.UNKNOWN:tL(l.code);return new F(d,l.message||"")}(o);t=new tg(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Gr(n,r.document.name),s=pt(r.document.updateTime),o=r.document.createTime?pt(r.document.createTime):ee.min(),a=new Xt({mapValue:{fields:r.document.fields}}),c=Ct.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new Ec(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Gr(n,r.document),s=r.readTime?pt(r.readTime):ee.min(),o=Ct.newNoDocument(i,s),a=r.removedTargetIds||[];t=new Ec([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Gr(n,r.document),s=r.removedTargetIds||[];t=new Ec([],s,i,null)}else{if(!("filter"in e))return Y();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new f0(i,s),a=r.targetId;t=new eg(a,o)}}return t}function Fd(n,e){let t;if(e instanceof Ts)t={update:UO(n,e.key,e.value)};else if(e instanceof bs)t={delete:Ld(n,e.key)};else if(e instanceof _r)t={update:UO(n,e.key,e.data),updateMask:h8(e.fieldMask)};else{if(!(e instanceof Nd))return Y();t={verify:Ld(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Is)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ai)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ri)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Es)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Y()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:i8(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Y()}(n,e.precondition)),t}function w0(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?lt.updateTime(pt(s.updateTime)):s.exists!==void 0?lt.exists(s.exists):lt.none()}(e.currentDocument):lt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)Z(a.setToServerValue==="REQUEST_TIME"),c=new Is;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new Ai(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new Ri(d)}else"increment"in a?c=new Es(o,a.increment):Y();let l=ft.fromServerFormat(a.fieldPath);return new ko(l,c)}(n,i)):[];if(e.update){e.update.name;let i=Gr(n,e.update.name),s=new Xt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new Pn(l.map(d=>ft.fromServerFormat(d)))}(e.updateMask);return new _r(i,s,o,t,r)}return new Ts(i,s,t,r)}if(e.delete){let i=Gr(n,e.delete);return new bs(i,t)}if(e.verify){let i=Gr(n,e.verify);return new Nd(i,t)}return Y()}function a8(n,e){return n&&n.length>0?(Z(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?pt(i.updateTime):pt(s);return o.isEqual(ee.min())&&(o=pt(s)),new d0(o,i.transformResults||[])}(t,e))):[]}function lL(n,e){return{documents:[sL(n,e.path)]}}function uL(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=sL(n,i);let s=function(l){if(l.length!==0)return fL(Oe.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(p){return{field:gc(p.field),direction:l8(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=_0(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function dL(n){let e=oL(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Z(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(h){let p=hL(h);return p instanceof Oe&&qb(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(p=>function(w){return new Po(_c(w.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,Kd(p)?null:p}(t.limit));let c=null;t.startAt&&(c=function(h){let p=!!h.before,_=h.values||[];return new Yr(_,p)}(t.startAt));let l=null;return t.endAt&&(l=function(h){let p=!h.before,_=h.values||[];return new Yr(_,p)}(t.endAt)),U1(e,i,o,s,a,"F",c,l)}function c8(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Y()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function hL(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=_c(t.unaryFilter.field);return we.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=_c(t.unaryFilter.field);return we.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=_c(t.unaryFilter.field);return we.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=_c(t.unaryFilter.field);return we.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Y()}}(n):n.fieldFilter!==void 0?function(t){return we.create(_c(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Y()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Oe.create(t.compositeFilter.filters.map(r=>hL(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Y()}}(t.compositeFilter.op))}(n):Y()}function l8(n){return t8[n]}function u8(n){return n8[n]}function d8(n){return r8[n]}function gc(n){return{fieldPath:n.canonicalString()}}function _c(n){return ft.fromServerFormat(n.fieldPath)}function fL(n){return n instanceof we?function(t){if(t.op==="=="){if(EO(t.value))return{unaryFilter:{field:gc(t.field),op:"IS_NAN"}};if(IO(t.value))return{unaryFilter:{field:gc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(EO(t.value))return{unaryFilter:{field:gc(t.field),op:"IS_NOT_NAN"}};if(IO(t.value))return{unaryFilter:{field:gc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gc(t.field),op:u8(t.op),value:t.value}}}(n):n instanceof Oe?function(t){let r=t.getFilters().map(i=>fL(i));return r.length===1?r[0]:{compositeFilter:{op:d8(t.op),filters:r}}}(n):Y()}function h8(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function pL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var xc=class n{constructor(e,t,r,i,s=ee.min(),o=ee.min(),a=mt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var rg=class{constructor(e){this.ct=e}};function f8(n,e){let t;if(e.document)t=cL(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=G.fromSegments(e.noDocument.path),i=Lo(e.noDocument.readTime);t=Ct.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Y();{let r=G.fromSegments(e.unknownDocument.path),i=Lo(e.unknownDocument.version);t=Ct.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new et(i[0],i[1]);return ee.fromTimestamp(s)}(e.readTime)),t}function jO(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ig(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Ld(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Rc(s,o.version.toTimestamp()),createTime:Rc(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Oo(e.version)};else{if(!e.isUnknownDocument())return Y();r.unknownDocument={path:t.path.toArray(),version:Oo(e.version)}}return r}function ig(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Oo(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Lo(n){let e=new et(n.seconds,n.nanoseconds);return ee.fromTimestamp(e)}function Co(n,e){let t=(e.baseMutations||[]).map(s=>w0(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>w0(n.ct,s)),i=et.fromMillis(e.localWriteTimeMs);return new Pd(e.batchId,i,t,r)}function vd(n){let e=Lo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Lo(n.lastLimboFreeSnapshotVersion):ee.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return Z(s.documents.length===1),un(Bc(oL(s.documents[0])))}(n.query):function(s){return un(dL(s))}(n.query),new xc(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,mt.fromBase64String(n.resumeToken))}function mL(n,e){let t=Oo(e.snapshotVersion),r=Oo(e.lastLimboFreeSnapshotVersion),i;i=Jm(e.target)?lL(n.ct,e.target):uL(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Mo(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Qb(n){let e=dL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Zm(e,e.limit,"L"):e}function OT(n,e){return new Md(e.largestBatchId,w0(n.ct,e.overlayMutation))}function BO(n,e){let t=e.path.lastSegment();return[n,ln(e.path.popLast()),t]}function $O(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Oo(r.readTime),documentKey:ln(r.documentKey.path),largestBatchId:r.largestBatchId}}var I0=class{getBundleMetadata(e,t){return HO(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Lo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return HO(e).put(function(i){return{bundleId:i.id,createTime:Oo(pt(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return qO(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:Qb(s.bundledQuery),readTime:Lo(s.readTime)}}(r)})}saveNamedQuery(e,t){return qO(e).put(function(i){return{name:i.name,readTime:Oo(pt(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function HO(n){return Rt(n,"bundles")}function qO(n){return Rt(n,"namedQueries")}var sg=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return pd(e).get(BO(this.userId,t)).next(r=>r?OT(this.serializer,r):null)}getOverlays(e,t){let r=zr();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new Md(t,o);i.push(this.ht(e,a))}),P.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(ln(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(pd(e).j("collectionPathOverlayIndex",a))}),P.waitFor(s)}getOverlaysForCollection(e,t,r){let i=zr(),s=ln(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return pd(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=OT(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=zr(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return pd(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,d)=>{let h=OT(this.serializer,l);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return pd(e).put(function(i,s,o){let[a,c,l]=BO(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Fd(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function pd(n){return Rt(n,"documentOverlays")}var E0=class{Pt(e){return Rt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?mt.fromUint8Array(r):mt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var Ci=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Qe(e.integerValue));else if("doubleValue"in e){let r=Qe(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Dd(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Si(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(ys(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?N1(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Ug(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Y()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Qe(a)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),G.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Ci.vt=new Ci;function p8(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function zO(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=p8(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var T0=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),r=zO(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),r=zO(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},b0=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},C0=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},Do=class{constructor(){this.jt=new T0,this.Ht=new b0(this.jt),this.Jt=new C0(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var So=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function us(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=WO(n.arrayValue,e.arrayValue),t!==0?t:(t=WO(n.directionalValue,e.directionalValue),t!==0?t:G.comparator(n.documentKey,e.documentKey)))}function WO(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var og=class{constructor(e){this.Xt=new je((t,r)=>ft.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Z(e.collectionGroup===this.collectionId),this.nn)return!1;let t=WT(e);if(t!==void 0&&!this.sn(t))return!1;let r=To(e),i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.on(a,c)||!this._n(this.en[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new je(ft.comparator),t=[];for(let r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new wc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new wc(r.field,0))}for(let r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new wc(r.field,r.dir==="asc"?0:1)));return new bc(bc.UNKNOWN_ID,this.collectionId,t,Cd.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function gL(n){var e,t;if(Z(n instanceof we||n instanceof Oe),n instanceof we){if(n instanceof Ym){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>we.create(n.field,"==",s)))||[];return Oe.create(i,"or")}return n}let r=n.filters.map(i=>gL(i));return Oe.create(r,n.op)}function m8(n){if(n.getFilters().length===0)return[];let e=A0(gL(n));return Z(_L(e)),D0(e)||S0(e)?[e]:e.getFilters()}function D0(n){return n instanceof we}function S0(n){return n instanceof Oe&&qb(n)}function _L(n){return D0(n)||S0(n)||function(t){if(t instanceof Oe&&e0(t)){for(let r of t.getFilters())if(!D0(r)&&!S0(r))return!1;return!0}return!1}(n)}function A0(n){if(Z(n instanceof we||n instanceof Oe),n instanceof we)return n;if(n.filters.length===1)return A0(n.filters[0]);let e=n.filters.map(r=>A0(r)),t=Oe.create(e,n.op);return t=ag(t),_L(t)?t:(Z(t instanceof Oe),Z(Dc(t)),Z(t.filters.length>1),t.filters.reduce((r,i)=>Yb(r,i)))}function Yb(n,e){let t;return Z(n instanceof we||n instanceof Oe),Z(e instanceof we||e instanceof Oe),t=n instanceof we?e instanceof we?function(i,s){return Oe.create([i,s],"and")}(n,e):GO(n,e):e instanceof we?GO(e,n):function(i,s){if(Z(i.filters.length>0&&s.filters.length>0),Dc(i)&&Dc(s))return L1(i,s.getFilters());let o=e0(i)?i:s,a=e0(i)?s:i,c=o.filters.map(l=>Yb(l,a));return Oe.create(c,"or")}(n,e),ag(t)}function GO(n,e){if(Dc(e))return L1(e,n.getFilters());{let t=e.filters.map(r=>Yb(n,r));return Oe.create(t,"or")}}function ag(n){if(Z(n instanceof we||n instanceof Oe),n instanceof we)return n;let e=n.getFilters();if(e.length===1)return ag(e[0]);if(k1(n))return n;let t=e.map(i=>ag(i)),r=[];return t.forEach(i=>{i instanceof we?r.push(i):i instanceof Oe&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Oe.create(r,n.op)}var R0=class{constructor(){this.un=new Vd}addToCollectionParentIndex(e,t){return this.un.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(Yn.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(Yn.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},Vd=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new je(De.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new je(De.comparator)).toArray()}};var Pm=new Uint8Array(0),x0=class{constructor(e,t){this.databaseId=t,this.cn=new Vd,this.ln=new Jr(r=>Mo(r),(r,i)=>Qd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let s={collectionId:r,parent:ln(i)};return KO(e).put(s)}return P.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[v1(t),""],!1,!0);return KO(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(qr(o.parent))}return r})}addFieldIndex(e,t){let r=md(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=hc(e);return s.next(a=>{o.put($O(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=md(e),i=hc(e),s=dc(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=md(e),r=dc(e),i=hc(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return P.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new og(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=dc(e),i=!0,s=new Map;return P.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=fe(),a=[];return P.forEach(s,(c,l)=>{V("IndexedDbIndexManager",`Using index ${function(U){return`id=${U.indexId}|cg=${U.collectionGroup}|f=${U.fields.map(Q=>`${Q.fieldPath}:${Q.kind}`).join(",")}`}(c)} to execute ${Mo(t)}`);let d=function(U,Q){let ie=WT(Q);if(ie===void 0)return null;for(let J of Xm(U,ie.fieldPath))switch(J.op){case"array-contains-any":return J.value.arrayValue.values||[];case"array-contains":return[J.value]}return null}(l,c),h=function(U,Q){let ie=new Map;for(let J of To(Q))for(let T of Xm(U,J.fieldPath))switch(T.op){case"==":case"in":ie.set(J.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return ie.set(J.fieldPath.canonicalString(),T.value),Array.from(ie.values())}return null}(l,c),p=function(U,Q){let ie=[],J=!0;for(let T of To(Q)){let v=T.kind===0?SO(U,T.fieldPath,U.startAt):AO(U,T.fieldPath,U.startAt);ie.push(v.value),J&&(J=v.inclusive)}return new Yr(ie,J)}(l,c),_=function(U,Q){let ie=[],J=!0;for(let T of To(Q)){let v=T.kind===0?AO(U,T.fieldPath,U.endAt):SO(U,T.fieldPath,U.endAt);ie.push(v.value),J&&(J=v.inclusive)}return new Yr(ie,J)}(l,c),w=this.In(c,l,p),b=this.In(c,l,_),R=this.Tn(c,l,h),L=this.En(c.indexId,d,w,p.inclusive,b,_.inclusive,R);return P.forEach(L,H=>r.G(H,t.limit).next(U=>{U.forEach(Q=>{let ie=G.fromSegments(Q.documentKey);o.has(ie)||(o=o.add(ie),a.push(ie))})}))}).next(()=>a)}return P.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=m8(Oe.create(e.filters,"and")).map(r=>l0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),l=c/(t!=null?t.length:1),d=[];for(let h=0;h<c;++h){let p=t?this.dn(t[h/l]):Pm,_=this.An(e,p,r[h%l],i),w=this.Rn(e,p,s[h%l],o),b=a.map(R=>this.An(e,p,R,!0));d.push(...this.createRange(_,w,b))}return d}An(e,t,r,i){let s=new So(e,G.empty(),t,r);return i?s:s.Zt()}Rn(e,t,r,i){let s=new So(e,G.empty(),t,r);return i?s.Zt():s}Pn(e,t){let r=new og(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.hn(t);return P.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new je(ft.comparator),d=!1;for(let h of c.filters)for(let p of h.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?d=!0:l=l.add(p.field));for(let h of c.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){let r=new Do;for(let i of To(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Yt(i.kind);Ci.vt.It(s,o)}return r.zt()}dn(e){let t=new Do;return Ci.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let r=new Do;return Ci.vt.It(No(this.databaseId,t),r.Yt(function(s){let o=To(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new Do);let s=0;for(let o of To(e)){let a=r[s++];for(let c of i)if(this.fn(t,o.fieldPath)&&xd(a))i=this.gn(i,o,a);else{let l=c.Yt(o.kind);Ci.vt.It(a,l)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new Do;c.seed(a.zt()),Ci.vt.It(o,c.Yt(t.kind)),s.push(c)}return s}fn(e,t){return!!e.filters.find(r=>r instanceof we&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=md(e),i=hc(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return P.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,h){let p=h?new Cd(h.sequenceNumber,new Yn(Lo(h.readTime),new G(qr(h.documentKey)),h.largestBatchId)):Cd.empty(),_=d.fields.map(([w,b])=>new wc(ft.fromServerFormat(w),b));return new bc(d.indexId,d.collectionGroup,_,p)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ae(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=md(e),s=hc(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>P.forEach(a,c=>s.put($O(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return P.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?P.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),P.forEach(a,c=>this.wn(e,i,c).next(l=>{let d=this.Sn(s,c);return l.isEqual(d)?P.resolve():this.bn(e,s,c,l,d)}))))})}Dn(e,t,r,i){return dc(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return dc(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){let i=dc(e),s=new je(us);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{s=s.add(new So(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,t){let r=new je(us),i=this.Vn(t,e);if(i==null)return r;let s=WT(t);if(s!=null){let o=e.data.field(s.fieldPath);if(xd(o))for(let a of o.arrayValue.values||[])r=r.add(new So(t.indexId,e.key,this.dn(a),i))}else r=r.add(new So(t.indexId,e.key,Pm,i));return r}bn(e,t,r,i,s){V("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,l,d,h,p){let _=c.getIterator(),w=l.getIterator(),b=uc(_),R=uc(w);for(;b||R;){let L=!1,H=!1;if(b&&R){let U=d(b,R);U<0?H=!0:U>0&&(L=!0)}else b!=null?H=!0:L=!0;L?(h(R),R=uc(w)):H?(p(b),b=uc(_)):(b=uc(_),R=uc(w))}}(i,s,us,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),P.waitFor(o)}yn(e){let t=1;return hc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>us(o,a)).filter((o,a,c)=>!a||us(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=us(o,e),c=us(o,t);if(a===0)i[0]=e.Zt();else if(a>0&&c<0)i.push(o),i.push(o.Zt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Pm,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Pm,[]];s.push(IDBKeyRange.bound(a,c))}return s}Cn(e,t){return us(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(QO)}getMinOffset(e,t){return P.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||Y())).next(QO)}};function KO(n){return Rt(n,"collectionParents")}function dc(n){return Rt(n,"indexEntries")}function md(n){return Rt(n,"indexConfiguration")}function hc(n){return Rt(n,"indexState")}function QO(n){Z(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;jb(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Yn(e.readTime,e.documentKey,t)}var YO={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Kn=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function yL(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:o},(d,h,p)=>(a++,p.delete()));s.push(c.next(()=>{Z(a===1)}));let l=[];for(let d of t.mutations){let h=C1(e,d.key.path,t.batchId);s.push(i.delete(h)),l.push(d.key)}return P.waitFor(s).next(()=>l)}function cg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Y();e=n.noDocument}return JSON.stringify(e).length}Kn.DEFAULT_COLLECTION_PERCENTILE=10,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kn.DEFAULT=new Kn(41943040,Kn.DEFAULT_COLLECTION_PERCENTILE,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kn.DISABLED=new Kn(-1,0,0);var lg=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){Z(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ds(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=yc(e),o=ds(e);return o.add({}).next(a=>{Z(typeof a=="number");let c=new Pd(a,t,r,i),l=function(_,w,b){let R=b.baseMutations.map(H=>Fd(_.ct,H)),L=b.mutations.map(H=>Fd(_.ct,H));return{userId:w,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:R,mutations:L}}(this.serializer,this.userId,c),d=[],h=new je((p,_)=>ae(p.canonicalString(),_.canonicalString()));for(let p of i){let _=C1(this.userId,p.key.path,a);h=h.add(p.key.path.popLast()),d.push(o.put(l)),d.push(s.put(_,I5))}return h.forEach(p=>{d.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Fn[a]=c.keys()}),P.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return ds(e).get(t).next(r=>r?(Z(r.userId===this.userId),Co(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?P.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return ds(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(Z(a.batchId>=r),s=Co(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ds(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ds(e).U("userMutationsIndex",t).next(r=>r.map(i=>Co(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Lm(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return yc(e).J({range:i},(o,a,c)=>{let[l,d,h]=o,p=qr(d);if(l===this.userId&&t.path.isEqual(p))return ds(e).get(h).next(_=>{if(!_)throw Y();Z(_.userId===this.userId),s.push(Co(this.serializer,_))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new je(ae),i=[];return t.forEach(s=>{let o=Lm(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=yc(e).J({range:a},(l,d,h)=>{let[p,_,w]=l,b=qr(_);p===this.userId&&s.path.isEqual(b)?r=r.add(w):h.done()});i.push(c)}),P.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=Lm(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new je(ae);return yc(e).J({range:o},(c,l,d)=>{let[h,p,_]=c,w=qr(p);h===this.userId&&r.isPrefixOf(w)?w.length===i&&(a=a.add(_)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(ds(e).get(s).next(o=>{if(o===null)throw Y();Z(o.userId===this.userId),r.push(Co(this.serializer,o))}))}),P.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return yL(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),P.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return P.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return yc(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=qr(s[1]);i.push(c)}else a.done()}).next(()=>{Z(i.length===0)})})}containsKey(e,t){return vL(e,this.userId,t)}Nn(e){return wL(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function vL(n,e,t){let r=Lm(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return yc(n).J({range:s,H:!0},(a,c,l)=>{let[d,h,p]=a;d===e&&h===i&&(o=!0),l.done()}).next(()=>o)}function ds(n){return Rt(n,"mutations")}function yc(n){return Rt(n,"documentMutations")}function wL(n){return Rt(n,"mutationQueues")}var Nc=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var N0=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let r=new Nc(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>ee.fromTimestamp(new et(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>fc(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(Z(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return fc(e).J((o,a)=>{let c=vd(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>P.waitFor(s)).next(()=>i)}forEachTarget(e,t){return fc(e).J((r,i)=>{let s=vd(i);t(s)})}qn(e){return JO(e).get("targetGlobalKey").next(t=>(Z(t!==null),t))}Qn(e,t){return JO(e).put("targetGlobalKey",t)}Kn(e,t){return fc(e).put(mL(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Mo(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return fc(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=vd(a);Qd(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=hs(e);return t.forEach(o=>{let a=ln(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),P.waitFor(i)}removeMatchingKeys(e,t,r){let i=hs(e);return P.forEach(t,s=>{let o=ln(s.path);return P.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=hs(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=hs(e),s=fe();return i.J({range:r,H:!0},(o,a,c)=>{let l=qr(o[1]),d=new G(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=ln(t.path),i=IDBKeyRange.bound([r],[v1(r)],!1,!0),s=0;return hs(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return fc(e).get(t).next(r=>r?vd(r):null)}};function fc(n){return Rt(n,"targets")}function JO(n){return Rt(n,"targetGlobal")}function hs(n){return Rt(n,"targetDocuments")}function XO([n,e],[t,r]){let i=ae(n,t);return i===0?ae(e,r):i}var P0=class{constructor(e){this.Un=e,this.buffer=new je(XO),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();XO(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},M0=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){V("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ss(t)?V("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Ds(t)}yield this.Hn(3e5)}))}},k0=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return P.resolve(Nn.oe);let r=new P0(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(YO)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),YO):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,s,o,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),pc()<=me.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),P.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function g8(n,e){return new k0(n,e)}var O0=class{constructor(e,t){this.db=e,this.garbageCollector=g8(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return Mm(e,r)}removeReference(e,t,r){return Mm(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Mm(e,t)}nr(e,t){return function(i,s){let o=!1;return wL(i).Y(a=>vL(i,a,s).next(c=>(c&&(o=!0),P.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.tr(e,(o,a)=>{if(a<=t){let c=this.nr(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ee.min()),hs(e).delete(function(h){return[0,ln(h.path)]}(o))))});i.push(c)}}).next(()=>P.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Mm(e,t)}tr(e,t){let r=hs(e),i,s=Nn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==Nn.oe&&t(new G(qr(i)),s),s=l,i=c):s=Nn.oe}).next(()=>{s!==Nn.oe&&t(new G(qr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Mm(n,e){return hs(n).put(function(r,i){return{targetId:0,path:ln(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var ug=class{constructor(){this.changes=new Jr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ct.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var L0=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Eo(e).put(r)}removeEntry(e,t,r){return Eo(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],ig(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Ct.newInvalidDocument(t);return Eo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(gd(t))},(i,s)=>{r=this.ir(t,s)}).next(()=>r)}sr(e,t){let r={size:0,document:Ct.newInvalidDocument(t)};return Eo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(gd(t))},(i,s)=>{r={document:this.ir(t,s),size:cg(s)}}).next(()=>r)}getEntries(e,t){let r=En();return this._r(e,t,(i,s)=>{let o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,t){let r=En(),i=new Ke(G.comparator);return this._r(e,t,(s,o)=>{let a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,cg(o))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return P.resolve();let i=new je(t1);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(gd(i.first()),gd(i.last())),o=i.getIterator(),a=o.getNext();return Eo(e).J({index:"documentKeyIndex",range:s},(c,l,d)=>{let h=G.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&t1(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(gd(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),ig(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Eo(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=En();for(let h of l){let p=this.ir(G.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);p.isFoundDocument()&&(Jd(t,p)||i.has(p.key))&&(d=d.insert(p.key,p))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=En(),o=e1(t,r),a=e1(t,Yn.max());return Eo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,d)=>{let h=this.ir(G.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new F0(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return ZO(e).get("remoteDocumentGlobalKey").next(t=>(Z(!!t),t))}rr(e,t){return ZO(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let r=f8(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ee.min())))return r}return Ct.newInvalidDocument(e)}};function IL(n){return new L0(n)}var F0=class extends ug{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Jr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new je((s,o)=>ae(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=jO(this.cr.serializer,o);i=i.add(s.path.popLast());let l=cg(c);r+=l-a.size,t.push(this.cr.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=jO(this.cr.serializer,o.convertToNoDocument(ee.min()));t.push(this.cr.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,r)),P.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function ZO(n){return Rt(n,"remoteDocumentGlobal")}function Eo(n){return Rt(n,"remoteDocumentsV14")}function gd(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function e1(n,e){let t=e.documentKey.path.toArray();return[n,ig(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function t1(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ae(t[s],r[s]),i)return i;return i=ae(t.length,r.length),i||(i=ae(t[t.length-2],r[r.length-2]),i||ae(t[t.length-1],r[r.length-1]))}var V0=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var dg=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ed(r.mutation,i,Pn.empty(),et.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,fe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=fe()){let i=zr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=yd();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=zr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,fe()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=En(),o=Id(),a=function(){return Id()}();return t.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof _r)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),Ed(d.mutation,l,d.mutation.getFieldMask(),et.now())):o.set(l.key,Pn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var h;return a.set(l,new V0(d,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Id(),i=new Ke((o,a)=>o-a),s=fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=r.get(c)||Pn.empty();d=a.applyToLocalView(l,d),r.set(c,d);let h=(i.get(a.batchId)||fe()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,h=z1();d.forEach(p=>{if(!s.has(p)){let _=X1(t.get(p),r.get(p));_!==null&&h.set(p,_),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return P.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):zb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):P.resolve(zr()),a=-1,c=s;return o.next(l=>P.forEach(l,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?P.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,fe())).next(d=>({batchId:a,changes:q1(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new G(t)).next(r=>{let i=yd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=yd();return this.indexManager.getCollectionParents(e,s).next(a=>P.forEach(a,c=>{let l=function(h,p){return new gr(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((h,p)=>{o=o.insert(h,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,Ct.newInvalidDocument(d)))});let a=yd();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&Ed(d.mutation,l,Pn.empty(),et.now()),Jd(t,l)&&(a=a.insert(c,l))}),a})}};var U0=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return P.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:pt(i.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:Qb(i.bundledQuery),readTime:pt(i.readTime)}}(t)),P.resolve()}};var j0=class{constructor(){this.overlays=new Ke(G.comparator),this.Ir=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=zr();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=zr(),s=t.length+1,o=new G(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ke((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=zr(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=zr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return P.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Md(t,r));let s=this.Ir.get(t);s===void 0&&(s=fe(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var B0=class{constructor(){this.sessionToken=mt.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var Ud=class{constructor(){this.Tr=new je(Et.Er),this.dr=new je(Et.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new Et(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Et(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new G(new De([])),r=new Et(t,e),i=new Et(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new G(new De([])),r=new Et(t,e),i=new Et(t,e+1),s=fe();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Et(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Et=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return G.comparator(e.key,t.key)||ae(e.wr,t.wr)}static Ar(e,t){return ae(e.wr,t.wr)||G.comparator(e.key,t.key)}};var $0=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new je(Et.Er)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Pd(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.br=this.br.add(new Et(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return P.resolve(o)}lookupMutationBatch(e,t){return P.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Et(t,0),i=new Et(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{let a=this.Dr(o.wr);s.push(a)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new je(ae);return t.forEach(i=>{let s=new Et(i,0),o=new Et(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),P.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;G.isDocumentKey(s)||(s=s.child(""));let o=new Et(new G(s),0),a=new je(ae);return this.br.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.wr)),!0)},o),P.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Z(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return P.forEach(t.mutations,i=>{let s=new Et(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new Et(t,0),i=this.br.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var H0=class{constructor(e){this.Mr=e,this.docs=function(){return new Ke(G.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():Ct.newInvalidDocument(t))}getEntries(e,t){let r=En();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ct.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=En(),o=t.path,a=new G(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||jb(I1(d),r)<=0||(i.has(d.key)||Jd(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Y()}Or(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new q0(this)}getSize(e){return P.resolve(this.size)}},q0=class extends ug{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var z0=class{constructor(e){this.persistence=e,this.Nr=new Jr(t=>Mo(t),Qd),this.lastRemoteSnapshotVersion=ee.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ud,this.targetCount=0,this.kr=Nc.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),P.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Nc(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.Kn(t),P.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),P.waitFor(s).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.Br.containsKey(t))}};var hg=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Nn(0),this.Kr=!1,this.Kr=!0,this.$r=new B0,this.referenceDelegate=e(this),this.Ur=new z0(this),this.indexManager=new R0,this.remoteDocumentCache=function(i){return new H0(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new rg(t),this.Gr=new U0(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new j0,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new $0(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);let i=new W0(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return P.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},W0=class extends zm{constructor(e){super(),this.currentSequenceNumber=e}},fg=class n{constructor(e){this.persistence=e,this.Jr=new Ud,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw Y()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),P.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Xr,r=>{let i=G.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,ee.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return P.or([()=>P.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var G0=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new Wm("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",_O,{unique:!0}),c.createObjectStore("documentMutations")}(e),n1(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=P.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),n1(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ee.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",_O,{unique:!0});let h=l.store("mutations"),p=d.map(_=>h.put(_));return P.waitFor(p)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:M5});l.createIndex("collectionPathOverlayIndex",k5,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",O5,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:E5});l.createIndex("documentKeyIndex",T5),l.createIndex("collectionGroupIndex",b5)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:R5}).createIndex("sequenceNumberIndex",x5,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:N5}).createIndex("documentKeyIndex",P5,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=cg(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>P.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>P.forEach(a,c=>{Z(c.userId===s.userId);let l=Co(this.serializer,c);return yL(e,s.userId,l).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new De(o),l=function(h){return[0,ln(h)]}(c);s.push(t.get(l).next(d=>d?P.resolve():(h=>t.put({targetId:0,path:ln(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>P.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:A5});let r=t.store("collectionParents"),i=new Vd,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:ln(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new De(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],l)=>{let d=qr(a);return s(d.popLast())}))}oi(e){let t=e.store("targets");return t.J((r,i)=>{let s=vd(i),o=mL(this.serializer,s);return t.put(o)})}_i(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),c=function(h){return h.document?new G(De.fromString(h.document.name).popFirst(5)):h.noDocument?G.fromSegments(h.noDocument.path):h.unknownDocument?G.fromSegments(h.unknownDocument.path):Y()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>P.waitFor(i))}ai(e,t){let r=t.store("mutations"),i=IL(this.serializer),s=new hg(fg.Zr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var l;let d=(l=a.get(c.userId))!==null&&l!==void 0?l:fe();Co(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),P.forEach(a,(c,l)=>{let d=new Tt(l),h=sg.lt(this.serializer,d),p=s.getIndexManager(d),_=lg.lt(d,this.serializer,p,s.referenceDelegate);return new dg(i,_,h,p).recalculateAndSaveOverlaysForDocumentKeys(new Sd(t,Nn.oe),c).next()})})}};function n1(n){n.createObjectStore("targetDocuments",{keyPath:D5}).createIndex("documentTargetsIndex",S5,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",C5,{unique:!0}),n.createObjectStore("targetGlobal")}var LT="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",K0=class n{constructor(e,t,r,i,s,o,a,c,l,d,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=l,this.li=d,this.hi=h,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=p=>Promise.resolve(),!n.D())throw new F(M.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new O0(this,i),this.Ai=t+"main",this.serializer=new rg(c),this.Ri=new _s(this.Ai,this.hi,new G0(this.serializer)),this.$r=new E0,this.Ur=new N0(this.referenceDelegate,this.serializer),this.remoteDocumentCache=IL(this.serializer),this.Gr=new I0,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&ht("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new F(M.FAILED_PRECONDITION,LT);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Nn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>g(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>g(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>km(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Ss(e))return V("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return V("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return _d(e).get("owner").next(t=>P.resolve(this.vi(t)))}Ci(e){return km(e).delete(this.clientId)}Fi(){return g(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Rt(t,"clientMetadata");return r.U().next(i=>{let s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return P.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?P.resolve(!0):_d(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new F(M.FAILED_PRECONDITION,LT);return!1}}return!(!this.networkEnabled||!this.inForeground)||km(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&V("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return g(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Sd(e,Nn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>km(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return lg.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new x0(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return sg.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){V("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===17?V5:c===16?F5:c===15?$b:c===14?A1:c===13?S1:c===12?L5:c===11?D1:void Y()}(this.hi),o;return this.Ri.runTransaction(e,i,s,a=>(o=new Sd(a,this.Qr?this.Qr.next():Nn.oe),t==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw ht(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new F(M.FAILED_PRECONDITION,E1);return r(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return _d(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new F(M.FAILED_PRECONDITION,LT)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return _d(e).put("owner",t)}static D(){return _s.D()}bi(e){let t=_d(e);return t.get("owner").next(r=>this.vi(r)?(V("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):P.resolve())}Mi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ht(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;RI()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return V("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ht("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){ht("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function _d(n){return Rt(n,"owner")}function km(n){return Rt(n,"clientMetadata")}function Jb(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var Q0=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=fe(),i=fe();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Y0=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var pg=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return RI()?8:T1(He())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Y0;return this.Xi(e,t,o).next(a=>{if(s.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(pc()<=me.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",mc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),P.resolve()):(pc()<=me.DEBUG&&V("QueryEngine","Query:",mc(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(pc()<=me.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",mc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,un(t))):P.resolve())}Yi(e,t){if(RO(t))return P.resolve(null);let r=un(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Zm(t,null,"F"),r=un(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=fe(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.ts(t,a);return this.ns(t,l,o,c.readTime)?this.Yi(e,Zm(t,null,"F")):this.rs(e,l,t,c)}))})))}Zi(e,t,r,i){return RO(t)||i.isEqual(ee.min())?P.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let o=this.ts(t,s);return this.ns(t,o,r,i)?P.resolve(null):(pc()<=me.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),mc(t)),this.rs(e,o,t,w1(i,-1)).next(a=>a))})}ts(e,t){let r=new je($1(e));return t.forEach((i,s)=>{Jd(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return pc()<=me.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",mc(t)),this.Ji.getDocumentsMatchingQuery(e,t,Yn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var J0=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Ke(ae),this._s=new Jr(s=>Mo(s),Qd),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new dg(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function EL(n,e,t,r){return new J0(n,e,t,r)}function TL(n,e){return g(this,null,function*(){let t=W(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=fe();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(l=>({hs:l,removedBatchIds:o,addedBatchIds:a}))})})})}function _8(n,e){let t=W(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let h=l.batch,p=h.keys(),_=P.resolve();return p.forEach(w=>{_=_.next(()=>d.getEntry(c,w)).next(b=>{let R=l.docVersions.get(w);Z(R!==null),b.version.compareTo(R)<0&&(h.applyToRemoteDocument(b,l),b.isValidDocument()&&(b.setReadTime(l.commitVersion),d.addEntry(b)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=fe();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function bL(n){let e=W(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function y8(n,e){let t=W(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((d,h)=>{let p=i.get(h);if(!p)return;a.push(t.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>t.Ur.addMatchingKeys(s,d.addedDocuments,h)));let _=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?_=_.withResumeToken(mt.EMPTY_BYTE_STRING,ee.min()).withLastLimboFreeSnapshotVersion(ee.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(h,_),function(b,R,L){return b.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(p,_,d)&&a.push(t.Ur.updateTargetData(s,_))});let c=En(),l=fe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(CL(s,o,e.documentUpdates).next(d=>{c=d.Ps,l=d.Is})),!r.isEqual(ee.min())){let d=t.Ur.getLastRemoteSnapshotVersion(s).next(h=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return P.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.os=i,s))}function CL(n,e,t){let r=fe(),i=fe();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=En();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(ee.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):V("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function v8(n,e){let t=W(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Pc(n,e){let t=W(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,P.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new xc(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Mc(n,e,t){return g(this,null,function*(){let r=W(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Ss(o))throw o;V("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function mg(n,e,t){let r=W(n),i=ee.min(),s=fe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,d){let h=W(c),p=h._s.get(d);return p!==void 0?P.resolve(h.os.get(p)):h.Ur.getTargetData(l,d)}(r,o,un(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:ee.min(),t?s:fe())).next(a=>(AL(r,B1(e),a),{documents:a,Ts:s})))}function DL(n,e){let t=W(n),r=W(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function SL(n,e){let t=W(n),r=t.us.get(e)||ee.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,w1(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(AL(t,e,i),i))}function AL(n,e,t){let r=n.us.get(e)||ee.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}function w8(n,e,t,r){return g(this,null,function*(){let i=W(n),s=fe(),o=En();for(let l of t){let d=e.Es(l.metadata.name);l.document&&(s=s.add(d));let h=e.ds(l);h.setReadTime(e.As(l.metadata.readTime)),o=o.insert(d,h)}let a=i.cs.newChangeBuffer({trackRemovals:!0}),c=yield Pc(i,function(d){return un(Bc(De.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>CL(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Ur.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Ur.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.Ps,d.Is)).next(()=>d.Ps)))})}function I8(r,i){return g(this,arguments,function*(n,e,t=fe()){let s=yield Pc(n,un(Qb(e.bundledQuery))),o=W(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=pt(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.Gr.saveNamedQuery(a,e);let l=s.withResumeToken(mt.EMPTY_BYTE_STRING,c);return o.os=o.os.insert(l.targetId,l),o.Ur.updateTargetData(a,l).next(()=>o.Ur.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Ur.addMatchingKeys(a,t,s.targetId)).next(()=>o.Gr.saveNamedQuery(a,e))})})}function r1(n,e){return`firestore_clients_${n}_${e}`}function i1(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function FT(n,e){return`firestore_targets_${n}_${e}`}var gg=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new F(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(ht("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Td=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new F(r.error.code,r.error.message))),s?new n(e,r.state,i):(ht("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},_g=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Wb();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=b1(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(ht("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},X0=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ht("SharedClientState",`Failed to parse online state: ${e}`),null)}},jd=class{constructor(){this.activeTargetIds=Wb()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},bd=class{constructor(e,t,r,i,s){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Ke(ae),this.started=!1,this.bs=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=r1(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new jd),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Qi();for(let r of e){if(r===this.ps)continue;let i=this.getItem(r1(this.persistenceKey,r));if(i){let s=_g.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let r=this.Ls(t);r&&this.Bs(r)}for(let r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(FT(this.persistenceKey,e));if(r){let i=Td.Rs(e,r);i&&(t=i.state)}}return this.Ks.fs(e),this.Ns(),t}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(FT(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return V("SharedClientState","READ",e,t),t}setItem(e,t){V("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){V("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(V("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void ht("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Gs(t.key);return this.zs(r,null)}{let r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){let r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){let r=function(s){let o=Nn.oe;if(s!=null)try{let a=JSON.parse(s);Z(typeof a=="number"),o=a}catch(a){ht("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Nn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){let r=this.Xs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){let i=new gg(this.currentUser,e,t,r),s=i1(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){let t=i1(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){let i=FT(this.persistenceKey,e),s=new Td(e,t,r);this.setItem(i,s.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let r=this.Gs(e);return _g.Rs(r,t)}Hs(e,t){let r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return gg.Rs(new Tt(s),i,t)}Ys(e,t){let r=this.Ms.exec(e),i=Number(r[1]);return Td.Rs(i,t)}Ls(e){return X0.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);V("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Wb();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},yg=class{constructor(){this.so=new jd,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new jd,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Z0=class{_o(e){}shutdown(){}};var vg=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){V("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){V("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Om=null;function VT(){return Om===null?Om=function(){return 268435456+Math.round(2147483648*Math.random())}():Om++,"0x"+Om.toString(16)}var E8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var eb=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Jt="WebChannelConnection",tb=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){let a=VT(),c=this.xo(t,r.toUriEncodedString());V("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,o),this.No(t,c,l,i).then(d=>(V("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Qn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}Lo(t,r,i,s,o,a){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+jc}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){let i=E8[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=VT();return new Promise((o,a)=>{let c=new RT;c.setWithCredentials(!0),c.listenOnce(NT.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case fd.NO_ERROR:let d=c.getResponseJson();V(Jt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case fd.TIMEOUT:V(Jt,`RPC '${e}' ${s} timed out`),a(new F(M.DEADLINE_EXCEEDED,"Request time out"));break;case fd.HTTP_ERROR:let h=c.getStatus();if(V(Jt,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);let _=p?.error;if(_&&_.status&&_.message){let w=function(R){let L=R.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(L)>=0?L:M.UNKNOWN}(_.status);a(new F(w,_.message))}else a(new F(M.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new F(M.UNAVAILABLE,"Connection failed."));break;default:Y()}}finally{V(Jt,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);V(Jt,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=VT(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=kT(),a=MT(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new xT({})),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");V(Jt,`Creating RPC '${e}' stream ${i}: ${d}`,c);let h=o.createWebChannel(d,c),p=!1,_=!1,w=new eb({Io:R=>{_?V(Jt,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(p||(V(Jt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),V(Jt,`RPC '${e}' stream ${i} sending:`,R),h.send(R))},To:()=>h.close()}),b=(R,L,H)=>{R.listen(L,U=>{try{H(U)}catch(Q){setTimeout(()=>{throw Q},0)}})};return b(h,lc.EventType.OPEN,()=>{_||(V(Jt,`RPC '${e}' stream ${i} transport opened.`),w.yo())}),b(h,lc.EventType.CLOSE,()=>{_||(_=!0,V(Jt,`RPC '${e}' stream ${i} transport closed`),w.So())}),b(h,lc.EventType.ERROR,R=>{_||(_=!0,Qn(Jt,`RPC '${e}' stream ${i} transport errored:`,R),w.So(new F(M.UNAVAILABLE,"The operation could not be completed")))}),b(h,lc.EventType.MESSAGE,R=>{var L;if(!_){let H=R.data[0];Z(!!H);let U=H,Q=U.error||((L=U[0])===null||L===void 0?void 0:L.error);if(Q){V(Jt,`RPC '${e}' stream ${i} received error:`,Q);let ie=Q.status,J=function(I){let C=It[I];if(C!==void 0)return tL(C)}(ie),T=Q.message;J===void 0&&(J=M.INTERNAL,T="Unknown error status: "+ie+" with message "+Q.message),_=!0,w.So(new F(J,T)),h.close()}else V(Jt,`RPC '${e}' stream ${i} received:`,H),w.bo(H)}}),b(a,PT.STAT_EVENT,R=>{R.stat===Nm.PROXY?V(Jt,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Nm.NOPROXY&&V(Jt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.wo()},0),w}};function RL(){return typeof window<"u"?window:null}function jm(){return typeof document<"u"?document:null}function Xd(n){return new g0(n,!0)}var Bd=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var wg=class{constructor(e,t,r,i,s,o,a,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Bd(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return g(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return g(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return g(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===M.RESOURCE_EXHAUSTED?(ht(t.toString()),ht("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===M.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new F(M.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>g(this,null,function*(){this.state=0,this.start()}))}I_(e){return V("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(V("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},nb=class extends wg{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=o8(this.serializer,e),r=function(s){if(!("targetChange"in s))return ee.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?ee.min():o.readTime?pt(o.readTime):ee.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=v0(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=Jm(c)?{documents:lL(s,c)}:{query:uL(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=rL(s,o.resumeToken);let l=_0(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(ee.min())>0){a.readTime=Rc(s,o.snapshotVersion.toTimestamp());let l=_0(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=c8(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=v0(this.serializer),t.removeTarget=e,this.a_(t)}},rb=class extends wg{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Z(!!e.streamToken),this.lastStreamToken=e.streamToken,Z(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=a8(e.writeResults,e.commitTime),r=pt(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=v0(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Fd(this.serializer,r))};this.a_(t)}};var ib=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new F(M.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,y0(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new F(M.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,y0(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new F(M.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},sb=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ht(t),this.D_=!1):V("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var ob=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(()=>g(this,null,function*(){As(this)&&(V("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let l=W(c);l.L_.add(4),yield $c(l),l.q_.set("Unknown"),l.L_.delete(4),yield Zd(l)})}(this))}))}),this.q_=new sb(r,i)}};function Zd(n){return g(this,null,function*(){if(As(n))for(let e of n.B_)yield e(!0)})}function $c(n){return g(this,null,function*(){for(let e of n.B_)yield e(!1)})}function jg(n,e){let t=W(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),eC(t)?Zb(t):qc(t).r_()&&Xb(t,e))}function kc(n,e){let t=W(n),r=qc(t);t.N_.delete(e),r.r_()&&xL(t,e),t.N_.size===0&&(r.r_()?r.o_():As(t)&&t.q_.set("Unknown"))}function Xb(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ee.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}qc(n).A_(e)}function xL(n,e){n.Q_.xe(e),qc(n).R_(e)}function Zb(n){n.Q_=new m0({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),qc(n).start(),n.q_.v_()}function eC(n){return As(n)&&!qc(n).n_()&&n.N_.size>0}function As(n){return W(n).L_.size===0}function NL(n){n.Q_=void 0}function T8(n){return g(this,null,function*(){n.q_.set("Online")})}function b8(n){return g(this,null,function*(){n.N_.forEach((e,t)=>{Xb(n,e)})})}function C8(n,e){return g(this,null,function*(){NL(n),eC(n)?(n.q_.M_(e),Zb(n)):n.q_.set("Unknown")})}function D8(n,e,t){return g(this,null,function*(){if(n.q_.set("Online"),e instanceof tg&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){V("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Ig(n,r)}else if(e instanceof Ec?n.Q_.Ke(e):e instanceof eg?n.Q_.He(e):n.Q_.We(e),!t.isEqual(ee.min()))try{let r=yield bL(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.Q_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.N_.get(l);d&&s.N_.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.N_.get(c);if(!d)return;s.N_.set(c,d.withResumeToken(mt.EMPTY_BYTE_STRING,d.snapshotVersion)),xL(s,c);let h=new xc(d.target,c,l,d.sequenceNumber);Xb(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){V("RemoteStore","Failed to raise snapshot:",r),yield Ig(n,r)}})}function Ig(n,e,t){return g(this,null,function*(){if(!Ss(e))throw e;n.L_.add(1),yield $c(n),n.q_.set("Offline"),t||(t=()=>bL(n.localStore)),n.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){V("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Zd(n)}))})}function PL(n,e){return e().catch(t=>Ig(n,t,e))}function Hc(n){return g(this,null,function*(){let e=W(n),t=Cs(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;S8(e);)try{let i=yield v8(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,A8(e,i)}catch(i){yield Ig(e,i)}ML(e)&&kL(e)})}function S8(n){return As(n)&&n.O_.length<10}function A8(n,e){n.O_.push(e);let t=Cs(n);t.r_()&&t.V_&&t.m_(e.mutations)}function ML(n){return As(n)&&!Cs(n).n_()&&n.O_.length>0}function kL(n){Cs(n).start()}function R8(n){return g(this,null,function*(){Cs(n).p_()})}function x8(n){return g(this,null,function*(){let e=Cs(n);for(let t of n.O_)e.m_(t.mutations)})}function N8(n,e,t){return g(this,null,function*(){let r=n.O_.shift(),i=h0.from(r,e,t);yield PL(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Hc(n)})}function P8(n,e){return g(this,null,function*(){e&&Cs(n).V_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return eL(o)&&o!==M.ABORTED}(i.code)){let s=r.O_.shift();Cs(r).s_(),yield PL(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Hc(r)}})}(n,e)),ML(n)&&kL(n)})}function s1(n,e){return g(this,null,function*(){let t=W(n);t.asyncQueue.verifyOperationInProgress(),V("RemoteStore","RemoteStore received new credentials");let r=As(t);t.L_.add(3),yield $c(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Zd(t)})}function ab(n,e){return g(this,null,function*(){let t=W(n);e?(t.L_.delete(2),yield Zd(t)):e||(t.L_.add(2),yield $c(t),t.q_.set("Unknown"))})}function qc(n){return n.K_||(n.K_=function(t,r,i){let s=W(t);return s.w_(),new nb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:T8.bind(null,n),Ro:b8.bind(null,n),mo:C8.bind(null,n),d_:D8.bind(null,n)}),n.B_.push(e=>g(this,null,function*(){e?(n.K_.s_(),eC(n)?Zb(n):n.q_.set("Unknown")):(yield n.K_.stop(),NL(n))}))),n.K_}function Cs(n){return n.U_||(n.U_=function(t,r,i){let s=W(t);return s.w_(),new rb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:R8.bind(null,n),mo:P8.bind(null,n),f_:x8.bind(null,n),g_:N8.bind(null,n)}),n.B_.push(e=>g(this,null,function*(){e?(n.U_.s_(),yield Hc(n)):(yield n.U_.stop(),n.O_.length>0&&(V("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var cb=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new bt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function zc(n,e){if(ht("AsyncQueue",`${e}: ${n}`),Ss(n))return new F(M.UNAVAILABLE,`${e}: ${n}`);throw n}var Eg=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||G.comparator(t.key,r.key):(t,r)=>G.comparator(t.key,r.key),this.keyedMap=yd(),this.sortedSet=new Ke(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Tg=class{constructor(){this.W_=new Ke(G.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Y():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},Oc=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,Eg.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var lb=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},ub=class{constructor(){this.queries=o1(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=W(t),s=i.queries;i.queries=o1(),s.forEach((o,a)=>{for(let c of a.j_)c.onError(r)})})(this,new F(M.ABORTED,"Firestore shutting down"))}};function o1(){return new Jr(n=>j1(n),Yd)}function tC(n,e){return g(this,null,function*(){let t=W(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new lb,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=zc(o,`Initialization of query '${mc(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&rC(t)})}function nC(n,e){return g(this,null,function*(){let t=W(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function M8(n,e){let t=W(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&rC(t)}function k8(n,e,t){let r=W(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function rC(n){n.Y_.forEach(e=>{e.next()})}var db,a1;(a1=db||(db={})).ea="default",a1.Cache="cache";var $d=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Oc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Oc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==db.Cache}};var hb=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var bg=class{constructor(e){this.serializer=e}Es(e){return Gr(this.serializer,e)}ds(e){return e.metadata.exists?cL(this.serializer,e.document,!1):Ct.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return pt(e)}},fb=class{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=OL(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let r=De.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,r=new bg(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Es(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||fe()).add(s);t.set(o,a)}}return t}complete(){return g(this,null,function*(){let e=yield w8(this.localStore,new bg(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let r of this.queries)yield I8(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function OL(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Cg=class{constructor(e){this.key=e}},Dg=class{constructor(e){this.key=e}},Sg=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=fe(),this.mutatedKeys=fe(),this.Aa=$1(e),this.Ra=new Eg(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Tg,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let p=i.get(d),_=Jd(this.query,h)?h:null,w=!!p&&this.mutatedKeys.has(p.key),b=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),R=!1;p&&_?p.data.isEqual(_.data)?w!==b&&(r.track({type:3,doc:_}),R=!0):this.ga(p,_)||(r.track({type:2,doc:_}),R=!0,(c&&this.Aa(_,c)>0||l&&this.Aa(_,l)<0)&&(a=!0)):!p&&_?(r.track({type:0,doc:_}),R=!0):p&&!_&&(r.track({type:1,doc:p}),R=!0,(c||l)&&(a=!0)),R&&(_?(o=o.add(_),s=b?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((d,h)=>function(_,w){let b=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Y()}};return b(_)-b(w)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,o.length!==0||l?{snapshot:new Oc(this.query,e.Ra,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Tg,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=fe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Dg(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Cg(r))}),t}ba(e){this.Ta=e.Ts,this.da=fe();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Oc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},pb=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},mb=class{constructor(e){this.key=e,this.va=!1}},gb=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Jr(a=>j1(a),Yd),this.Ma=new Map,this.xa=new Set,this.Oa=new Ke(G.comparator),this.Na=new Map,this.La=new Ud,this.Ba={},this.ka=new Map,this.qa=Nc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function O8(n,e,t=!0){return g(this,null,function*(){let r=Bg(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield LL(r,e,t,!0),i})}function L8(n,e){return g(this,null,function*(){let t=Bg(n);yield LL(t,e,!0,!1)})}function LL(n,e,t,r){return g(this,null,function*(){let i=yield Pc(n.localStore,un(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield iC(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&jg(n.remoteStore,i),a})}function iC(n,e,t,r,i){return g(this,null,function*(){n.Ka=(h,p,_)=>function(b,R,L,H){return g(this,null,function*(){let U=R.view.ma(L);U.ns&&(U=yield mg(b.localStore,R.query,!1).then(({documents:T})=>R.view.ma(T,U)));let Q=H&&H.targetChanges.get(R.targetId),ie=H&&H.targetMismatches.get(R.targetId)!=null,J=R.view.applyChanges(U,b.isPrimaryClient,Q,ie);return _b(b,R.targetId,J.wa),J.snapshot})}(n,h,p,_);let s=yield mg(n.localStore,e,!0),o=new Sg(e,s.Ts),a=o.ma(s.documents),c=Od.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);_b(n,t,l.wa);let d=new pb(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function F8(n,e,t){return g(this,null,function*(){let r=W(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Yd(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Mc(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&kc(r.remoteStore,i.targetId),Lc(r,i.targetId)}).catch(Ds))):(Lc(r,i.targetId),yield Mc(r.localStore,i.targetId,!0))})}function V8(n,e){return g(this,null,function*(){let t=W(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),kc(t.remoteStore,r.targetId))})}function U8(n,e,t){return g(this,null,function*(){let r=cC(n);try{let i=yield function(o,a){let c=W(o),l=et.now(),d=a.reduce((_,w)=>_.add(w.key),fe()),h,p;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let w=En(),b=fe();return c.cs.getEntries(_,d).next(R=>{w=R,w.forEach((L,H)=>{H.isValidDocument()||(b=b.add(L))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,w)).next(R=>{h=R;let L=[];for(let H of a){let U=Z5(H,h.get(H.key).overlayedDocument);U!=null&&L.push(new _r(H.key,U,M1(U.value.mapValue),lt.exists(!0)))}return c.mutationQueue.addMutationBatch(_,l,L,a)}).next(R=>{p=R;let L=R.applyToLocalDocumentSet(h,b);return c.documentOverlayCache.saveOverlays(_,R.batchId,L)})}).then(()=>({batchId:p.batchId,changes:q1(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.Ba[o.currentUser.toKey()];l||(l=new Ke(ae)),l=l.insert(a,c),o.Ba[o.currentUser.toKey()]=l}(r,i.batchId,t),yield Pi(r,i.changes),yield Hc(r.remoteStore)}catch(i){let s=zc(i,"Failed to persist write");t.reject(s)}})}function FL(n,e){return g(this,null,function*(){let t=W(n);try{let r=yield y8(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Na.get(s);o&&(Z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Z(o.va):i.removedDocuments.size>0&&(Z(o.va),o.va=!1))}),yield Pi(t,r,e)}catch(r){yield Ds(r)}})}function c1(n,e,t){let r=W(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,o)=>{let a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=W(o);c.onlineState=a;let l=!1;c.queries.forEach((d,h)=>{for(let p of h.j_)p.Z_(a)&&(l=!0)}),l&&rC(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function j8(n,e,t){return g(this,null,function*(){let r=W(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let o=new Ke(G.comparator);o=o.insert(s,Ct.newNoDocument(s,ee.min()));let a=fe().add(s),c=new kd(ee.min(),new Map,new Ke(ae),o,a);yield FL(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),aC(r)}else yield Mc(r.localStore,e,!1).then(()=>Lc(r,e,t)).catch(Ds)})}function B8(n,e){return g(this,null,function*(){let t=W(n),r=e.batch.batchId;try{let i=yield _8(t.localStore,e);oC(t,r,null),sC(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Pi(t,i)}catch(i){yield Ds(i)}})}function $8(n,e,t){return g(this,null,function*(){let r=W(n);try{let i=yield function(o,a){let c=W(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(Z(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);oC(r,e,t),sC(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Pi(r,i)}catch(i){yield Ds(i)}})}function H8(n,e){return g(this,null,function*(){let t=W(n);As(t.remoteStore)||V("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=W(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){let i=zc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function sC(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function oC(n,e,t){let r=W(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Lc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||VL(n,r)})}function VL(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(kc(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),aC(n))}function _b(n,e,t){for(let r of t)r instanceof Cg?(n.La.addReference(r.key,e),q8(n,r)):r instanceof Dg?(V("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||VL(n,r.key)):Y()}function q8(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(V("SyncEngine","New document in limbo: "+t),n.xa.add(r),aC(n))}function aC(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new G(De.fromString(e)),r=n.qa.next();n.Na.set(r,new mb(t)),n.Oa=n.Oa.insert(t,r),jg(n.remoteStore,new xc(un(Bc(t.path)),r,"TargetPurposeLimboResolution",Nn.oe))}}function Pi(n,e,t){return g(this,null,function*(){let r=W(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{o.push(r.Ka(c,e,t).then(l=>{var d;if((l||t)&&r.isPrimaryClient){let h=l?!l.fromCache:(d=t?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(l){i.push(l);let h=Q0.Wi(c.targetId,l);s.push(h)}}))}),yield Promise.all(o),r.Ca.d_(i),yield function(c,l){return g(this,null,function*(){let d=W(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>P.forEach(l,p=>P.forEach(p.$i,_=>d.persistence.referenceDelegate.addReference(h,p.targetId,_)).next(()=>P.forEach(p.Ui,_=>d.persistence.referenceDelegate.removeReference(h,p.targetId,_)))))}catch(h){if(!Ss(h))throw h;V("LocalStore","Failed to update sequence numbers: "+h)}for(let h of l){let p=h.targetId;if(!h.fromCache){let _=d.os.get(p),w=_.snapshotVersion,b=_.withLastLimboFreeSnapshotVersion(w);d.os=d.os.insert(p,b)}}})}(r.localStore,s))})}function z8(n,e){return g(this,null,function*(){let t=W(n);if(!t.currentUser.isEqual(e)){V("SyncEngine","User change. New user:",e.toKey());let r=yield TL(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(c=>{c.reject(new F(M.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Pi(t,r.hs)}})}function W8(n,e){let t=W(n),r=t.Na.get(e);if(r&&r.va)return fe().add(r.key);{let i=fe(),s=t.Ma.get(e);if(!s)return i;for(let o of s){let a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function G8(n,e){return g(this,null,function*(){let t=W(n),r=yield mg(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&_b(t,e.targetId,i.wa),i})}function K8(n,e){return g(this,null,function*(){let t=W(n);return SL(t.localStore,e).then(r=>Pi(t,r))})}function Q8(n,e,t,r){return g(this,null,function*(){let i=W(n),s=yield function(a,c){let l=W(a),d=W(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.Mn(h,c).next(p=>p?l.localDocuments.getDocuments(h,p):P.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield Hc(i.remoteStore):t==="acknowledged"||t==="rejected"?(oC(i,e,r||null),sC(i,e),function(a,c){W(W(a).mutationQueue).On(c)}(i.localStore,e)):Y(),yield Pi(i,s)):V("SyncEngine","Cannot apply mutation batch with id: "+e)})}function Y8(n,e){return g(this,null,function*(){let t=W(n);if(Bg(t),cC(t),e===!0&&t.Qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield l1(t,r.toArray());t.Qa=!0,yield ab(t.remoteStore,!0);for(let s of i)jg(t.remoteStore,s)}else if(e===!1&&t.Qa!==!1){let r=[],i=Promise.resolve();t.Ma.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Lc(t,o),Mc(t.localStore,o,!0))),kc(t.remoteStore,o)}),yield i,yield l1(t,r),function(o){let a=W(o);a.Na.forEach((c,l)=>{kc(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new Ke(G.comparator)}(t),t.Qa=!1,yield ab(t.remoteStore,!1)}})}function l1(n,e,t){return g(this,null,function*(){let r=W(n),i=[],s=[];for(let o of e){let a,c=r.Ma.get(o);if(c&&c.length!==0){a=yield Pc(r.localStore,un(c[0]));for(let l of c){let d=r.Fa.get(l),h=yield G8(r,d);h.snapshot&&s.push(h.snapshot)}}else{let l=yield DL(r.localStore,o);a=yield Pc(r.localStore,l),yield iC(r,UL(l),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i})}function UL(n){return U1(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function J8(n){return function(t){return W(W(t).persistence).Qi()}(W(n).localStore)}function X8(n,e,t,r){return g(this,null,function*(){let i=W(n);if(i.Qa)return void V("SyncEngine","Ignoring unexpected query state notification.");let s=i.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield SL(i.localStore,B1(s[0])),a=kd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",mt.EMPTY_BYTE_STRING);yield Pi(i,o,a);break}case"rejected":yield Mc(i.localStore,e,!0),Lc(i,e,r);break;default:Y()}})}function Z8(n,e,t){return g(this,null,function*(){let r=Bg(n);if(r.Qa){for(let i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){V("SyncEngine","Adding an already active target "+i);continue}let s=yield DL(r.localStore,i),o=yield Pc(r.localStore,s);yield iC(r,UL(s),o.targetId,!1,o.resumeToken),jg(r.remoteStore,o)}for(let i of t)r.Ma.has(i)&&(yield Mc(r.localStore,i,!1).then(()=>{kc(r.remoteStore,i),Lc(r,i)}).catch(Ds))}})}function Bg(n){let e=W(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=FL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=W8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=j8.bind(null,e),e.Ca.d_=M8.bind(null,e.eventManager),e.Ca.$a=k8.bind(null,e.eventManager),e}function cC(n){let e=W(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=B8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$8.bind(null,e),e}function eK(n,e,t){let r=W(n);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(_,w){let b=W(_),R=pt(w.createTime);return b.persistence.runTransaction("hasNewerBundle","readonly",L=>b.Gr.getBundleMetadata(L,w.id)).then(L=>!!L&&L.createTime.compareTo(R)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(OL(c));let l=new fb(c,s.localStore,o.serializer),d=yield o.Ua();for(;d;){let p=yield l.la(d);p&&a._updateProgress(p),d=yield o.Ua()}let h=yield l.complete();return yield Pi(s,h.Ia,void 0),yield function(_,w){let b=W(_);return b.persistence.runTransaction("Save bundle","readwrite",R=>b.Gr.saveBundleMetadata(R,w))}(s.localStore,c),a._completeWith(h.progress),Promise.resolve(h.Pa)}catch(c){return Qn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Hd=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=Xd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return EL(this.persistence,new pg,e.initialUser,this.serializer)}createPersistence(e){return new hg(fg.Zr,this.serializer)}createSharedClientState(e){return new yg}terminate(){return g(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Ag=class n extends Hd{constructor(e,t,r){super(),this.Wa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield Tr(n.prototype,this,"initialize").call(this,e),yield this.Wa.initialize(this,e),yield cC(this.Wa.syncEngine),yield Hc(this.Wa.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return EL(this.persistence,new pg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new M0(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new YT(t,this.persistence);return new QT(e.asyncQueue,r)}createPersistence(e){let t=Jb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Kn.withCacheSize(this.cacheSizeBytes):Kn.DEFAULT;return new K0(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,RL(),jm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new yg}},yb=class n extends Ag{constructor(e,t){super(e,t,!1),this.Wa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield Tr(n.prototype,this,"initialize").call(this,e);let t=this.Wa.syncEngine;this.sharedClientState instanceof bd&&(this.sharedClientState.syncEngine={no:Q8.bind(null,t),ro:X8.bind(null,t),io:Z8.bind(null,t),Qi:J8.bind(null,t),eo:K8.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(r=>g(this,null,function*(){yield Y8(this.Wa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=RL();if(!bd.D(t))throw new F(M.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=Jb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new bd(t,e.asyncQueue,r,e.clientId,e.initialUser)}},qd=class{initialize(e,t){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>c1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=z8.bind(null,this.syncEngine),yield ab(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new ub}()}createDatastore(e){let t=Xd(e.databaseInfo.databaseId),r=function(s){return new tb(s)}(e.databaseInfo);return function(s,o,a,c){return new ib(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new ob(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>c1(this.syncEngine,t,0),function(){return vg.D()?new vg:new Z0}())}createSyncEngine(e,t){return function(i,s,o,a,c,l,d){let h=new gb(i,s,o,a,c,l);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return g(this,null,function*(){var e,t;yield function(i){return g(this,null,function*(){let s=W(i);V("RemoteStore","RemoteStore shutting down."),s.L_.add(5),yield $c(s),s.k_.shutdown(),s.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};function u1(n,e=10240){let t=0;return{read(){return g(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Fc=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):ht("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var vb=class{constructor(e,t){this.ja=e,this.serializer=t,this.metadata=new bt,this.buffer=new Uint8Array,this.Ha=function(){return new TextDecoder("utf-8")}(),this.Ja().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.ja.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}Ua(){return g(this,null,function*(){return yield this.getMetadata(),this.Ja()})}Ja(){return g(this,null,function*(){let e=yield this.Ya();if(e===null)return null;let t=this.Ha.decode(e),r=Number(t);isNaN(r)&&this.Za(`length string (${t}) is not valid number`);let i=yield this.Xa(r);return new hb(JSON.parse(i),e.length+r)})}eu(){return this.buffer.findIndex(e=>e===123)}Ya(){return g(this,null,function*(){for(;this.eu()<0&&!(yield this.tu()););if(this.buffer.length===0)return null;let e=this.eu();e<0&&this.Za("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Xa(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.tu())&&this.Za("Reached the end of bundle when more is expected.");let t=this.Ha.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}Za(e){throw this.ja.cancel(),new Error(`Invalid bundle format: ${e}`)}tu(){return g(this,null,function*(){let e=yield this.ja.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var wb=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new F(M.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return g(this,null,function*(){let o=W(i),a={documents:s.map(h=>Ld(o.serializer,h))},c=yield o.Lo("BatchGetDocuments",o.serializer.databaseId,De.emptyPath(),a,s.length),l=new Map;c.forEach(h=>{let p=s8(o.serializer,h);l.set(p.key.toString(),p)});let d=[];return s.forEach(h=>{let p=l.get(h.toString());Z(!!p),d.push(p)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new bs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=G.fromPath(r);this.mutations.push(new Nd(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=W(r),o={writes:i.map(a=>Fd(s.serializer,a))};yield s.Mo("Commit",s.serializer.databaseId,De.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Y();t=ee.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new F(M.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ee.min())?lt.exists(!1):lt.updateTime(t):lt.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ee.min()))throw new F(M.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return lt.updateTime(t)}return lt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var Ib=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.nu=r.maxAttempts,this.t_=new Bd(this.asyncQueue,"transaction_retry")}ru(){this.nu-=1,this.iu()}iu(){this.t_.Go(()=>g(this,null,function*(){let e=new wb(this.datastore),t=this.su(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ou(i)}))}).catch(r=>{this.ou(r)})}))}su(e){try{let t=this.updateFunction(e);return!Kd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ou(e){this.nu>0&&this._u(e)?(this.nu-=1,this.asyncQueue.enqueueAndForget(()=>(this.iu(),Promise.resolve()))):this.deferred.reject(e)}_u(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!eL(t)}return!1}};var Eb=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Tt.UNAUTHENTICATED,this.clientId=Hm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){V("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(V("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new F(M.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new bt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=zc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Bm(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),V("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield TL(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Tb(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield lC(n);V("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>s1(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>s1(e.remoteStore,i)),n._onlineComponents=e})}function jL(n){return n.name==="FirebaseError"?n.code===M.FAILED_PRECONDITION||n.code===M.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function lC(n){return g(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Bm(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!jL(t))throw t;Qn("Error using user provided cache. Falling back to memory cache: "+t),yield Bm(n,new Hd)}}else V("FirestoreClient","Using default OfflineComponentProvider"),yield Bm(n,new Hd);return n._offlineComponents})}function $g(n){return g(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(V("FirestoreClient","Using user provided OnlineComponentProvider"),yield Tb(n,n._uninitializedComponentsProvider._online)):(V("FirestoreClient","Using default OnlineComponentProvider"),yield Tb(n,new qd))),n._onlineComponents})}function BL(n){return lC(n).then(e=>e.persistence)}function uC(n){return lC(n).then(e=>e.localStore)}function $L(n){return $g(n).then(e=>e.remoteStore)}function dC(n){return $g(n).then(e=>e.syncEngine)}function tK(n){return $g(n).then(e=>e.datastore)}function Vc(n){return g(this,null,function*(){let e=yield $g(n),t=e.eventManager;return t.onListen=O8.bind(null,e.syncEngine),t.onUnlisten=F8.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=L8.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=V8.bind(null,e.syncEngine),t})}function nK(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield BL(n),t=yield $L(n);return e.setNetworkEnabled(!0),function(i){let s=W(i);return s.L_.delete(0),Zd(s)}(t)}))}function rK(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield BL(n),t=yield $L(n);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=W(i);s.L_.add(0),yield $c(s),s.q_.set("Offline")})}(t)}))}function iK(n,e){let t=new bt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(l,d){let h=W(l);return h.persistence.runTransaction("read document","readonly",p=>h.localDocuments.getDocument(p,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new F(M.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=zc(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield uC(n),e,t)})),t.promise}function HL(n,e,t={}){let r=new bt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new Fc({next:p=>{o.enqueueAndForget(()=>nC(s,h));let _=p.docs.has(a);!_&&p.fromCache?l.reject(new F(M.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&p.fromCache&&c&&c.source==="server"?l.reject(new F(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new $d(Bc(a.path),d,{includeMetadataChanges:!0,_a:!0});return tC(s,h)}(yield Vc(n),n.asyncQueue,e,t,r)})),r.promise}function sK(n,e){let t=new bt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield mg(i,s,!0),c=new Sg(s,a.Ts),l=c.ma(a.documents),d=c.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let c=zc(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield uC(n),e,t)})),t.promise}function qL(n,e,t={}){let r=new bt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new Fc({next:p=>{o.enqueueAndForget(()=>nC(s,h)),p.fromCache&&c.source==="server"?l.reject(new F(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new $d(a,d,{includeMetadataChanges:!0,_a:!0});return tC(s,h)}(yield Vc(n),n.asyncQueue,e,t,r)})),r.promise}function oK(n,e){let t=new Fc(e);return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){W(i).Y_.add(s),s.next()}(yield Vc(n),t)})),()=>{t.za(),n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){W(i).Y_.delete(s)}(yield Vc(n),t)}))}}function aK(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?nL().encode(o):o,function(d,h){return new vb(d,h)}(function(d,h){if(d instanceof Uint8Array)return u1(d,h);if(d instanceof ArrayBuffer)return u1(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,Xd(e));n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){eK(yield dC(n),i,r)}))}function cK(n,e){return n.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=W(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Gr.getNamedQuery(o,i))}(yield uC(n),e)}))}function zL(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var d1=new Map;function hC(n,e,t){if(!t)throw new F(M.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function fC(n,e,t,r){if(e===!0&&r===!0)throw new F(M.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function h1(n){if(!G.isDocumentKey(n))throw new F(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function f1(n){if(G.isDocumentKey(n))throw new F(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Hg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Y()}function Se(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new F(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Hg(n);throw new F(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function WL(n,e){if(e<=0)throw new F(M.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Rg=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new F(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new F(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}fC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zL((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new F(M.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new F(M.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new F(M.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Fo=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Rg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new F(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new F(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Rg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new UT;switch(r.type){case"firstParty":return new HT(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new F(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=d1.get(t);r&&(V("ComponentProvider","Removing Datastore"),d1.delete(t),r.terminate())}(this),Promise.resolve()}};function GL(n,e,t,r={}){var i;let s=(n=Se(n,Fo))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Qn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Tt.MOCK_USER;else{a=Ga(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new F(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Tt(l)}n._authCredentials=new jT(new $m(a,c))}}var jt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},qe=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Kr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Kr=class n extends jt{constructor(e,t,r){super(e,t,Bc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new qe(this.firestore,null,new G(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function pC(n,e,...t){if(n=z(n),hC("collection","path",e),n instanceof Fo){let r=De.fromString(e,...t);return f1(r),new Kr(n,null,r)}{if(!(n instanceof qe||n instanceof Kr))throw new F(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(De.fromString(e,...t));return f1(r),new Kr(n.firestore,null,r)}}function KL(n,e){if(n=Se(n,Fo),hC("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new F(M.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new jt(n,null,function(r){return new gr(De.emptyPath(),r)}(e))}function eh(n,e,...t){if(n=z(n),arguments.length===1&&(e=Hm.newId()),hC("doc","path",e),n instanceof Fo){let r=De.fromString(e,...t);return h1(r),new qe(n,null,new G(r))}{if(!(n instanceof qe||n instanceof Kr))throw new F(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(De.fromString(e,...t));return h1(r),new qe(n.firestore,n instanceof Kr?n.converter:null,new G(r))}}function mC(n,e){return n=z(n),e=z(e),(n instanceof qe||n instanceof Kr)&&(e instanceof qe||e instanceof Kr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function gC(n,e){return n=z(n),e=z(e),n instanceof jt&&e instanceof jt&&n.firestore===e.firestore&&Yd(n._query,e._query)&&n.converter===e.converter}var bb=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new Bd(this,"async_queue_retry"),this.Eu=()=>{let t=jm();t&&V("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=jm();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=jm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new bt;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return g(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!Ss(e))throw e;V("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw ht("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=cb.createAndSchedule(this,e,t,r,s=>this.Vu(s));return this.lu.push(i),i}du(){this.hu&&Y()}verifyOperationInProgress(){}mu(){return g(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function Cb(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var Db=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new bt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var QL=-1,Ye=class extends Fo{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new bb}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||YL(this),this._firestoreClient.terminate()}};function xt(n){return n._firestoreClient||YL(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function YL(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,l,d){return new JT(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,zL(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new Eb(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function JL(n,e){oF(n=Se(n,Ye));let t=xt(n);if(t._uninitializedComponentsProvider)throw new F(M.FAILED_PRECONDITION,"SDK cache is already specified.");Qn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new qd;return ZL(t,i,new Ag(i,r.cacheSizeBytes,e?.forceOwnership))}function XL(n){oF(n=Se(n,Ye));let e=xt(n);if(e._uninitializedComponentsProvider)throw new F(M.FAILED_PRECONDITION,"SDK cache is already specified.");Qn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new qd;return ZL(e,r,new yb(r,t.cacheSizeBytes))}function ZL(n,e,t){let r=new bt;return n.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield Bm(n,t),yield Tb(n,e),r.resolve()}catch(i){let s=i;if(!jL(s))throw s;Qn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function eF(n){if(n._initialized&&!n._terminated)throw new F(M.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new bt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!_s.D())return Promise.resolve();let i=r+"main";yield _s.delete(i)})}(Jb(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function tF(n){return function(t){let r=new bt;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return H8(yield dC(t),r)})),r.promise}(xt(n=Se(n,Ye)))}function nF(n){return nK(xt(n=Se(n,Ye)))}function rF(n){return rK(xt(n=Se(n,Ye)))}function iF(n,e){let t=xt(n=Se(n,Ye)),r=new Db;return aK(t,n._databaseId,e,r),r}function sF(n,e){return cK(xt(n=Se(n,Ye)),e).then(t=>t?new jt(n,null,t.query):null)}function oF(n){if(n._initialized||n._terminated)throw new F(M.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Xr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(mt.fromBase64String(e))}catch(t){throw new F(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var yr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ft(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var xi=class{constructor(e){this._methodName=e}};var Vo=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new F(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ae(this._lat,e._lat)||ae(this._long,e._long)}};var zd=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var lK=/^__.*__$/,Sb=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new _r(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ts(e,this.data,t,this.fieldTransforms)}},xg=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new _r(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function aF(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y()}}var Ng=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.yu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return Pg(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(aF(this.wu)&&lK.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},Ab=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Xd(e)}Nu(e,t,r,i=!1){return new Ng({wu:e,methodName:t,Ou:r,path:ft.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function $o(n){let e=n._freezeSettings(),t=Xd(n._databaseId);return new Ab(n._databaseId,!!e.ignoreUndefinedProperties,t)}function qg(n,e,t,r,i,s={}){let o=n.Nu(s.merge||s.mergeFields?2:0,e,t,i);vC("Data must be an object, but it was:",o,r);let a=uF(r,o),c,l;if(s.merge)c=new Pn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let p=Mb(e,h,t);if(!o.contains(p))throw new F(M.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);hF(d,p)||d.push(p)}c=new Pn(d),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new Sb(new Xt(a),c,l)}var Wd=class n extends xi{_toFieldTransform(e){if(e.wu!==2)throw e.wu===1?e.Mu(`${this._methodName}() can only appear at the top level of your update data`):e.Mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function cF(n,e,t){return new Ng({wu:3,Ou:e.settings.Ou,methodName:n._methodName,Du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Rb=class n extends xi{_toFieldTransform(e){return new ko(e.path,new Is)}isEqual(e){return e instanceof n}},xb=class n extends xi{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){let t=cF(this,e,!0),r=this.Lu.map(s=>Ho(s,t)),i=new Ai(r);return new ko(e.path,i)}isEqual(e){return e instanceof n&&es(this.Lu,e.Lu)}},Nb=class n extends xi{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){let t=cF(this,e,!0),r=this.Lu.map(s=>Ho(s,t)),i=new Ri(r);return new ko(e.path,i)}isEqual(e){return e instanceof n&&es(this.Lu,e.Lu)}},Pb=class n extends xi{constructor(e,t){super(e),this.Bu=t}_toFieldTransform(e){let t=new Es(e.serializer,G1(e.serializer,this.Bu));return new ko(e.path,t)}isEqual(e){return e instanceof n&&this.Bu===e.Bu}};function _C(n,e,t,r){let i=n.Nu(1,e,t);vC("Data must be an object, but it was:",i,r);let s=[],o=Xt.empty();Bo(r,(c,l)=>{let d=wC(e,c,t);l=z(l);let h=i.Cu(d);if(l instanceof Wd)s.push(d);else{let p=Ho(l,h);p!=null&&(s.push(d),o.set(d,p))}});let a=new Pn(s);return new xg(o,a,i.fieldTransforms)}function yC(n,e,t,r,i,s){let o=n.Nu(1,e,t),a=[Mb(e,r,t)],c=[i];if(s.length%2!=0)throw new F(M.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(Mb(e,s[p])),c.push(s[p+1]);let l=[],d=Xt.empty();for(let p=a.length-1;p>=0;--p)if(!hF(l,a[p])){let _=a[p],w=c[p];w=z(w);let b=o.Cu(_);if(w instanceof Wd)l.push(_);else{let R=Ho(w,b);R!=null&&(l.push(_),d.set(_,R))}}let h=new Pn(l);return new xg(d,h,o.fieldTransforms)}function lF(n,e,t,r=!1){return Ho(t,n.Nu(r?4:3,e))}function Ho(n,e){if(dF(n=z(n)))return vC("Unsupported field value:",e,n),uF(n,e);if(n instanceof xi)return function(r,i){if(!aF(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=Ho(a,i.Fu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=z(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return G1(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=et.fromDate(r);return{timestampValue:Rc(i.serializer,s)}}if(r instanceof et){let s=new et(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Rc(i.serializer,s)}}if(r instanceof Vo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Xr)return{bytesValue:rL(i.serializer,r._byteString)};if(r instanceof qe){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Kb(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof zd)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Mu("VectorValues must only contain numeric values.");return Gb(a.serializer,c)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${Hg(r)}`)}(n,e)}function uF(n,e){let t={};return R1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Bo(n,(r,i)=>{let s=Ho(i,e.bu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function dF(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof et||n instanceof Vo||n instanceof Xr||n instanceof qe||n instanceof xi||n instanceof zd)}function vC(n,e,t){if(!dF(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Hg(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function Mb(n,e,t){if((e=z(e))instanceof yr)return e._internalPath;if(typeof e=="string")return wC(n,e);throw Pg("Field path arguments must be of type string or ",n,!1,void 0,t)}var uK=new RegExp("[~\\*/\\[\\]]");function wC(n,e,t){if(e.search(uK)>=0)throw Pg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new yr(...e.split("."))._internalPath}catch{throw Pg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Pg(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new F(M.INVALID_ARGUMENT,a+n+c)}function hF(n,e){return n.some(t=>t.isEqual(e))}var Uo=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new qe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new kb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(zg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},kb=class extends Uo{data(){return super.data()}};function zg(n,e){return typeof e=="string"?wC(n,e):e instanceof yr?e._internalPath:e._delegate._internalPath}function fF(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new F(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Gd=class{},jo=class extends Gd{};function Mi(n,e,...t){let r=[];e instanceof Gd&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof Ob).length,a=s.filter(c=>c instanceof Mg).length;if(o>1||o>0&&a>0)throw new F(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Mg=class n extends jo{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return TF(e._query,t),new jt(e.firestore,e.converter,u0(e._query,t))}_parse(e){let t=$o(e.firestore);return function(s,o,a,c,l,d,h){let p;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new F(M.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){m1(h,d);let _=[];for(let w of h)_.push(p1(c,s,w));p={arrayValue:{values:_}}}else p=p1(c,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||m1(h,d),p=lF(a,o,h,d==="in"||d==="not-in");return we.create(l,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function pF(n,e,t){let r=e,i=zg("where",n);return Mg._create(i,r,t)}var Ob=class n extends Gd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Oe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)TF(o,c),o=u0(o,c)}(e._query,t),new jt(e.firestore,e.converter,u0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Lb=class n extends jo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new F(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new F(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Po(s,o)}(e._query,this._field,this._direction);return new jt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new gr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function mF(n,e="asc"){let t=e,r=zg("orderBy",n);return Lb._create(r,t)}var kg=class n extends jo{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new jt(e.firestore,e.converter,Zm(e._query,this._limit,this._limitType))}};function gF(n){return WL("limit",n),kg._create("limit",n,"F")}function _F(n){return WL("limitToLast",n),kg._create("limitToLast",n,"L")}var Og=class n extends jo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=EF(e,this.type,this._docOrFields,this._inclusive);return new jt(e.firestore,e.converter,function(i,s){return new gr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function yF(...n){return Og._create("startAt",n,!0)}function vF(...n){return Og._create("startAfter",n,!1)}var Lg=class n extends jo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=EF(e,this.type,this._docOrFields,this._inclusive);return new jt(e.firestore,e.converter,function(i,s){return new gr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function wF(...n){return Lg._create("endBefore",n,!1)}function IF(...n){return Lg._create("endAt",n,!0)}function EF(n,e,t,r){if(t[0]=z(t[0]),t[0]instanceof Uo)return function(s,o,a,c,l){if(!c)throw new F(M.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of Ic(s))if(h.field.isKeyField())d.push(No(o,c.key));else{let p=c.data.field(h.field);if(Vg(p))throw new F(M.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let _=h.field.canonicalString();throw new F(M.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(p)}return new Yr(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=$o(n.firestore);return function(o,a,c,l,d,h){let p=o.explicitOrderBy;if(d.length>p.length)throw new F(M.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let _=[];for(let w=0;w<d.length;w++){let b=d[w];if(p[w].field.isKeyField()){if(typeof b!="string")throw new F(M.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof b}`);if(!zb(o)&&b.indexOf("/")!==-1)throw new F(M.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${b}' contains a slash.`);let R=o.path.child(De.fromString(b));if(!G.isDocumentKey(R))throw new F(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let L=new G(R);_.push(No(a,L))}else{let R=lF(c,l,b);_.push(R)}}return new Yr(_,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function p1(n,e,t){if(typeof(t=z(t))=="string"){if(t==="")throw new F(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!zb(e)&&t.indexOf("/")!==-1)throw new F(M.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(De.fromString(t));if(!G.isDocumentKey(r))throw new F(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return No(n,new G(r))}if(t instanceof qe)return No(n,t._key);throw new F(M.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hg(t)}.`)}function m1(n,e){if(!Array.isArray(n)||n.length===0)throw new F(M.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function TF(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new F(M.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new F(M.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Uc=class{convertValue(e,t="none"){switch(xo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ys(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Y()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Bo(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Qe(o.doubleValue));return new zd(s)}convertGeoPoint(e){return new Vo(Qe(e.latitude),Qe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Hb(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ad(e));default:return null}}convertTimestamp(e){let t=Si(e);return new et(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=De.fromString(e);Z(pL(r));let i=new vs(r.get(1),r.get(3)),s=new G(r.popFirst(5));return i.isEqual(t)||ht(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Wg(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Fb=class extends Uc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,t)}};var Di=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Jn=class extends Uo{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new ms(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(zg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},ms=class extends Jn{data(e={}){return super.data(e)}},vr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Di(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ms(this._firestore,this._userDataWriter,r.key,r,new Di(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new ms(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Di(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new ms(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Di(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:dK(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function dK(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y()}}function IC(n,e){return n instanceof Jn&&e instanceof Jn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof vr&&e instanceof vr&&n._firestore===e._firestore&&gC(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function bF(n){n=Se(n,qe);let e=Se(n.firestore,Ye);return HL(xt(e),n._key).then(t=>CC(e,n,t))}var Ni=class extends Uc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,t)}};function CF(n){n=Se(n,qe);let e=Se(n.firestore,Ye),t=xt(e),r=new Ni(e);return iK(t,n._key).then(i=>new Jn(e,r,n._key,i,new Di(i!==null&&i.hasLocalMutations,!0),n.converter))}function DF(n){n=Se(n,qe);let e=Se(n.firestore,Ye);return HL(xt(e),n._key,{source:"server"}).then(t=>CC(e,n,t))}function SF(n){n=Se(n,jt);let e=Se(n.firestore,Ye),t=xt(e),r=new Ni(e);return fF(n._query),qL(t,n._query).then(i=>new vr(e,r,n,i))}function AF(n){n=Se(n,jt);let e=Se(n.firestore,Ye),t=xt(e),r=new Ni(e);return sK(t,n._query).then(i=>new vr(e,r,n,i))}function RF(n){n=Se(n,jt);let e=Se(n.firestore,Ye),t=xt(e),r=new Ni(e);return qL(t,n._query,{source:"server"}).then(i=>new vr(e,r,n,i))}function EC(n,e,t){n=Se(n,qe);let r=Se(n.firestore,Ye),i=Wg(n.converter,e,t);return Wc(r,[qg($o(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,lt.none())])}function TC(n,e,t,...r){n=Se(n,qe);let i=Se(n.firestore,Ye),s=$o(i),o;return o=typeof(e=z(e))=="string"||e instanceof yr?yC(s,"updateDoc",n._key,e,t,r):_C(s,"updateDoc",n._key,e),Wc(i,[o.toMutation(n._key,lt.exists(!0))])}function xF(n){return Wc(Se(n.firestore,Ye),[new bs(n._key,lt.none())])}function NF(n,e){let t=Se(n.firestore,Ye),r=eh(n),i=Wg(n.converter,e);return Wc(t,[qg($o(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,lt.exists(!1))]).then(()=>r)}function bC(n,...e){var t,r,i;n=z(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Cb(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Cb(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,d;if(n instanceof qe)l=Se(n.firestore,Ye),d=Bc(n._key.path),c={next:h=>{e[o]&&e[o](CC(l,n,h))},error:e[o+1],complete:e[o+2]};else{let h=Se(n,jt);l=Se(h.firestore,Ye),d=h._query;let p=new Ni(l);c={next:_=>{e[o]&&e[o](new vr(l,p,h,_))},error:e[o+1],complete:e[o+2]},fF(n._query)}return function(p,_,w,b){let R=new Fc(b),L=new $d(_,R,w);return p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return tC(yield Vc(p),L)})),()=>{R.za(),p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return nC(yield Vc(p),L)}))}}(xt(l),d,a,c)}function PF(n,e){return oK(xt(n=Se(n,Ye)),Cb(e)?e:{next:e})}function Wc(n,e){return function(r,i){let s=new bt;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return U8(yield dC(r),i,s)})),s.promise}(xt(n),e)}function CC(n,e,t){let r=t.docs.get(e._key),i=new Ni(n);return new Jn(n,i,e._key,r,new Di(t.hasPendingWrites,t.fromCache),e.converter)}var hK={maxAttempts:5};var Fg=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=$o(e)}set(e,t,r){this._verifyNotCommitted();let i=fs(e,this._firestore),s=Wg(i.converter,t,r),o=qg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,lt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=fs(e,this._firestore),o;return o=typeof(t=z(t))=="string"||t instanceof yr?yC(this._dataReader,"WriteBatch.update",s._key,t,r,i):_C(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,lt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=fs(e,this._firestore);return this._mutations=this._mutations.concat(new bs(t._key,lt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new F(M.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function fs(n,e){if((n=z(n)).firestore!==e)throw new F(M.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var Vb=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=$o(t)}get(t){let r=fs(t,this._firestore),i=new Fb(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Y();let o=s[0];if(o.isFoundDocument())return new Uo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Uo(this._firestore,i,r._key,null,r.converter);throw Y()})}set(t,r,i){let s=fs(t,this._firestore),o=Wg(s.converter,r,i),a=qg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=fs(t,this._firestore),a;return a=typeof(r=z(r))=="string"||r instanceof yr?yC(this._dataReader,"Transaction.update",o._key,r,i,s):_C(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=fs(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=fs(e,this._firestore),r=new Ni(this._firestore);return super.get(e).then(i=>new Jn(this._firestore,r,t._key,i._document,new Di(!1,!1),t.converter))}};function MF(n,e,t){n=Se(n,Ye);let r=Object.assign(Object.assign({},hK),t);return function(s){if(s.maxAttempts<1)throw new F(M.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new bt;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let l=yield tK(s);new Ib(s.asyncQueue,l,a,o,c).ru()})),c.promise}(xt(n),i=>e(new Vb(n,i)),r)}function kF(){return new Wd("deleteField")}function OF(){return new Rb("serverTimestamp")}function LF(...n){return new xb("arrayUnion",n)}function FF(...n){return new Nb("arrayRemove",n)}function VF(n){return new Pb("increment",n)}(function(e,t=!0){(function(i){jc=i})(cn),an(new Fe("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ye(new BT(r.getProvider("auth-internal")),new zT(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new F(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vs(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),dt(pO,"4.7.1",e),dt(pO,"4.7.1","esm2017")})();var fK="@firebase/firestore-compat",pK="0.3.36";function NC(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new F("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function UF(){if(typeof Uint8Array>"u")throw new F("unimplemented","Uint8Arrays are not available in this environment.")}function jF(){if(!x1())throw new F("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Gg=class n{constructor(e){this._delegate=e}static fromBase64String(e){return jF(),new n(Xr.fromBase64String(e))}static fromUint8Array(e){return UF(),new n(Xr.fromUint8Array(e))}toBase64(){return jF(),this._delegate.toBase64()}toUint8Array(){return UF(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function DC(n){return mK(n,["next","error","complete"])}function mK(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var SC=class{enableIndexedDbPersistence(e,t){return JL(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return XL(e._delegate)}clearIndexedDbPersistence(e){return eF(e._delegate)}},Kg=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof vs||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Qn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){GL(this._delegate,e,t,r)}enableNetwork(){return nF(this._delegate)}disableNetwork(){return rF(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,fC("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return tF(this._delegate)}onSnapshotsInSync(e){return PF(this._delegate,e)}get app(){if(!this._appCompat)throw new F("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Qc(this,pC(this._delegate,e))}catch(t){throw dn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Zr(this,eh(this._delegate,e))}catch(t){throw dn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Go(this,KL(this._delegate,e))}catch(t){throw dn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return MF(this._delegate,t=>e(new Qg(this,t)))}batch(){return xt(this._delegate),new Yg(new Fg(this._delegate,e=>Wc(this._delegate,e)))}loadBundle(e){return iF(this._delegate,e)}namedQuery(e){return sF(this._delegate,e).then(t=>t?new Go(this,t):null)}},Gc=class extends Uc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gg(new Xr(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Zr.forKey(t,this.firestore,null)}};function gK(n){_1(n)}var Qg=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Gc(e)}get(e){let t=qo(e);return this._delegate.get(t).then(r=>new zo(this._firestore,new Jn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=qo(e);return r?(NC("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=qo(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=qo(e);return this._delegate.delete(t),this}},Yg=class{constructor(e){this._delegate=e}set(e,t,r){let i=qo(e);return r?(NC("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=qo(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=qo(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Kc=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new ms(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Wo(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new Gc(e),t),i.set(t,s)),s}};Kc.INSTANCES=new WeakMap;var Zr=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Gc(e)}static forPath(e,t,r){if(e.length%2!==0)throw new F("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new qe(t._delegate,r,new G(e)))}static forKey(e,t,r){return new n(t,new qe(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Qc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Qc(this.firestore,pC(this._delegate,e))}catch(t){throw dn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=z(e),e instanceof qe?mC(this._delegate,e):!1}set(e,t){t=NC("DocumentReference.set",t);try{return t?EC(this._delegate,e,t):EC(this._delegate,e)}catch(r){throw dn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?TC(this._delegate,e):TC(this._delegate,e,t,...r)}catch(i){throw dn(i,"updateDoc()","DocumentReference.update()")}}delete(){return xF(this._delegate)}onSnapshot(...e){let t=BF(e),r=$F(e,i=>new zo(this.firestore,new Jn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return bC(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=CF(this._delegate):e?.source==="server"?t=DF(this._delegate):t=bF(this._delegate),t.then(r=>new zo(this.firestore,new Jn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Kc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function dn(n,e,t){return n.message=n.message.replace(e,t),n}function BF(n){for(let e of n)if(typeof e=="object"&&!DC(e))return e;return{}}function $F(n,e){var t,r;let i;return DC(n[0])?i=n[0]:DC(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var zo=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Zr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return IC(this._delegate,e._delegate)}},Wo=class extends zo{data(e){let t=this._delegate.data(e);return this._delegate._converter||y1(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Go=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Gc(e)}where(e,t,r){try{return new n(this.firestore,Mi(this._delegate,pF(e,t,r)))}catch(i){throw dn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Mi(this._delegate,mF(e,t)))}catch(r){throw dn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Mi(this._delegate,gF(e)))}catch(t){throw dn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Mi(this._delegate,_F(e)))}catch(t){throw dn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Mi(this._delegate,yF(...e)))}catch(t){throw dn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Mi(this._delegate,vF(...e)))}catch(t){throw dn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Mi(this._delegate,wF(...e)))}catch(t){throw dn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Mi(this._delegate,IF(...e)))}catch(t){throw dn(t,"endAt()","Query.endAt()")}}isEqual(e){return gC(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=AF(this._delegate):e?.source==="server"?t=RF(this._delegate):t=SF(this._delegate),t.then(r=>new th(this.firestore,new vr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=BF(e),r=$F(e,i=>new th(this.firestore,new vr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return bC(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Kc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},AC=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Wo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},th=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Go(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Wo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new AC(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Wo(this._firestore,r))})}isEqual(e){return IC(this._delegate,e._delegate)}},Qc=class n extends Go{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Zr(this.firestore,e):null}doc(e){try{return e===void 0?new Zr(this.firestore,eh(this._delegate)):new Zr(this.firestore,eh(this._delegate,e))}catch(t){throw dn(t,"doc()","CollectionReference.doc()")}}add(e){return NF(this._delegate,e).then(t=>new Zr(this.firestore,t))}isEqual(e){return mC(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Kc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function qo(n){return Se(n,qe)}var RC=class n{constructor(...e){this._delegate=new yr(...e)}static documentId(){return new n(ft.keyField().canonicalString())}isEqual(e){return e=z(e),e instanceof yr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var xC=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=OF();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=kF();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=LF(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=FF(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=VF(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var _K={Firestore:Kg,GeoPoint:Vo,Timestamp:et,Blob:Gg,Transaction:Qg,WriteBatch:Yg,DocumentReference:Zr,DocumentSnapshot:zo,Query:Go,QueryDocumentSnapshot:Wo,QuerySnapshot:th,CollectionReference:Qc,FieldPath:RC,FieldValue:xC,setLogLevel:gK,CACHE_SIZE_UNLIMITED:QL};function yK(n,e){n.INTERNAL.registerComponent(new Fe("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},_K)))}function vK(n){yK(n,(e,t)=>new Kg(e,t,new SC)),n.registerVersion(fK,pK)}vK(Ne);var JF="firebasestorage.googleapis.com",XF="storageBucket",wK=2*60*1e3,IK=10*60*1e3,EK=1e3;var tt=class n extends ot{constructor(e,t,r=0){super(PC(e),`Firebase Storage: ${t} (${PC(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return PC(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Je=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Je||{});function PC(n){return"storage/"+n}function jC(){let n="An unknown error occurred, please check the error payload for server response.";return new tt(Je.UNKNOWN,n)}function TK(n){return new tt(Je.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function bK(n){return new tt(Je.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function CK(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new tt(Je.UNAUTHENTICATED,n)}function DK(){return new tt(Je.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function SK(n){return new tt(Je.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function ZF(){return new tt(Je.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function eV(){return new tt(Je.CANCELED,"User canceled the upload/download.")}function AK(n){return new tt(Je.INVALID_URL,"Invalid URL '"+n+"'.")}function RK(n){return new tt(Je.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function xK(){return new tt(Je.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+XF+"' property when initializing the app?")}function tV(){return new tt(Je.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function NK(){return new tt(Je.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function PK(){return new tt(Je.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function MK(n){return new tt(Je.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ko(n){return new tt(Je.INVALID_ARGUMENT,n)}function nV(){return new tt(Je.APP_DELETED,"The Firebase app was deleted.")}function BC(n){return new tt(Je.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function rh(n,e){return new tt(Je.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function nh(n){throw new tt(Je.INTERNAL_ERROR,"Internal error: "+n)}var hn=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw RK(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(Q){Q.path.charAt(Q.path.length-1)==="/"&&(Q.path_=Q.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(Q){Q.path_=decodeURIComponent(Q.path)}let d="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",_=new RegExp(`^https?://${h}/${d}/b/${i}/o${p}`,"i"),w={bucket:1,path:3},b=t===JF?"(?:storage.googleapis.com|storage.cloud.google.com)":t,R="([^?#]*)",L=new RegExp(`^https?://${b}/${i}/${R}`,"i"),U=[{regex:a,indices:c,postModify:s},{regex:_,indices:w,postModify:l},{regex:L,indices:{bucket:1,path:2},postModify:l}];for(let Q=0;Q<U.length;Q++){let ie=U[Q],J=ie.regex.exec(e);if(J){let T=J[ie.indices.bucket],v=J[ie.indices.path];v||(v=""),r=new n(T,v),ie.postModify(r);break}}if(r==null)throw AK(e);return r}},kC=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function kK(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...R){l||(l=!0,e.apply(null,R))}function h(R){i=setTimeout(()=>{i=null,n(_,c())},R)}function p(){s&&clearTimeout(s)}function _(R,...L){if(l){p();return}if(R){p(),d.call(null,R,...L);return}if(c()||o){p(),d.call(null,R,...L);return}r<64&&(r*=2);let U;a===1?(a=2,U=0):U=(r+Math.random())*1e3,h(U)}let w=!1;function b(R){w||(w=!0,p(),!l&&(i!==null?(R||(a=2),clearTimeout(i),h(0)):R||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,b(!0)},t),b}function OK(n){n(!1)}function LK(n){return n!==void 0}function FK(n){return typeof n=="function"}function VK(n){return typeof n=="object"&&!Array.isArray(n)}function Zg(n){return typeof n=="string"||n instanceof String}function HF(n){return $C()&&n instanceof Blob}function $C(){return typeof Blob<"u"}function OC(n,e,t,r){if(r<e)throw Ko(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Ko(`Invalid value for '${n}'. Expected ${t} or less.`)}function Rs(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function rV(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Xc=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Xc||{});function iV(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var LC=class{constructor(e,t,r,i,s,o,a,c,l,d,h,p=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,w)=>{this.resolve_=_,this.reject_=w,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Jc(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Xc.NO_ERROR,c=s.getStatus();if(!a||iV(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===Xc.ABORT;r(!1,new Jc(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new Jc(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());LK(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=jC();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?nV():eV();o(c)}else{let c=ZF();o(c)}};this.canceled_?t(!1,new Jc(!1,null,!0)):this.backoffId_=kK(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&OK(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Jc=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function UK(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function jK(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function BK(n,e){e&&(n["X-Firebase-GMPID"]=e)}function $K(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function HK(n,e,t,r,i,s,o=!0){let a=rV(n.urlParams),c=n.url+a,l=Object.assign({},n.headers);return BK(l,e),UK(l,t),jK(l,s),$K(l,r),new LC(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function qK(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function zK(...n){let e=qK();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if($C())return new Blob(n);throw new tt(Je.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function WK(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function GK(n){if(typeof atob>"u")throw MK("base-64");return atob(n)}var Mn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},ih=class{constructor(e,t){this.data=e,this.contentType=t||null}};function HC(n,e){switch(n){case Mn.RAW:return new ih(sV(e));case Mn.BASE64:case Mn.BASE64URL:return new ih(oV(n,e));case Mn.DATA_URL:return new ih(QK(e),YK(e))}throw jC()}function sV(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function KK(n){let e;try{e=decodeURIComponent(n)}catch{throw rh(Mn.DATA_URL,"Malformed data URL.")}return sV(e)}function oV(n,e){switch(n){case Mn.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw rh(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Mn.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw rh(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=GK(e)}catch(i){throw i.message.includes("polyfill")?i:rh(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var Xg=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw rh(Mn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=JK(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function QK(n){let e=new Xg(n);return e.base64?oV(Mn.BASE64,e.rest):KK(e.rest)}function YK(n){return new Xg(n).contentType}function JK(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var Zc=class n{constructor(e,t){let r=0,i="";HF(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(HF(this.data_)){let r=this.data_,i=WK(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if($C()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(zK.apply(null,t))}else{let t=e.map(o=>Zg(o)?HC(Mn.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new n(i,!0)}}uploadData(){return this.data_}};function qC(n){let e;try{e=JSON.parse(n)}catch{return null}return VK(e)?e:null}function XK(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function ZK(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function aV(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function e7(n,e){return e}var Bt=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||e7}},Jg=null;function t7(n){return!Zg(n)||n.length<2?n:aV(n)}function e_(){if(Jg)return Jg;let n=[];n.push(new Bt("bucket")),n.push(new Bt("generation")),n.push(new Bt("metageneration")),n.push(new Bt("name","fullPath",!0));function e(s,o){return t7(o)}let t=new Bt("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new Bt("size");return i.xform=r,n.push(i),n.push(new Bt("timeCreated")),n.push(new Bt("updated")),n.push(new Bt("md5Hash",null,!0)),n.push(new Bt("cacheControl",null,!0)),n.push(new Bt("contentDisposition",null,!0)),n.push(new Bt("contentEncoding",null,!0)),n.push(new Bt("contentLanguage",null,!0)),n.push(new Bt("contentType",null,!0)),n.push(new Bt("metadata","customMetadata",!0)),Jg=n,Jg}function n7(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new hn(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function r7(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return n7(r,n),r}function cV(n,e,t){let r=qC(e);return r===null?null:r7(n,r,t)}function i7(n,e,t,r){let i=qC(e);if(i===null||!Zg(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let d=n.bucket,h=n.fullPath,p="/b/"+o(d)+"/o/"+o(h),_=Rs(p,t,r),w=rV({alt:"media",token:l});return _+w})[0]}function zC(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var qF="prefixes",zF="items";function s7(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[qF])for(let i of t[qF]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new hn(e,s));r.prefixes.push(o)}if(t[zF])for(let i of t[zF]){let s=n._makeStorageReference(new hn(e,i.name));r.items.push(s)}return r}function o7(n,e,t){let r=qC(t);return r===null?null:s7(n,e,r)}var wr=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function ti(n){if(!n)throw jC()}function t_(n,e){function t(r,i){let s=cV(n,i,e);return ti(s!==null),s}return t}function a7(n,e){function t(r,i){let s=o7(n,e,i);return ti(s!==null),s}return t}function c7(n,e){function t(r,i){let s=cV(n,i,e);return ti(s!==null),i7(s,i,n.host,n._protocol)}return t}function nl(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=DK():i=CK():t.getStatus()===402?i=bK(n.bucket):t.getStatus()===403?i=SK(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function n_(n){let e=nl(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=TK(n.path)),s.serverResponse=i.serverResponse,s}return t}function lV(n,e,t){let r=e.fullServerUrl(),i=Rs(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new wr(i,s,t_(n,t),o);return a.errorHandler=n_(e),a}function l7(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=Rs(o,n.host,n._protocol),c="GET",l=n.maxOperationRetryTime,d=new wr(a,c,a7(n,e.bucket),l);return d.urlParams=s,d.errorHandler=nl(e),d}function u7(n,e,t){let r=e.fullServerUrl(),i=Rs(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new wr(i,s,c7(n,t),o);return a.errorHandler=n_(e),a}function d7(n,e,t,r){let i=e.fullServerUrl(),s=Rs(i,n.host,n._protocol),o="PATCH",a=zC(t,r),c={"Content-Type":"application/json; charset=utf-8"},l=n.maxOperationRetryTime,d=new wr(s,o,t_(n,r),l);return d.headers=c,d.body=a,d.errorHandler=n_(e),d}function h7(n,e){let t=e.fullServerUrl(),r=Rs(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,l){}let a=new wr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=n_(e),a}function f7(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function uV(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=f7(null,e)),r}function p7(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let U="";for(let Q=0;Q<2;Q++)U=U+Math.random().toString().slice(2);return U}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let l=uV(e,r,i),d=zC(l,t),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,p=`\r
--`+c+"--",_=Zc.getBlob(h,r,p);if(_===null)throw tV();let w={name:l.fullPath},b=Rs(s,n.host,n._protocol),R="POST",L=n.maxUploadRetryTime,H=new wr(b,R,t_(n,t),L);return H.urlParams=w,H.headers=o,H.body=_.uploadData(),H.errorHandler=nl(e),H}var el=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function WC(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{ti(!1)}return ti(!!t&&(e||["active"]).indexOf(t)!==-1),t}function m7(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=uV(e,r,i),a={name:o.fullPath},c=Rs(s,n.host,n._protocol),l="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=zC(o,t),p=n.maxUploadRetryTime;function _(b){WC(b);let R;try{R=b.getResponseHeader("X-Goog-Upload-URL")}catch{ti(!1)}return ti(Zg(R)),R}let w=new wr(c,l,_,p);return w.urlParams=a,w.headers=d,w.body=h,w.errorHandler=nl(e),w}function g7(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(l){let d=WC(l,["active","final"]),h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{ti(!1)}h||ti(!1);let p=Number(h);return ti(!isNaN(p)),new el(p,r.size(),d==="final")}let o="POST",a=n.maxUploadRetryTime,c=new wr(t,o,s,a);return c.headers=i,c.errorHandler=nl(e),c}var WF=256*1024;function _7(n,e,t,r,i,s,o,a){let c=new el(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw NK();let l=c.total-c.current,d=l;i>0&&(d=Math.min(d,i));let h=c.current,p=h+d,_="";d===0?_="finalize":l===d?_="upload, finalize":_="upload";let w={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${c.current}`},b=r.slice(h,p);if(b===null)throw tV();function R(Q,ie){let J=WC(Q,["active","final"]),T=c.current+d,v=r.size(),I;return J==="final"?I=t_(e,s)(Q,ie):I=null,new el(T,v,J==="final",I)}let L="POST",H=e.maxUploadRetryTime,U=new wr(t,L,R,H);return U.headers=w,U.body=b.uploadData(),U.progressCallback=a||null,U.errorHandler=nl(n),U}var dV={STATE_CHANGED:"state_changed"},Zt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function MC(n){switch(n){case"running":case"pausing":case"canceling":return Zt.RUNNING;case"paused":return Zt.PAUSED;case"success":return Zt.SUCCESS;case"canceled":return Zt.CANCELED;case"error":return Zt.ERROR;default:return Zt.ERROR}}var FC=class{constructor(e,t,r){if(FK(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function Yc(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var GF=null,VC=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Xc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Xc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Xc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw nh("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw nh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw nh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw nh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw nh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},UC=class extends VC{initXhr(){this.xhr_.responseType="text"}};function ei(){return GF?GF():new UC}var sh=class{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=e_(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Je.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(iV(i.status,[]))if(s)i=ZF();else{this.sleepTime=Math.max(this.sleepTime*2,EK),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Je.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=m7(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,ei,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=g7(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,ei,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=WF*this._chunkMultiplier,t=new el(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=_7(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let a=this._ref.storage._makeRequest(o,ei,i,s,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){WF*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=lV(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,ei,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=p7(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,ei,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=eV(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=MC(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new FC(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(MC(this._state)){case Zt.SUCCESS:Yc(this._resolve.bind(null,this.snapshot))();break;case Zt.CANCELED:case Zt.ERROR:let t=this._reject;Yc(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(MC(this._state)){case Zt.RUNNING:case Zt.PAUSED:e.next&&Yc(e.next.bind(e,this.snapshot))();break;case Zt.SUCCESS:e.complete&&Yc(e.complete.bind(e))();break;case Zt.CANCELED:case Zt.ERROR:e.error&&Yc(e.error.bind(e,this._error))();break;default:e.error&&Yc(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var tl=class n{constructor(e,t){this._service=e,t instanceof hn?this._location=t:this._location=hn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new hn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return aV(this._location.path)}get storage(){return this._service}get parent(){let e=XK(this._location.path);if(e===null)return null;let t=new hn(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw BC(e)}};function y7(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new sh(n,new Zc(e),t)}function v7(n){let e={prefixes:[],items:[]};return hV(n,e).then(()=>e)}function hV(n,e,t){return g(this,null,function*(){let i=yield fV(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield hV(n,e,i.nextPageToken))})}function fV(n,e){e!=null&&typeof e.maxResults=="number"&&OC("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=l7(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,ei)}function w7(n){n._throwIfRoot("getMetadata");let e=lV(n.storage,n._location,e_());return n.storage.makeRequestWithTokens(e,ei)}function I7(n,e){n._throwIfRoot("updateMetadata");let t=d7(n.storage,n._location,e,e_());return n.storage.makeRequestWithTokens(t,ei)}function E7(n){n._throwIfRoot("getDownloadURL");let e=u7(n.storage,n._location,e_());return n.storage.makeRequestWithTokens(e,ei).then(t=>{if(t===null)throw PK();return t})}function T7(n){n._throwIfRoot("deleteObject");let e=h7(n.storage,n._location);return n.storage.makeRequestWithTokens(e,ei)}function pV(n,e){let t=ZK(n._location.path,e),r=new hn(n._location.bucket,t);return new tl(n.storage,r)}function b7(n){return/^[A-Za-z]+:\/\//.test(n)}function C7(n,e){return new tl(n,e)}function mV(n,e){if(n instanceof oh){let t=n;if(t._bucket==null)throw xK();let r=new tl(t,t._bucket);return e!=null?mV(r,e):r}else return e!==void 0?pV(n,e):n}function D7(n,e){if(e&&b7(e)){if(n instanceof oh)return C7(n,e);throw Ko("To use ref(service, url), the first argument must be a Storage instance.")}else return mV(n,e)}function KF(n,e){let t=e?.[XF];return t==null?null:hn.makeFromBucketSpec(t,n)}function S7(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:Ga(i,n.app.options.projectId))}var oh=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=JF,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=wK,this._maxUploadRetryTime=IK,this._requests=new Set,i!=null?this._bucket=hn.makeFromBucketSpec(i,this._host):this._bucket=KF(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=hn.makeFromBucketSpec(this._url,e):this._bucket=KF(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){OC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){OC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return g(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return g(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new tl(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new kC(nV());{let o=HK(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return g(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},QF="@firebase/storage",YF="0.13.1";var A7="storage";function gV(n,e,t){return n=z(n),y7(n,e,t)}function _V(n){return n=z(n),w7(n)}function yV(n,e){return n=z(n),I7(n,e)}function vV(n,e){return n=z(n),fV(n,e)}function wV(n){return n=z(n),v7(n)}function IV(n){return n=z(n),E7(n)}function EV(n){return n=z(n),T7(n)}function GC(n,e){return n=z(n),D7(n,e)}function TV(n,e){return pV(n,e)}function bV(n,e,t,r={}){S7(n,e,t,r)}function R7(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new oh(t,r,i,e,cn)}function x7(){an(new Fe(A7,R7,"PUBLIC").setMultipleInstances(!0)),dt(QF,YF,""),dt(QF,YF,"esm2017")}x7();var rl=class{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var r_=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new rl(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new rl(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(typeof t=="function"?s=o=>t(new rl(o,this,this._ref)):s={next:t.next?o=>t.next(new rl(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},i_=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Qo(e,this._service))}get items(){return this._delegate.items.map(e=>new Qo(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var Qo=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=TV(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new r_(gV(this._delegate,e,t),this)}putString(e,t=Mn.RAW,r){this._throwIfRoot("putString");let i=HC(t,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new r_(new sh(this._delegate,new Zc(i.data,!0),s),this)}listAll(){return wV(this._delegate).then(e=>new i_(e,this.storage))}list(e){return vV(this._delegate,e||void 0).then(t=>new i_(t,this.storage))}getMetadata(){return _V(this._delegate)}updateMetadata(e){return yV(this._delegate,e)}getDownloadURL(){return IV(this._delegate)}delete(){return this._throwIfRoot("delete"),EV(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw BC(e)}};var s_=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(CV(e))throw Ko("ref() expected a child path but got a URL, use refFromURL instead.");return new Qo(GC(this._delegate,e),this)}refFromURL(e){if(!CV(e))throw Ko("refFromURL() expected a full URL but got a child path, use ref() instead.");try{hn.makeFromUrl(e,this._delegate.host)}catch{throw Ko("refFromUrl() expected a valid full URL but got an invalid one.")}return new Qo(GC(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){bV(this._delegate,e,t,r)}};function CV(n){return/^[A-Za-z]+:\/\//.test(n)}var N7="@firebase/storage-compat",P7="0.3.11";var M7="storage-compat";function k7(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new s_(t,r)}function O7(n){let e={TaskState:Zt,TaskEvent:dV,StringFormat:Mn,Storage:s_,Reference:Qo};n.INTERNAL.registerComponent(new Fe(M7,k7,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(N7,P7)}O7(Ne);var DV="@firebase/database",SV="1.0.7";var sS="";function oS(n){sS=n}var tD=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),_t(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:za(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var nD=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return on(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var i2=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new tD(e)}}catch{}return new nD},Jo=i2("localStorage"),rD=i2("sessionStorage");var al=new wn("@firebase/database"),s2=function(){let n=1;return function(){return n++}}(),o2=function(n){let e=FM(n),t=new zp;t.update(e);let r=t.digest();return Wp.encodeByteArray(r)},xh=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=xh.apply(null,r):typeof r=="object"?e+=_t(r):e+=r,e+=" "}return e},Xo=null,AV=!0,a2=function(n,e){B(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(al.logLevel=me.VERBOSE,Xo=al.log.bind(al),e&&rD.set("logging_enabled",!0)):typeof n=="function"?Xo=n:(Xo=null,rD.remove("logging_enabled"))},kt=function(...n){if(AV===!0&&(AV=!1,Xo===null&&rD.get("logging_enabled")===!0&&a2(!0)),Xo){let e=xh.apply(null,n);Xo(e)}},Nh=function(n){return function(...e){kt(n,...e)}},iD=function(...n){let e="FIREBASE INTERNAL ERROR: "+xh(...n);al.error(e)},ii=function(...n){let e=`FIREBASE FATAL ERROR: ${xh(...n)}`;throw al.error(e),new Error(e)},en=function(...n){let e="FIREBASE WARNING: "+xh(...n);al.warn(e)},L7=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&en("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},M_=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},F7=function(n){if(Lr()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ms="[MIN_NAME]",ki="[MAX_NAME]",ea=function(n,e){if(n===e)return 0;if(n===Ms||e===ki)return-1;if(e===Ms||n===ki)return 1;{let t=RV(n),r=RV(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},V7=function(n,e){return n===e?0:n<e?-1:1},ah=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+_t(e))},aS=function(n){if(typeof n!="object"||n===null)return _t(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=_t(e[r]),t+=":",t+=aS(n[e[r]]);return t+="}",t},c2=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Ot(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var l2=function(n){B(!M_(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),h="";for(c=0;c<64;c+=8){let p=parseInt(d.substr(c,8),2).toString(16);p.length===1&&(p="0"+p),h=h+p}return h.toLowerCase()},U7=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},j7=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function B7(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var $7=new RegExp("^-?(0*)\\d{1,10}$"),H7=-2147483648,q7=2147483647,RV=function(n){if($7.test(n)){let e=Number(n);if(e>=H7&&e<=q7)return e}return null},gl=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw en("Exception was thrown by user callback.",t),e},Math.floor(0))}},z7=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},dh=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var sD=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){en(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var oD=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(kt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',en(e)}},hh=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),a_="5",u2="v",d2="s",h2="r",f2="f",p2=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,m2="ls",g2="p",aD="ac",_2="websocket",y2="long_polling";var c_=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Jo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Jo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function W7(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function v2(n,e,t){B(typeof e=="string","typeof type must == string"),B(typeof t=="object","typeof params must == object");let r;if(e===_2)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===y2)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);W7(n)&&(t.ns=n.namespace);let i=[];return Ot(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var cD=class{constructor(){this.counters_={}}incrementCounter(e,t=1){on(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return xM(this.counters_)}};var KC={},QC={};function cS(n){let e=n.toString();return KC[e]||(KC[e]=new cD),KC[e]}function G7(n,e){let t=n.toString();return QC[t]||(QC[t]=e()),QC[t]}var lD=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&gl(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var xV="start",K7="close",Q7="pLPCommand",Y7="pRTLPCB",w2="id",I2="pw",E2="ser",J7="cb",X7="seg",Z7="ts",eQ="d",tQ="dframe",T2=1870,b2=30,nQ=T2-b2,rQ=25e3,iQ=3e4,gh=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Nh(e),this.stats_=cS(t),this.urlFn=c=>(this.appCheckToken&&(c[aD]=this.appCheckToken),v2(t,y2,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new lD(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(iQ)),F7(()=>{if(this.isClosed_)return;this.scriptTagHolder=new uD((...s)=>{let[o,a,c,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===xV)this.id=a,this.password=c;else if(o===K7)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[xV]="t",r[E2]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[J7]=this.scriptTagHolder.uniqueCallbackIdentifier),r[u2]=a_,this.transportSessionId&&(r[d2]=this.transportSessionId),this.lastSessionId&&(r[m2]=this.lastSessionId),this.applicationId&&(r[g2]=this.applicationId),this.appCheckToken&&(r[aD]=this.appCheckToken),typeof location<"u"&&location.hostname&&p2.test(location.hostname)&&(r[h2]=f2);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return Lr()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!U7()&&!j7()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=_t(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=bI(t),i=c2(r,nQ);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Lr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[tQ]="t",r[w2]=e,r[I2]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=_t(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},uD=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Lr())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=s2(),window[Q7+this.uniqueCallbackIdentifier]=e,window[Y7+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){kt("frame writing exception"),a.stack&&kt(a.stack),kt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||kt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[w2]=this.myID,e[I2]=this.myPW,e[E2]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+b2+r.length<=T2;){let o=this.pendingSegs.shift();r=r+"&"+X7+i+"="+o.seg+"&"+Z7+i+"="+o.ts+"&"+eQ+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(rQ)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){Lr()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{kt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var sQ=16384,oQ=45e3,l_=null;typeof MozWebSocket<"u"?l_=MozWebSocket:typeof WebSocket<"u"&&(l_=WebSocket);var sl=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Nh(this.connId),this.stats_=cS(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[u2]=a_,!Lr()&&typeof location<"u"&&location.hostname&&p2.test(location.hostname)&&(a[h2]=f2),r&&(a[d2]=r),i&&(a[m2]=i),s&&(a[aD]=s),o&&(a[g2]=o),v2(t,_2,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Jo.set("previous_websocket_failure",!0);try{let i;if(Lr()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${a_}/${sS}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new l_(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&l_!==null&&!n.forceDisallow_}static previouslyFailed(){return Jo.isInMemoryStorage||Jo.get("previous_websocket_failure")===!0}markConnectionHealthy(){Jo.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=za(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(B(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=_t(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=c2(r,sQ);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(oQ))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),C2=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[gh,sl]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=sl&&sl.isAvailable(),i=r&&!sl.previouslyFailed();if(t.webSocketOnly&&(r||en("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[sl];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),aQ=6e4,cQ=5e3,lQ=10*1024,uQ=100*1024,YC="t",NV="d",dQ="s",PV="r",hQ="e",MV="o",kV="a",OV="n",LV="p",fQ="h",dD=class{constructor(e,t,r,i,s,o,a,c,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Nh("c:"+this.id+":"),this.transportManager_=new C2(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=dh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>uQ?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>lQ?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(YC in e){let t=e[YC];t===kV?this.upgradeIfSecondaryHealthy_():t===PV?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===MV&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=ah("t",e),r=ah("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:LV,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:kV,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:OV,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=ah("t",e),r=ah("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=ah(YC,e);if(NV in e){let r=e[NV];if(t===fQ){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===OV){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===dQ?this.onConnectionShutdown_(r):t===PV?this.onReset_(r):t===hQ?iD("Server Error: "+r):t===MV?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):iD("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),a_!==r&&en("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),dh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(aQ))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):dh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(cQ))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:LV,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Jo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var u_=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var d_=class{constructor(e){this.allowedEvents_=e,this.listeners_={},B(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){B(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var h_=class n extends d_{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Uu()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return B(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var FV=32,VV=768,xe=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Re(){return new xe("")}function ge(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ks(n){return n.pieces_.length-n.pieceNum_}function Be(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new xe(n.pieces_,e)}function lS(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function pQ(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function _h(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function D2(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new xe(e,0)}function Xe(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof xe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new xe(t,0)}function _e(n){return n.pieceNum_>=n.pieces_.length}function fn(n,e){let t=ge(n),r=ge(e);if(t===null)return e;if(t===r)return fn(Be(n),Be(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function mQ(n,e){let t=_h(n,0),r=_h(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=ea(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function uS(n,e){if(ks(n)!==ks(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Xn(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(ks(n)>ks(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var hD=class{constructor(e,t){this.errorPrefix_=t,this.parts_=_h(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Bu(this.parts_[r]);S2(this)}};function gQ(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Bu(e),S2(n)}function _Q(n){let e=n.parts_.pop();n.byteLength_-=Bu(e),n.parts_.length>0&&(n.byteLength_-=1)}function S2(n){if(n.byteLength_>VV)throw new Error(n.errorPrefix_+"has a key path longer than "+VV+" bytes ("+n.byteLength_+").");if(n.parts_.length>FV)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+FV+") or object contains a cycle "+Yo(n))}function Yo(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var fD=class n extends d_{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return B(e==="visible","Unknown event type: "+e),[this.visible_]}};var ch=1e3,yQ=60*5*1e3,UV=30*1e3,vQ=1.3,wQ=3e4,IQ="server_kill",jV=3,dS=(()=>{class n extends u_{constructor(t,r,i,s,o,a,c,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=Nh("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ch,this.maxReconnectDelay_=yQ,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!Lr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");fD.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&h_.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(_t(o)),B(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new St,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),B(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),B(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,d=c.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&on(t,"w")){let i=Zi(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();en(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||LM(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=UV)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=OM(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),B(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+_t(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):iD("Unrecognized action received from server: "+_t(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){B(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ch,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ch,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>wQ&&(this.reconnectDelay_=ch),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*vQ)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},d=function(p){B(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(p)};this.realtime_={close:l,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[p,_]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?kt("getToken() completed but was canceled"):(kt("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=_&&_.token,c=new dD(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,w=>{en(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(IQ)},o))}catch(p){this.log_("Failed to get token: "+p),a||(this.repoInfo_.nodeAdmin&&en(p),l())}}})}interrupt(t){kt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){kt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Ka(this.interruptReasons_)&&(this.reconnectDelay_=ch,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>aS(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new xe(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){kt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=jV&&(this.reconnectDelay_=UV,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){kt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=jV&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";Lr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+sS.replace(/\./g,"-")]=1,Uu()?t["framework.cordova"]=1:oo()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=h_.getInstance().currentlyOnline();return Ka(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),ve=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var cl=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new ve(Ms,e),i=new ve(Ms,t);return this.compare(r,i)!==0}minPost(){return ve.MIN}};var o_,f_=class extends cl{static get __EMPTY_NODE(){return o_}static set __EMPTY_NODE(e){o_=e}compare(e,t){return ea(e.name,t.name)}isDefinedOn(e){throw so("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ve.MIN}maxPost(){return new ve(ki,o_)}makePost(e,t){return B(typeof e=="string","KeyIndex indexValue must always be a string."),new ve(e,o_)}toString(){return".key"}},ri=new f_;var ol=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Ir=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Zn.EMPTY_NODE,this.right=o??Zn.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Zn.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Zn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),pD=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new Ir(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Zn=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ir.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ir.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ol(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new ol(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new ol(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new ol(this.root_,null,this.comparator_,!0,e)}};Zn.EMPTY_NODE=new pD;function EQ(n,e){return ea(n.name,e.name)}function hS(n,e){return ea(n,e)}var mD;function TQ(n){mD=n}var A2=function(n){return typeof n=="number"?"number:"+l2(n):"string:"+n},R2=function(n){if(n.isLeafNode()){let e=n.val();B(typeof e=="string"||typeof e=="number"||typeof e=="object"&&on(e,".sv"),"Priority must be a string or number.")}else B(n===mD||n.isEmpty(),"priority of unexpected type.");B(n===mD||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var BV,ll=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,B(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),R2(this.priorityNode_)}static set __childrenNodeConstructor(t){BV=t}static get __childrenNodeConstructor(){return BV}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return _e(t)?this:ge(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=ge(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(B(i!==".priority"||ks(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Be(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+A2(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=l2(this.value_):t+=this.value_,this.lazyHash_=o2(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(B(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return B(s>=0,"Unknown leaf type: "+r),B(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),x2,N2;function bQ(n){x2=n}function CQ(n){N2=n}var gD=class extends cl{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?ea(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ve.MIN}maxPost(){return new ve(ki,new ll("[PRIORITY-POST]",N2))}makePost(e,t){let r=x2(e);return new ve(t,new ll("[PRIORITY-POST]",r))}toString(){return".priority"}},ze=new gD;var DQ=Math.log(2),_D=class{constructor(e){let t=s=>parseInt(Math.log(s)/DQ,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},p_=function(n,e,t,r){n.sort(e);let i=function(c,l){let d=l-c,h,p;if(d===0)return null;if(d===1)return h=n[c],p=t?t(h):h,new Ir(p,h.node,Ir.BLACK,null,null);{let _=parseInt(d/2,10)+c,w=i(c,_),b=i(_+1,l);return h=n[_],p=t?t(h):h,new Ir(p,h.node,Ir.BLACK,w,b)}},s=function(c){let l=null,d=null,h=n.length,p=function(w,b){let R=h-w,L=h;h-=w;let H=i(R+1,L),U=n[R],Q=t?t(U):U;_(new Ir(Q,U.node,b,null,H))},_=function(w){l?(l.left=w,l=w):(d=w,l=w)};for(let w=0;w<c.count;++w){let b=c.nextBitIsOne(),R=Math.pow(2,c.count-(w+1));b?p(R,Ir.BLACK):(p(R,Ir.BLACK),p(R,Ir.RED))}return d},o=new _D(n.length),a=s(o);return new Zn(r||e,a)};var JC,il={},ul=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return B(il&&ze,"ChildrenNode.ts has not been loaded"),JC=JC||new n({".priority":il},{".priority":ze}),JC}get(e){let t=Zi(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Zn?t:null}hasIndex(e){return on(this.indexSet_,e.toString())}addIndex(e,t){B(e!==ri,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(ve.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=p_(r,e.getCompare()):a=il;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,l)}addToIndexes(e,t){let r=ju(this.indexes_,(i,s)=>{let o=Zi(this.indexSet_,s);if(B(o,"Missing index implementation for "+s),i===il)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(ve.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),p_(a,o.getCompare())}else return il;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new ve(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=ju(this.indexes_,i=>{if(i===il)return i;{let s=t.get(e.name);return s?i.remove(new ve(e.name,s)):i}});return new n(r,this.indexSet_)}};var lh,de=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&R2(this.priorityNode_),this.children_.isEmpty()&&B(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return lh||(lh=new n(new Zn(hS),null,ul.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||lh}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?lh:r}}getChild(t){let r=ge(t);return r===null?this:this.getImmediateChild(r).getChild(Be(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(B(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new ve(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?lh:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=ge(t);if(i===null)return r;{B(ge(t)!==".priority"||ks(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Be(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(ze,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+A2(this.getPriority().val())+":"),this.forEachChild(ze,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":o2(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ve(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new ve(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new ve(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,ve.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,ve.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Ph?-1:0}withIndex(t){if(t===ri||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===ri||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(ze),s=r.getIterator(ze),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===ri?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),yD=class extends de{constructor(){super(new Zn(hS),de.EMPTY_NODE,ul.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return de.EMPTY_NODE}isEmpty(){return!1}},Ph=new yD;Object.defineProperties(ve,{MIN:{value:new ve(Ms,de.EMPTY_NODE)},MAX:{value:new ve(ki,Ph)}});f_.__EMPTY_NODE=de.EMPTY_NODE;ll.__childrenNodeConstructor=de;TQ(Ph);CQ(Ph);var SQ=!0;function nt(n,e=null){if(n===null)return de.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),B(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new ll(t,nt(e))}if(!(n instanceof Array)&&SQ){let t=[],r=!1;if(Ot(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=nt(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new ve(o,c)))}}),t.length===0)return de.EMPTY_NODE;let s=p_(t,EQ,o=>o.name,hS);if(r){let o=p_(t,ze.getCompare());return new de(s,nt(e),new ul({".priority":o},{".priority":ze}))}else return new de(s,nt(e),ul.Default)}else{let t=de.EMPTY_NODE;return Ot(n,(r,i)=>{if(on(n,r)&&r.substring(0,1)!=="."){let s=nt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(nt(e))}}bQ(nt);var yh=class extends cl{constructor(e){super(),this.indexPath_=e,B(!_e(e)&&ge(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?ea(e.name,t.name):s}makePost(e,t){let r=nt(e),i=de.EMPTY_NODE.updateChild(this.indexPath_,r);return new ve(t,i)}maxPost(){let e=de.EMPTY_NODE.updateChild(this.indexPath_,Ph);return new ve(ki,e)}toString(){return _h(this.indexPath_,0).join("/")}};var vD=class extends cl{compare(e,t){let r=e.node.compareTo(t.node);return r===0?ea(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ve.MIN}maxPost(){return ve.MAX}makePost(e,t){let r=nt(e);return new ve(t,r)}toString(){return".value"}},fS=new vD;function P2(n){return{type:"value",snapshotNode:n}}function dl(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function vh(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function wh(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function AQ(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var Ih=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){B(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(vh(t,a)):B(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(dl(t,r)):o.trackChildChange(wh(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(ze,(i,s)=>{t.hasChild(i)||r.trackChildChange(vh(i,s))}),t.isLeafNode()||t.forEachChild(ze,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(wh(i,s,o))}else r.trackChildChange(dl(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?de.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var m_=class n{constructor(e){this.indexedFilter_=new Ih(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new ve(t,r))||(r=de.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=de.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(de.EMPTY_NODE);let s=this;return t.forEachChild(ze,(o,a)=>{s.matches(new ve(o,a))||(i=i.updateImmediateChild(o,de.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var wD=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new m_(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new ve(t,r))||(r=de.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=de.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=de.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(de.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,de.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(p,_)=>h(_,p)}else o=this.index_.getCompare();let a=e;B(a.numChildren()===this.limit_,"");let c=new ve(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(a.hasChild(t)){let h=a.getImmediateChild(t),p=i.getChildAfterChild(this.index_,l,this.reverse_);for(;p!=null&&(p.name===t||a.hasChild(p.name));)p=i.getChildAfterChild(this.index_,p,this.reverse_);let _=p==null?1:o(p,c);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(wh(t,r,h)),a.updateImmediateChild(t,r);{s?.trackChildChange(vh(t,h));let b=a.updateImmediateChild(t,de.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(s?.trackChildChange(dl(p.name,p.node)),b.updateImmediateChild(p.name,p.node)):b}}else return r.isEmpty()?e:d&&o(l,c)>=0?(s!=null&&(s.trackChildChange(vh(l.name,l.node)),s.trackChildChange(dl(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,de.EMPTY_NODE)):e}};var Eh=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ze}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return B(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return B(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ms}hasEnd(){return this.endSet_}getIndexEndValue(){return B(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return B(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ki}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return B(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ze}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function RQ(n){return n.loadsAllData()?new Ih(n.getIndex()):n.hasLimit()?new wD(n):new m_(n)}function xQ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function NQ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function ID(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function PQ(n,e,t){let r;return n.index_===ri||t?r=ID(n,e,t):r=ID(n,e,ki),r.startAfterSet_=!0,r}function ED(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function MQ(n,e,t){let r;return n.index_===ri||t?r=ED(n,e,t):r=ED(n,e,Ms),r.endBeforeSet_=!0,r}function k_(n,e){let t=n.copy();return t.index_=e,t}function $V(n){let e={};if(n.isDefault())return e;let t;if(n.index_===ze?t="$priority":n.index_===fS?t="$value":n.index_===ri?t="$key":(B(n.index_ instanceof yh,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=_t(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=_t(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+_t(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=_t(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+_t(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function HV(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==ze&&(e.i=n.index_.toString()),e}var TD=class n extends u_{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Nh("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(B(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=$V(e._queryParams);this.restRequest_(s+".json",c,(l,d)=>{let h=d;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),Zi(this.listens_,o)===a){let p;l?l===401?p="permission_denied":p="rest_error:"+l:p="ok",i(p,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=$V(e._queryParams),r=e._path.toString(),i=new St;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+vi(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=za(a.responseText)}catch{en("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&en("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var bD=class{constructor(){this.rootNode_=de.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function g_(){return{value:null,children:new Map}}function _l(n,e,t){if(_e(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=ge(e);n.children.has(r)||n.children.set(r,g_());let i=n.children.get(r);e=Be(e),_l(i,e,t)}}function CD(n,e){if(_e(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(ze,(r,i)=>{_l(n,new xe(r),i)}),CD(n,e)}}else if(n.children.size>0){let t=ge(e);return e=Be(e),n.children.has(t)&&CD(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function DD(n,e,t){n.value!==null?t(e,n.value):kQ(n,(r,i)=>{let s=new xe(e.toString()+"/"+r);DD(i,s,t)})}function kQ(n,e){n.children.forEach((t,r)=>{e(r,t)})}var SD=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Ot(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var qV=10*1e3,OQ=30*1e3,LQ=5*60*1e3,AD=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new SD(e);let r=qV+(OQ-qV)*Math.random();dh(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Ot(e,(i,s)=>{s>0&&on(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),dh(this.reportStats_.bind(this),Math.floor(Math.random()*2*LQ))}};var ni=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(ni||{});function pS(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function mS(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function gS(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var RD=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=ni.ACK_USER_WRITE,this.source=pS()}operationForChild(e){if(_e(this.path)){if(this.affectedTree.value!=null)return B(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new xe(e));return new n(Re(),t,this.revert)}}else return B(ge(this.path)===e,"operationForChild called for unrelated child."),new n(Be(this.path),this.affectedTree,this.revert)}};var __=class n{constructor(e,t){this.source=e,this.path=t,this.type=ni.LISTEN_COMPLETE}operationForChild(e){return _e(this.path)?new n(this.source,Re()):new n(this.source,Be(this.path))}};var hl=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=ni.OVERWRITE}operationForChild(e){return _e(this.path)?new n(this.source,Re(),this.snap.getImmediateChild(e)):new n(this.source,Be(this.path),this.snap)}};var Th=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=ni.MERGE}operationForChild(e){if(_e(this.path)){let t=this.children.subtree(new xe(e));return t.isEmpty()?null:t.value?new hl(this.source,Re(),t.value):new n(this.source,Re(),t)}else return B(ge(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,Be(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var si=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(_e(e))return this.isFullyInitialized()&&!this.filtered_;let t=ge(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var xD=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function FQ(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(AQ(o.childName,o.snapshotNode))}),uh(n,i,"child_removed",e,r,t),uh(n,i,"child_added",e,r,t),uh(n,i,"child_moved",s,r,t),uh(n,i,"child_changed",e,r,t),uh(n,i,"value",e,r,t),i}function uh(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>UQ(n,a,c)),o.forEach(a=>{let c=VQ(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,n.query_))})})}function VQ(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function UQ(n,e,t){if(e.childName==null||t.childName==null)throw so("Should only compare child_ events.");let r=new ve(e.childName,e.snapshotNode),i=new ve(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function O_(n,e){return{eventCache:n,serverCache:e}}function fh(n,e,t,r){return O_(new si(e,t,r),n.serverCache)}function M2(n,e,t,r){return O_(n.eventCache,new si(e,t,r))}function y_(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Zo(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var XC,jQ=()=>(XC||(XC=new Zn(V7)),XC),pn=class n{constructor(e,t=jQ()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Ot(e,(r,i)=>{t=t.set(new xe(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Re(),value:this.value};if(_e(e))return null;{let r=ge(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Be(e),t);return s!=null?{path:Xe(new xe(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(_e(e))return this;{let t=ge(e),r=this.children.get(t);return r!==null?r.subtree(Be(e)):new n(null)}}set(e,t){if(_e(e))return new n(t,this.children);{let r=ge(e),s=(this.children.get(r)||new n(null)).set(Be(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(_e(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=ge(e),r=this.children.get(t);if(r){let i=r.remove(Be(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(_e(e))return this.value;{let t=ge(e),r=this.children.get(t);return r?r.get(Be(e)):null}}setTree(e,t){if(_e(e))return t;{let r=ge(e),s=(this.children.get(r)||new n(null)).setTree(Be(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Re(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Xe(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Re(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(_e(e))return null;{let s=ge(e),o=this.children.get(s);return o?o.findOnPath_(Be(e),Xe(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Re(),t)}foreachOnPath_(e,t,r){if(_e(e))return this;{this.value&&r(t,this.value);let i=ge(e),s=this.children.get(i);return s?s.foreachOnPath_(Be(e),Xe(t,i),r):new n(null)}}foreach(e){this.foreach_(Re(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Xe(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Er=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new pn(null))}};function ph(n,e,t){if(_e(e))return new Er(new pn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=fn(i,e);return s=s.updateChild(o,t),new Er(n.writeTree_.set(i,s))}else{let i=new pn(t),s=n.writeTree_.setTree(e,i);return new Er(s)}}}function ND(n,e,t){let r=n;return Ot(t,(i,s)=>{r=ph(r,Xe(e,i),s)}),r}function zV(n,e){if(_e(e))return Er.empty();{let t=n.writeTree_.setTree(e,new pn(null));return new Er(t)}}function PD(n,e){return ta(n,e)!=null}function ta(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(fn(t.path,e)):null}function WV(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(ze,(r,i)=>{e.push(new ve(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ve(r,i.value))}),e}function Ns(n,e){if(_e(e))return n;{let t=ta(n,e);return t!=null?new Er(new pn(t)):new Er(n.writeTree_.subtree(e))}}function MD(n){return n.writeTree_.isEmpty()}function fl(n,e){return k2(Re(),n.writeTree_,e)}function k2(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(B(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=k2(Xe(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Xe(n,".priority"),r)),t}}function L_(n,e){return V2(e,n)}function BQ(n,e,t,r,i){B(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=ph(n.visibleWrites,e,t)),n.lastWriteId=r}function $Q(n,e,t,r){B(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=ND(n.visibleWrites,e,t),n.lastWriteId=r}function HQ(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function qQ(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);B(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&zQ(a,r.path)?i=!1:Xn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return WQ(n),!0;if(r.snap)n.visibleWrites=zV(n.visibleWrites,r.path);else{let a=r.children;Ot(a,c=>{n.visibleWrites=zV(n.visibleWrites,Xe(r.path,c))})}return!0}else return!1}function zQ(n,e){if(n.snap)return Xn(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Xn(Xe(n.path,t),e))return!0;return!1}function WQ(n){n.visibleWrites=O2(n.allWrites,GQ,Re()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function GQ(n){return n.visible}function O2(n,e,t){let r=Er.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)Xn(t,o)?(a=fn(t,o),r=ph(r,a,s.snap)):Xn(o,t)&&(a=fn(o,t),r=ph(r,Re(),s.snap.getChild(a)));else if(s.children){if(Xn(t,o))a=fn(t,o),r=ND(r,a,s.children);else if(Xn(o,t))if(a=fn(o,t),_e(a))r=ND(r,Re(),s.children);else{let c=Zi(s.children,ge(a));if(c){let l=c.getChild(Be(a));r=ph(r,Re(),l)}}}else throw so("WriteRecord should have .snap or .children")}}return r}function L2(n,e,t,r,i){if(!r&&!i){let s=ta(n.visibleWrites,e);if(s!=null)return s;{let o=Ns(n.visibleWrites,e);if(MD(o))return t;if(t==null&&!PD(o,Re()))return null;{let a=t||de.EMPTY_NODE;return fl(o,a)}}}else{let s=Ns(n.visibleWrites,e);if(!i&&MD(s))return t;if(!i&&t==null&&!PD(s,Re()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(Xn(l.path,e)||Xn(e,l.path))},a=O2(n.allWrites,o,e),c=t||de.EMPTY_NODE;return fl(a,c)}}}function KQ(n,e,t){let r=de.EMPTY_NODE,i=ta(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ze,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=Ns(n.visibleWrites,e);return t.forEachChild(ze,(o,a)=>{let c=fl(Ns(s,new xe(o)),a);r=r.updateImmediateChild(o,c)}),WV(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Ns(n.visibleWrites,e);return WV(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function QQ(n,e,t,r,i){B(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Xe(e,t);if(PD(n.visibleWrites,s))return null;{let o=Ns(n.visibleWrites,s);return MD(o)?i.getChild(t):fl(o,i.getChild(t))}}function YQ(n,e,t,r){let i=Xe(e,t),s=ta(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=Ns(n.visibleWrites,i);return fl(o,r.getNode().getImmediateChild(t))}else return null}function JQ(n,e){return ta(n.visibleWrites,e)}function XQ(n,e,t,r,i,s,o){let a,c=Ns(n.visibleWrites,e),l=ta(c,Re());if(l!=null)a=l;else if(t!=null)a=fl(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),p=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),_=p.getNext();for(;_&&d.length<i;)h(_,r)!==0&&d.push(_),_=p.getNext();return d}else return[]}function ZQ(){return{visibleWrites:Er.empty(),allWrites:[],lastWriteId:-1}}function v_(n,e,t,r){return L2(n.writeTree,n.treePath,e,t,r)}function _S(n,e){return KQ(n.writeTree,n.treePath,e)}function GV(n,e,t,r){return QQ(n.writeTree,n.treePath,e,t,r)}function w_(n,e){return JQ(n.writeTree,Xe(n.treePath,e))}function eY(n,e,t,r,i,s){return XQ(n.writeTree,n.treePath,e,t,r,i,s)}function yS(n,e,t){return YQ(n.writeTree,n.treePath,e,t)}function F2(n,e){return V2(Xe(n.treePath,e),n.writeTree)}function V2(n,e){return{treePath:n,writeTree:e}}var kD=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;B(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),B(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,wh(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,vh(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,dl(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,wh(r,e.snapshotNode,i.oldSnap));else throw so("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var OD=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},U2=new OD,bh=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new si(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return yS(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Zo(this.viewCache_),s=eY(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function tY(n){return{filter:n}}function nY(n,e){B(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),B(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function rY(n,e,t,r,i){let s=new kD,o,a;if(t.type===ni.OVERWRITE){let l=t;l.source.fromUser?o=LD(n,e,l.path,l.snap,r,i,s):(B(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!_e(l.path),o=I_(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===ni.MERGE){let l=t;l.source.fromUser?o=sY(n,e,l.path,l.children,r,i,s):(B(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=FD(n,e,l.path,l.children,r,i,a,s))}else if(t.type===ni.ACK_USER_WRITE){let l=t;l.revert?o=cY(n,e,l.path,r,i,s):o=oY(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===ni.LISTEN_COMPLETE)o=aY(n,e,t.path,r,s);else throw so("Unknown operation type: "+t.type);let c=s.getChanges();return iY(e,o,c),{viewCache:o,changes:c}}function iY(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=y_(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(P2(y_(e)))}}function j2(n,e,t,r,i,s){let o=e.eventCache;if(w_(r,t)!=null)return e;{let a,c;if(_e(t))if(B(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Zo(e),d=l instanceof de?l:de.EMPTY_NODE,h=_S(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let l=v_(r,Zo(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=ge(t);if(l===".priority"){B(ks(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let h=GV(r,t,d,c);h!=null?a=n.filter.updatePriority(d,h):a=o.getNode()}else{let d=Be(t),h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let p=GV(r,t,o.getNode(),c);p!=null?h=o.getNode().getImmediateChild(l).updateChild(d,p):h=o.getNode().getImmediateChild(l)}else h=yS(r,l,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),l,h,d,i,s):a=o.getNode()}}return fh(e,a,o.isFullyInitialized()||_e(t),n.filter.filtersNodes())}}function I_(n,e,t,r,i,s,o,a){let c=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(_e(t))l=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(t,r);l=d.updateFullNode(c.getNode(),_,null)}else{let _=ge(t);if(!c.isCompleteForPath(t)&&ks(t)>1)return e;let w=Be(t),R=c.getNode().getImmediateChild(_).updateChild(w,r);_===".priority"?l=d.updatePriority(c.getNode(),R):l=d.updateChild(c.getNode(),_,R,w,U2,null)}let h=M2(e,l,c.isFullyInitialized()||_e(t),d.filtersNodes()),p=new bh(i,h,s);return j2(n,h,t,i,p,a)}function LD(n,e,t,r,i,s,o){let a=e.eventCache,c,l,d=new bh(i,e,s);if(_e(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=fh(e,l,!0,n.filter.filtersNodes());else{let h=ge(t);if(h===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),c=fh(e,l,a.isFullyInitialized(),a.isFiltered());else{let p=Be(t),_=a.getNode().getImmediateChild(h),w;if(_e(p))w=r;else{let b=d.getCompleteChild(h);b!=null?lS(p)===".priority"&&b.getChild(D2(p)).isEmpty()?w=b:w=b.updateChild(p,r):w=de.EMPTY_NODE}if(_.equals(w))c=e;else{let b=n.filter.updateChild(a.getNode(),h,w,p,d,o);c=fh(e,b,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function KV(n,e){return n.eventCache.isCompleteForChild(e)}function sY(n,e,t,r,i,s,o){let a=e;return r.foreach((c,l)=>{let d=Xe(t,c);KV(e,ge(d))&&(a=LD(n,a,d,l,i,s,o))}),r.foreach((c,l)=>{let d=Xe(t,c);KV(e,ge(d))||(a=LD(n,a,d,l,i,s,o))}),a}function QV(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function FD(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;_e(t)?l=r:l=new pn(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((h,p)=>{if(d.hasChild(h)){let _=e.serverCache.getNode().getImmediateChild(h),w=QV(n,_,p);c=I_(n,c,new xe(h),w,i,s,o,a)}}),l.children.inorderTraversal((h,p)=>{let _=!e.serverCache.isCompleteForChild(h)&&p.value===null;if(!d.hasChild(h)&&!_){let w=e.serverCache.getNode().getImmediateChild(h),b=QV(n,w,p);c=I_(n,c,new xe(h),b,i,s,o,a)}}),c}function oY(n,e,t,r,i,s,o){if(w_(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(_e(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return I_(n,e,t,c.getNode().getChild(t),i,s,a,o);if(_e(t)){let l=new pn(null);return c.getNode().forEachChild(ri,(d,h)=>{l=l.set(new xe(d),h)}),FD(n,e,t,l,i,s,a,o)}else return e}else{let l=new pn(null);return r.foreach((d,h)=>{let p=Xe(t,d);c.isCompleteForPath(p)&&(l=l.set(d,c.getNode().getChild(p)))}),FD(n,e,t,l,i,s,a,o)}}function aY(n,e,t,r,i){let s=e.serverCache,o=M2(e,s.getNode(),s.isFullyInitialized()||_e(t),s.isFiltered());return j2(n,o,t,r,U2,i)}function cY(n,e,t,r,i,s){let o;if(w_(r,t)!=null)return e;{let a=new bh(r,e,i),c=e.eventCache.getNode(),l;if(_e(t)||ge(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=v_(r,Zo(e));else{let h=e.serverCache.getNode();B(h instanceof de,"serverChildren would be complete if leaf node"),d=_S(r,h)}d=d,l=n.filter.updateFullNode(c,d,s)}else{let d=ge(t),h=yS(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?l=n.filter.updateChild(c,d,h,Be(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(c,d,de.EMPTY_NODE,Be(t),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=v_(r,Zo(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||w_(r,Re())!=null,fh(e,l,o,n.filter.filtersNodes())}}var VD=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Ih(r.getIndex()),s=RQ(r);this.processor_=tY(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(de.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(de.EMPTY_NODE,a.getNode(),null),d=new si(c,o.isFullyInitialized(),i.filtersNodes()),h=new si(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=O_(h,d),this.eventGenerator_=new xD(this.query_)}get query(){return this.query_}};function lY(n){return n.viewCache_.serverCache.getNode()}function uY(n){return y_(n.viewCache_)}function dY(n,e){let t=Zo(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!_e(e)&&!t.getImmediateChild(ge(e)).isEmpty())?t.getChild(e):null}function YV(n){return n.eventRegistrations_.length===0}function hY(n,e){n.eventRegistrations_.push(e)}function JV(n,e,t){let r=[];if(t){B(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function XV(n,e,t,r){e.type===ni.MERGE&&e.source.queryId!==null&&(B(Zo(n.viewCache_),"We should always have a full cache before handling merges"),B(y_(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=rY(n.processor_,i,e,t,r);return nY(n.processor_,s.viewCache),B(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,B2(n,s.changes,s.viewCache.eventCache.getNode(),null)}function fY(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(ze,(s,o)=>{r.push(dl(s,o))}),t.isFullyInitialized()&&r.push(P2(t.getNode())),B2(n,r,t.getNode(),e)}function B2(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return FQ(n.eventGenerator_,e,t,i)}var E_,T_=class{constructor(){this.views=new Map}};function pY(n){B(!E_,"__referenceConstructor has already been defined"),E_=n}function mY(){return B(E_,"Reference.ts has not been loaded"),E_}function gY(n){return n.views.size===0}function vS(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return B(s!=null,"SyncTree gave us an op for an invalid query."),XV(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(XV(o,e,t,r));return s}}function $2(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=v_(t,i?r:null),c=!1;a?c=!0:r instanceof de?(a=_S(t,r),c=!1):(a=de.EMPTY_NODE,c=!1);let l=O_(new si(a,c,!1),new si(r,i,!1));return new VD(e,l)}return o}function _Y(n,e,t,r,i,s){let o=$2(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),hY(o,t),fY(o,t)}function yY(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=Os(n);if(i==="default")for(let[c,l]of n.views.entries())o=o.concat(JV(l,t,r)),YV(l)&&(n.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=n.views.get(i);c&&(o=o.concat(JV(c,t,r)),YV(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!Os(n)&&s.push(new(mY())(e._repo,e._path)),{removed:s,events:o}}function H2(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Ps(n,e){let t=null;for(let r of n.views.values())t=t||dY(r,e);return t}function q2(n,e){if(e._queryParams.loadsAllData())return F_(n);{let r=e._queryIdentifier;return n.views.get(r)}}function z2(n,e){return q2(n,e)!=null}function Os(n){return F_(n)!=null}function F_(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var b_;function vY(n){B(!b_,"__referenceConstructor has already been defined"),b_=n}function wY(){return B(b_,"Reference.ts has not been loaded"),b_}var IY=1,C_=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new pn(null),this.pendingWriteTree_=ZQ(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function wS(n,e,t,r,i){return BQ(n.pendingWriteTree_,e,t,r,i),i?yl(n,new hl(pS(),e,t)):[]}function EY(n,e,t,r){$Q(n.pendingWriteTree_,e,t,r);let i=pn.fromObject(t);return yl(n,new Th(pS(),e,i))}function xs(n,e,t=!1){let r=HQ(n.pendingWriteTree_,e);if(qQ(n.pendingWriteTree_,e)){let s=new pn(null);return r.snap!=null?s=s.set(Re(),!0):Ot(r.children,o=>{s=s.set(new xe(o),!0)}),yl(n,new RD(r.path,s,t))}else return[]}function Mh(n,e,t){return yl(n,new hl(mS(),e,t))}function TY(n,e,t){let r=pn.fromObject(t);return yl(n,new Th(mS(),e,r))}function bY(n,e){return yl(n,new __(mS(),e))}function CY(n,e,t){let r=IS(n,t);if(r){let i=ES(r),s=i.path,o=i.queryId,a=fn(s,e),c=new __(gS(o),a);return TS(n,s,c)}else return[]}function D_(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||z2(o,e))){let c=yY(o,e,t,r);gY(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let d=l.findIndex(p=>p._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(p,_)=>Os(_));if(d&&!h){let p=n.syncPointTree_.subtree(s);if(!p.isEmpty()){let _=AY(p);for(let w=0;w<_.length;++w){let b=_[w],R=b.query,L=Q2(n,b);n.listenProvider_.startListening(mh(R),Ch(n,R),L.hashFn,L.onComplete)}}}!h&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(mh(e),null):l.forEach(p=>{let _=n.queryToTagMap.get(U_(p));n.listenProvider_.stopListening(mh(p),_)}))}RY(n,l)}return a}function W2(n,e,t,r){let i=IS(n,r);if(i!=null){let s=ES(i),o=s.path,a=s.queryId,c=fn(o,e),l=new hl(gS(a),c,t);return TS(n,o,l)}else return[]}function DY(n,e,t,r){let i=IS(n,r);if(i){let s=ES(i),o=s.path,a=s.queryId,c=fn(o,e),l=pn.fromObject(t),d=new Th(gS(a),c,l);return TS(n,o,d)}else return[]}function UD(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(p,_)=>{let w=fn(p,i);s=s||Ps(_,w),o=o||Os(_)});let a=n.syncPointTree_.get(i);a?(o=o||Os(a),s=s||Ps(a,Re())):(a=new T_,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=de.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,w)=>{let b=Ps(w,Re());b&&(s=s.updateImmediateChild(_,b))}));let l=z2(a,e);if(!l&&!e._queryParams.loadsAllData()){let p=U_(e);B(!n.queryToTagMap.has(p),"View does not exist, but we have a tag");let _=xY();n.queryToTagMap.set(p,_),n.tagToQueryMap.set(_,p)}let d=L_(n.pendingWriteTree_,i),h=_Y(a,e,t,d,s,c);if(!l&&!o&&!r){let p=q2(a,e);h=h.concat(NY(n,e,p))}return h}function V_(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=fn(o,e),l=Ps(a,c);if(l)return l});return L2(i,e,s,t,!0)}function SY(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{let h=fn(l,t);r=r||Ps(d,h)});let i=n.syncPointTree_.get(t);i?r=r||Ps(i,Re()):(i=new T_,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new si(r,!0,!1):null,a=L_(n.pendingWriteTree_,e._path),c=$2(i,e,a,s?o.getNode():de.EMPTY_NODE,s);return uY(c)}function yl(n,e){return G2(e,n.syncPointTree_,null,L_(n.pendingWriteTree_,Re()))}function G2(n,e,t,r){if(_e(n.path))return K2(n,e,t,r);{let i=e.get(Re());t==null&&i!=null&&(t=Ps(i,Re()));let s=[],o=ge(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,d=F2(r,o);s=s.concat(G2(a,c,l,d))}return i&&(s=s.concat(vS(i,n,r,t))),s}}function K2(n,e,t,r){let i=e.get(Re());t==null&&i!=null&&(t=Ps(i,Re()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=F2(r,o),d=n.operationForChild(o);d&&(s=s.concat(K2(d,a,c,l)))}),i&&(s=s.concat(vS(i,n,r,t))),s}function Q2(n,e){let t=e.query,r=Ch(n,t);return{hashFn:()=>(lY(e)||de.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?CY(n,t._path,r):bY(n,t._path);{let s=B7(i,t);return D_(n,t,null,s)}}}}function Ch(n,e){let t=U_(e);return n.queryToTagMap.get(t)}function U_(n){return n._path.toString()+"$"+n._queryIdentifier}function IS(n,e){return n.tagToQueryMap.get(e)}function ES(n){let e=n.indexOf("$");return B(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new xe(n.substr(0,e))}}function TS(n,e,t){let r=n.syncPointTree_.get(e);B(r,"Missing sync point for query tag that we're tracking");let i=L_(n.pendingWriteTree_,e);return vS(r,t,i,null)}function AY(n){return n.fold((e,t,r)=>{if(t&&Os(t))return[F_(t)];{let i=[];return t&&(i=H2(t)),Ot(r,(s,o)=>{i=i.concat(o)}),i}})}function mh(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(wY())(n._repo,n._path):n}function RY(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=U_(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function xY(){return IY++}function NY(n,e,t){let r=e._path,i=Ch(n,e),s=Q2(n,t),o=n.listenProvider_.startListening(mh(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)B(!Os(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,d,h)=>{if(!_e(l)&&d&&Os(d))return[F_(d).query];{let p=[];return d&&(p=p.concat(H2(d).map(_=>_.query))),Ot(h,(_,w)=>{p=p.concat(w)}),p}});for(let l=0;l<c.length;++l){let d=c[l];n.listenProvider_.stopListening(mh(d),Ch(n,d))}}return o}var jD=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},BD=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=Xe(this.path_,e);return new n(this.syncTree_,t)}node(){return V_(this.syncTree_,this.path_)}},PY=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},ZV=function(n,e,t){if(!n||typeof n!="object")return n;if(B(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return MY(n[".sv"],e,t);if(typeof n[".sv"]=="object")return kY(n[".sv"],e);B(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},MY=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:B(!1,"Unexpected server value: "+n)}},kY=function(n,e,t){n.hasOwnProperty("increment")||B(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&B(!1,"Unexpected increment value: "+r);let i=e.node();if(B(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},Y2=function(n,e,t,r){return CS(e,new BD(t,n),r)},bS=function(n,e,t){return CS(n,new jD(e),t)};function CS(n,e,t){let r=n.getPriority().val(),i=ZV(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=ZV(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new ll(a,nt(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new ll(i))),o.forEachChild(ze,(a,c)=>{let l=CS(c,e.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var Dh=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function j_(n,e){let t=e instanceof xe?e:new xe(e),r=n,i=ge(t);for(;i!==null;){let s=Zi(r.node.children,i)||{children:{},childCount:0};r=new Dh(i,r,s),t=Be(t),i=ge(t)}return r}function na(n){return n.node.value}function DS(n,e){n.node.value=e,$D(n)}function J2(n){return n.node.childCount>0}function OY(n){return na(n)===void 0&&!J2(n)}function B_(n,e){Ot(n.node.children,(t,r)=>{e(new Dh(t,n,r))})}function X2(n,e,t,r){t&&!r&&e(n),B_(n,i=>{X2(i,e,!0,r)}),t&&r&&e(n)}function LY(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function kh(n){return new xe(n.parent===null?n.name:kh(n.parent)+"/"+n.name)}function $D(n){n.parent!==null&&FY(n.parent,n.name,n)}function FY(n,e,t){let r=OY(t),i=on(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,$D(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,$D(n))}var VY=/[\[\].#$\/\u0000-\u001F\u007F]/,UY=/[\[\].#$\u0000-\u001F\u007F]/,ZC=10*1024*1024,$_=function(n){return typeof n=="string"&&n.length!==0&&!VY.test(n)},Z2=function(n){return typeof n=="string"&&n.length!==0&&!UY.test(n)},jY=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Z2(n)},Sh=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!M_(n)||n&&typeof n=="object"&&on(n,".sv")},oi=function(n,e,t,r){r&&e===void 0||Oh(Qt(n,"value"),e,t)},Oh=function(n,e,t){let r=t instanceof xe?new hD(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Yo(r));if(typeof e=="function")throw new Error(n+"contains a function "+Yo(r)+" with contents = "+e.toString());if(M_(e))throw new Error(n+"contains "+e.toString()+" "+Yo(r));if(typeof e=="string"&&e.length>ZC/3&&Bu(e)>ZC)throw new Error(n+"contains a string greater than "+ZC+" utf8 bytes "+Yo(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Ot(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!$_(o)))throw new Error(n+" contains an invalid key ("+o+") "+Yo(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);gQ(r,o),Oh(n,a,r),_Q(r)}),i&&s)throw new Error(n+' contains ".value" child '+Yo(r)+" in addition to actual children.")}},BY=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=_h(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!$_(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(mQ);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&Xn(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},eU=function(n,e,t,r){if(r&&e===void 0)return;let i=Qt(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Ot(e,(o,a)=>{let c=new xe(o);if(Oh(i,a,Xe(t,c)),lS(c)===".priority"&&!Sh(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),BY(i,s)},SS=function(n,e,t){if(!(t&&e===void 0)){if(M_(e))throw new Error(Qt(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Sh(e))throw new Error(Qt(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Lh=function(n,e,t,r){if(!(r&&t===void 0)&&!$_(t))throw new Error(Qt(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},vl=function(n,e,t,r){if(!(r&&t===void 0)&&!Z2(t))throw new Error(Qt(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},$Y=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),vl(n,e,t,r)},kn=function(n,e){if(ge(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},tU=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!$_(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!jY(t))throw new Error(Qt(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var HD=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function H_(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!uS(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function nU(n,e,t){H_(n,t),rU(n,r=>uS(r,e))}function On(n,e,t){H_(n,t),rU(n,r=>Xn(r,e)||Xn(e,r))}function rU(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(HY(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function HY(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Xo&&kt("event: "+t.toString()),gl(r)}}}var iU="repo_interrupt",qY=25,qD=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new HD,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=g_(),this.transactionQueueTree_=new Dh,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function zY(n,e,t){if(n.stats_=cS(n.repoInfo_),n.forceRestClient_||z7())n.server_=new TD(n.repoInfo_,(r,i,s,o)=>{e2(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>t2(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{_t(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new dS(n.repoInfo_,e,(r,i,s,o)=>{e2(n,r,i,s,o)},r=>{t2(n,r)},r=>{WY(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=G7(n.repoInfo_,()=>new AD(n.stats_,n.server_)),n.infoData_=new bD,n.infoSyncTree_=new C_({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=Mh(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),AS(n,"connected",!1),n.serverSyncTree_=new C_({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);On(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function sU(n){let t=n.infoData_.getNode(new xe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Fh(n){return PY({timestamp:sU(n)})}function e2(n,e,t,r,i){n.dataUpdateCount++;let s=new xe(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=ju(t,l=>nt(l));o=DY(n.serverSyncTree_,s,c,i)}else{let c=nt(t);o=W2(n.serverSyncTree_,s,c,i)}else if(r){let c=ju(t,l=>nt(l));o=TY(n.serverSyncTree_,s,c)}else{let c=nt(t);o=Mh(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=pl(n,s)),On(n.eventQueue_,a,o)}function t2(n,e){AS(n,"connected",e),e===!1&&QY(n)}function WY(n,e){Ot(e,(t,r)=>{AS(n,t,r)})}function AS(n,e,t){let r=new xe("/.info/"+e),i=nt(t);n.infoData_.updateSnapshot(r,i);let s=Mh(n.infoSyncTree_,r,i);On(n.eventQueue_,r,s)}function q_(n){return n.nextWriteId_++}function GY(n,e,t){let r=SY(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=nt(i).withIndex(e._queryParams.getIndex());UD(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=Mh(n.serverSyncTree_,e._path,s);else{let a=Ch(n.serverSyncTree_,e);o=W2(n.serverSyncTree_,e._path,s,a)}return On(n.eventQueue_,e._path,o),D_(n.serverSyncTree_,e,t,null,!0),s},i=>(wl(n,"get for query "+_t(e)+" failed: "+i),Promise.reject(new Error(i))))}function RS(n,e,t,r,i){wl(n,"set",{path:e.toString(),value:t,priority:r});let s=Fh(n),o=nt(t,r),a=V_(n.serverSyncTree_,e),c=bS(o,a,s),l=q_(n),d=wS(n.serverSyncTree_,e,c,l,!0);H_(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(p,_)=>{let w=p==="ok";w||en("set at "+e+" failed: "+p);let b=xs(n.serverSyncTree_,l,!w);On(n.eventQueue_,e,b),Ls(n,i,p,_)});let h=NS(n,e);pl(n,h),On(n.eventQueue_,h,[])}function KY(n,e,t,r){wl(n,"update",{path:e.toString(),value:t});let i=!0,s=Fh(n),o={};if(Ot(t,(a,c)=>{i=!1,o[a]=Y2(Xe(e,a),nt(c),n.serverSyncTree_,s)}),i)kt("update() called with empty data.  Don't do anything."),Ls(n,r,"ok",void 0);else{let a=q_(n),c=EY(n.serverSyncTree_,e,o,a);H_(n.eventQueue_,c),n.server_.merge(e.toString(),t,(l,d)=>{let h=l==="ok";h||en("update at "+e+" failed: "+l);let p=xs(n.serverSyncTree_,a,!h),_=p.length>0?pl(n,e):e;On(n.eventQueue_,_,p),Ls(n,r,l,d)}),Ot(t,l=>{let d=NS(n,Xe(e,l));pl(n,d)}),On(n.eventQueue_,e,[])}}function QY(n){wl(n,"onDisconnectEvents");let e=Fh(n),t=g_();DD(n.onDisconnect_,Re(),(i,s)=>{let o=Y2(i,s,n.serverSyncTree_,e);_l(t,i,o)});let r=[];DD(t,Re(),(i,s)=>{r=r.concat(Mh(n.serverSyncTree_,i,s));let o=NS(n,i);pl(n,o)}),n.onDisconnect_=g_(),On(n.eventQueue_,Re(),r)}function YY(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&CD(n.onDisconnect_,e),Ls(n,t,r,i)})}function n2(n,e,t,r){let i=nt(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&_l(n.onDisconnect_,e,i),Ls(n,r,s,o)})}function JY(n,e,t,r,i){let s=nt(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&_l(n.onDisconnect_,e,s),Ls(n,i,o,a)})}function XY(n,e,t,r){if(Ka(t)){kt("onDisconnect().update() called with empty data.  Don't do anything."),Ls(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Ot(t,(o,a)=>{let c=nt(a);_l(n.onDisconnect_,Xe(e,o),c)}),Ls(n,r,i,s)})}function ZY(n,e,t){let r;ge(e._path)===".info"?r=UD(n.infoSyncTree_,e,t):r=UD(n.serverSyncTree_,e,t),nU(n.eventQueue_,e._path,r)}function zD(n,e,t){let r;ge(e._path)===".info"?r=D_(n.infoSyncTree_,e,t):r=D_(n.serverSyncTree_,e,t),nU(n.eventQueue_,e._path,r)}function oU(n){n.persistentConnection_&&n.persistentConnection_.interrupt(iU)}function eJ(n){n.persistentConnection_&&n.persistentConnection_.resume(iU)}function wl(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),kt(t,...e)}function Ls(n,e,t,r){e&&gl(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function tJ(n,e,t,r,i,s){wl(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:s2(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=xS(n,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Oh("transaction failed: Data returned ",c,o.path),o.status=0;let l=j_(n.transactionQueueTree_,e),d=na(l)||[];d.push(o),DS(l,d);let h;typeof c=="object"&&c!==null&&on(c,".priority")?(h=Zi(c,".priority"),B(Sh(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(V_(n.serverSyncTree_,e)||de.EMPTY_NODE).getPriority().val();let p=Fh(n),_=nt(c,h),w=bS(_,a,p);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=w,o.currentWriteId=q_(n);let b=wS(n.serverSyncTree_,e,w,o.currentWriteId,o.applyLocally);On(n.eventQueue_,e,b),z_(n,n.transactionQueueTree_)}}function xS(n,e,t){return V_(n.serverSyncTree_,e,t)||de.EMPTY_NODE}function z_(n,e=n.transactionQueueTree_){if(e||W_(n,e),na(e)){let t=cU(n,e);B(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&nJ(n,kh(e),t)}else J2(e)&&B_(e,t=>{z_(n,t)})}function nJ(n,e,t){let r=t.map(l=>l.currentWriteId),i=xS(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];B(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=fn(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,l=>{wl(n,"transaction put response",{path:c.toString(),status:l});let d=[];if(l==="ok"){let h=[];for(let p=0;p<t.length;p++)t[p].status=2,d=d.concat(xs(n.serverSyncTree_,t[p].currentWriteId)),t[p].onComplete&&h.push(()=>t[p].onComplete(null,!0,t[p].currentOutputSnapshotResolved)),t[p].unwatcher();W_(n,j_(n.transactionQueueTree_,e)),z_(n,n.transactionQueueTree_),On(n.eventQueue_,e,d);for(let p=0;p<h.length;p++)gl(h[p])}else{if(l==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{en("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=l}pl(n,e)}},o)}function pl(n,e){let t=aU(n,e),r=kh(t),i=cU(n,t);return rJ(n,i,r),r}function rJ(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=fn(t,c.path),d=!1,h;if(B(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,i=i.concat(xs(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=qY)d=!0,h="maxretry",i=i.concat(xs(n.serverSyncTree_,c.currentWriteId,!0));else{let p=xS(n,c.path,o);c.currentInputSnapshot=p;let _=e[a].update(p.val());if(_!==void 0){Oh("transaction failed: Data returned ",_,c.path);let w=nt(_);typeof _=="object"&&_!=null&&on(_,".priority")||(w=w.updatePriority(p.getPriority()));let R=c.currentWriteId,L=Fh(n),H=bS(w,p,L);c.currentOutputSnapshotRaw=w,c.currentOutputSnapshotResolved=H,c.currentWriteId=q_(n),o.splice(o.indexOf(R),1),i=i.concat(wS(n.serverSyncTree_,c.path,H,c.currentWriteId,c.applyLocally)),i=i.concat(xs(n.serverSyncTree_,R,!0))}else d=!0,h="nodata",i=i.concat(xs(n.serverSyncTree_,c.currentWriteId,!0))}On(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}W_(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)gl(r[a]);z_(n,n.transactionQueueTree_)}function aU(n,e){let t,r=n.transactionQueueTree_;for(t=ge(e);t!==null&&na(r)===void 0;)r=j_(r,t),e=Be(e),t=ge(e);return r}function cU(n,e){let t=[];return lU(n,e,t),t.sort((r,i)=>r.order-i.order),t}function lU(n,e,t){let r=na(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);B_(e,i=>{lU(n,i,t)})}function W_(n,e){let t=na(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,DS(e,t.length>0?t:void 0)}B_(e,r=>{W_(n,r)})}function NS(n,e){let t=kh(aU(n,e)),r=j_(n.transactionQueueTree_,e);return LY(r,i=>{eD(n,i)}),eD(n,r),X2(r,i=>{eD(n,i)}),t}function eD(n,e){let t=na(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(B(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(B(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(xs(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?DS(e,void 0):t.length=s+1,On(n.eventQueue_,kh(e),i);for(let o=0;o<r.length;o++)gl(r[o])}}function iJ(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function sJ(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):en(`Invalid query segment '${t}' in query '${n}'`)}return e}var WD=function(n,e){let t=oJ(n),r=t.namespace;t.domain==="firebase.com"&&ii(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&ii("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||L7();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new c_(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new xe(t.pathString)}},oJ=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=iJ(n.substring(d,h)));let p=sJ(n.substring(Math.min(n.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let _=e.slice(0,l);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{let w=e.indexOf(".");r=e.substring(0,w).toLowerCase(),t=e.substring(w+1),s=r}"ns"in p&&(s=p.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var r2="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",aJ=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=r2.charAt(t%64),t=Math.floor(t/64);B(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=r2.charAt(e[i]);return B(o.length===20,"nextPushId: Length should be 20."),o}}();var S_=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+_t(this.snapshot.exportVal())}},A_=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Ah=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return B(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var R_=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new St;return YY(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){kn("OnDisconnect.remove",this._path);let e=new St;return n2(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){kn("OnDisconnect.set",this._path),oi("OnDisconnect.set",e,this._path,!1);let t=new St;return n2(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){kn("OnDisconnect.setWithPriority",this._path),oi("OnDisconnect.setWithPriority",e,this._path,!1),SS("OnDisconnect.setWithPriority",t,!1);let r=new St;return JY(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){kn("OnDisconnect.update",this._path),eU("OnDisconnect.update",e,this._path,!1);let t=new St;return XY(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var mn=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return _e(this._path)?null:lS(this._path)}get ref(){return new Ln(this._repo,this._path)}get _queryIdentifier(){let e=HV(this._queryParams),t=aS(e);return t==="{}"?"default":t}get _queryObject(){return HV(this._queryParams)}isEqual(e){if(e=z(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=uS(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+pQ(this._path)}};function G_(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Vs(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===ri){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Ms)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==ki)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===ze){if(e!=null&&!Sh(e)||t!=null&&!Sh(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(B(n.getIndex()instanceof yh||n.getIndex()===fS,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function K_(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Ln=class n extends mn{constructor(e,t){super(e,t,new Eh,!1)}get parent(){let e=D2(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},ml=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new xe(e),r=Fs(this.ref,e);return new n(this._node.getChild(t),r,ze)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,Fs(this.ref,r),ze)))}hasChild(e){let t=new xe(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function PS(n,e){return n=z(n),n._checkNotDeleted("ref"),e!==void 0?Fs(n._root,e):n._root}function MS(n,e){n=z(n),n._checkNotDeleted("refFromURL");let t=WD(e,n._repo.repoInfo_.nodeAdmin);tU("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&ii("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),PS(n,t.path.toString())}function Fs(n,e){return n=z(n),ge(n._path)===null?$Y("child","path",e,!1):vl("child","path",e,!1),new Ln(n._repo,Xe(n._path,e))}function uU(n,e){n=z(n),kn("push",n._path),oi("push",e,n._path,!0);let t=sU(n._repo),r=aJ(t),i=Fs(n,r),s=Fs(n,r),o;return e!=null?o=Q_(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function dU(n){return kn("remove",n._path),Q_(n,null)}function Q_(n,e){n=z(n),kn("set",n._path),oi("set",e,n._path,!1);let t=new St;return RS(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function hU(n,e){n=z(n),kn("setPriority",n._path),SS("setPriority",e,!1);let t=new St;return RS(n._repo,Xe(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function fU(n,e,t){if(kn("setWithPriority",n._path),oi("setWithPriority",e,n._path,!1),SS("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new St;return RS(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function pU(n,e){eU("update",e,n._path,!1);let t=new St;return KY(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function mU(n){n=z(n);let e=new Ah(()=>{}),t=new Rh(e);return GY(n._repo,n,t).then(r=>new ml(r,new Ln(n._repo,n._path),n._queryParams.getIndex()))}var Rh=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new S_("value",this,new ml(e.snapshotNode,new Ln(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new A_(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},x_=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new A_(this,e,t):null}createEvent(e,t){B(e.childName!=null,"Child events should have a childName.");let r=Fs(new Ln(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new S_(e.type,this,new ml(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Vh(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,l=(d,h)=>{zD(n._repo,n,a),c(d,h)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new Ah(t,s||void 0),a=e==="value"?new Rh(o):new x_(e,o);return ZY(n._repo,n,a),()=>zD(n._repo,n,a)}function Y_(n,e,t,r){return Vh(n,"value",e,t,r)}function kS(n,e,t,r){return Vh(n,"child_added",e,t,r)}function OS(n,e,t,r){return Vh(n,"child_changed",e,t,r)}function LS(n,e,t,r){return Vh(n,"child_moved",e,t,r)}function FS(n,e,t,r){return Vh(n,"child_removed",e,t,r)}function VS(n,e,t){let r=null,i=t?new Ah(t):null;e==="value"?r=new Rh(i):e&&(r=new x_(e,i)),zD(n._repo,n,r)}var Fn=class{},N_=class extends Fn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){oi("endAt",this._value,e._path,!0);let t=ED(e._queryParams,this._value,this._key);if(K_(t),Vs(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new mn(e._repo,e._path,t,e._orderByCalled)}};function gU(n,e){return Lh("endAt","key",e,!0),new N_(n,e)}var GD=class extends Fn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){oi("endBefore",this._value,e._path,!1);let t=MQ(e._queryParams,this._value,this._key);if(K_(t),Vs(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new mn(e._repo,e._path,t,e._orderByCalled)}};function _U(n,e){return Lh("endBefore","key",e,!0),new GD(n,e)}var P_=class extends Fn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){oi("startAt",this._value,e._path,!0);let t=ID(e._queryParams,this._value,this._key);if(K_(t),Vs(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new mn(e._repo,e._path,t,e._orderByCalled)}};function yU(n=null,e){return Lh("startAt","key",e,!0),new P_(n,e)}var KD=class extends Fn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){oi("startAfter",this._value,e._path,!1);let t=PQ(e._queryParams,this._value,this._key);if(K_(t),Vs(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new mn(e._repo,e._path,t,e._orderByCalled)}};function vU(n,e){return Lh("startAfter","key",e,!0),new KD(n,e)}var QD=class extends Fn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new mn(e._repo,e._path,xQ(e._queryParams,this._limit),e._orderByCalled)}};function wU(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new QD(n)}var YD=class extends Fn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new mn(e._repo,e._path,NQ(e._queryParams,this._limit),e._orderByCalled)}};function IU(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new YD(n)}var JD=class extends Fn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){G_(e,"orderByChild");let t=new xe(this._path);if(_e(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new yh(t),i=k_(e._queryParams,r);return Vs(i),new mn(e._repo,e._path,i,!0)}};function EU(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return vl("orderByChild","path",n,!1),new JD(n)}var XD=class extends Fn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){G_(e,"orderByKey");let t=k_(e._queryParams,ri);return Vs(t),new mn(e._repo,e._path,t,!0)}};function TU(){return new XD}var ZD=class extends Fn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){G_(e,"orderByPriority");let t=k_(e._queryParams,ze);return Vs(t),new mn(e._repo,e._path,t,!0)}};function bU(){return new ZD}var eS=class extends Fn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){G_(e,"orderByValue");let t=k_(e._queryParams,fS);return Vs(t),new mn(e._repo,e._path,t,!0)}};function CU(){return new eS}var tS=class extends Fn{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(oi("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new N_(this._value,this._key)._apply(new P_(this._value,this._key)._apply(e))}};function DU(n,e){return Lh("equalTo","key",e,!0),new tS(n,e)}function er(n,...e){let t=z(n);for(let r of e)t=r._apply(t);return t}pY(Ln);vY(Ln);var cJ="FIREBASE_DATABASE_EMULATOR_HOST",nS={},lJ=!1;function uJ(n,e,t,r){n.repoInfo_=new c_(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function US(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||ii("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),kt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=WD(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[cJ]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=WD(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new hh(hh.OWNER):new oD(n.name,n.options,e);tU("Invalid Firebase Database URL",o),_e(o.path)||ii("Database URL must point to the root of a Firebase Database (not including a child path).");let h=hJ(a,n,d,new sD(n.name,t));return new rS(h,n)}function dJ(n,e){let t=nS[e];(!t||t[n.key]!==n)&&ii(`Database ${e}(${n.repoInfo_}) has already been deleted.`),oU(n),delete t[n.key]}function hJ(n,e,t,r){let i=nS[e.name];i||(i={},nS[e.name]=i);let s=i[n.toURLString()];return s&&ii("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new qD(n,lJ,t,r),i[n.toURLString()]=s,s}var rS=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(zY(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ln(this._repo,Re())),this._rootInternal}_delete(){return this._rootInternal!==null&&(dJ(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ii("Cannot call "+e+" on a deleted database.")}};function SU(){C2.IS_TRANSPORT_INITIALIZED&&en("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function AU(){SU(),gh.forceDisallow()}function RU(){SU(),sl.forceDisallow(),gh.forceAllow()}function xU(n,e,t,r={}){n=z(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&ii("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ii('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new hh(hh.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Ga(r.mockUserToken,n.app.options.projectId);s=new hh(o)}uJ(i,e,t,s)}function NU(n){n=z(n),n._checkNotDeleted("goOffline"),oU(n._repo)}function PU(n){n=z(n),n._checkNotDeleted("goOnline"),eJ(n._repo)}function MU(n,e){a2(n,e)}function fJ(n){oS(cn),an(new Fe("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return US(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),dt(DV,SV,n),dt(DV,SV,"esm2017")}var pJ={".sv":"timestamp"};function kU(){return pJ}function OU(n){return{".sv":{increment:n}}}var iS=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function LU(n,e,t){var r;if(n=z(n),kn("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new St,o=(c,l,d)=>{let h=null;c?s.reject(c):(h=new ml(d,new Ln(n._repo,n._path),ze),s.resolve(new iS(l,h)))},a=Y_(n,()=>{});return tJ(n._repo,n._path,e,o,a,i),s.promise}dS.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};dS.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};fJ();var mJ="@firebase/database-compat",gJ="1.0.7";var _J=new wn("@firebase/database-compat"),FU=function(n){let e="FIREBASE WARNING: "+n;_J.warn(e)};var yJ=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(Qt(n,e)+"must be a boolean.")},vJ=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Qt(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var jS=class{constructor(e){this._delegate=e}cancel(e){re("OnDisconnect.cancel",0,1,arguments.length),At("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){re("OnDisconnect.remove",0,1,arguments.length),At("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){re("OnDisconnect.set",1,2,arguments.length),At("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){re("OnDisconnect.setWithPriority",2,3,arguments.length),At("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(re("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,FU("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}At("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var BS=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return re("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var ra=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return re("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return re("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return re("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return re("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return re("DataSnapshot.child",0,1,arguments.length),e=String(e),vl("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return re("DataSnapshot.hasChild",1,1,arguments.length),vl("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return re("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return re("DataSnapshot.forEach",1,1,arguments.length),At("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return re("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return re("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return re("DataSnapshot.ref",0,0,arguments.length),new Oi(this._database,this._delegate.ref)}get ref(){return this.getRef()}},J_=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;re("Query.on",2,4,arguments.length),At("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new ra(this.database,l),d)};a.userCallback=t,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Y_(this._delegate,a,c),t;case"child_added":return kS(this._delegate,a,c),t;case"child_removed":return FS(this._delegate,a,c),t;case"child_changed":return OS(this._delegate,a,c),t;case"child_moved":return LS(this._delegate,a,c),t;default:throw new Error(Qt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(re("Query.off",0,3,arguments.length),vJ("Query.off",e,!0),At("Query.off","callback",t,!0),xI("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,VS(this._delegate,e,i)}else VS(this._delegate,e)}get(){return mU(this._delegate).then(e=>new ra(this.database,e))}once(e,t,r,i){re("Query.once",1,4,arguments.length),At("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new St,a=(l,d)=>{let h=new ra(this.database,l);t&&t.call(s.context,h,d),o.resolve(h)};a.userCallback=t,a.context=s.context;let c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":Y_(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":kS(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":FS(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":OS(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":LS(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(Qt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return re("Query.limitToFirst",1,1,arguments.length),new n(this.database,er(this._delegate,wU(e)))}limitToLast(e){return re("Query.limitToLast",1,1,arguments.length),new n(this.database,er(this._delegate,IU(e)))}orderByChild(e){return re("Query.orderByChild",1,1,arguments.length),new n(this.database,er(this._delegate,EU(e)))}orderByKey(){return re("Query.orderByKey",0,0,arguments.length),new n(this.database,er(this._delegate,TU()))}orderByPriority(){return re("Query.orderByPriority",0,0,arguments.length),new n(this.database,er(this._delegate,bU()))}orderByValue(){return re("Query.orderByValue",0,0,arguments.length),new n(this.database,er(this._delegate,CU()))}startAt(e=null,t){return re("Query.startAt",0,2,arguments.length),new n(this.database,er(this._delegate,yU(e,t)))}startAfter(e=null,t){return re("Query.startAfter",0,2,arguments.length),new n(this.database,er(this._delegate,vU(e,t)))}endAt(e=null,t){return re("Query.endAt",0,2,arguments.length),new n(this.database,er(this._delegate,gU(e,t)))}endBefore(e=null,t){return re("Query.endBefore",0,2,arguments.length),new n(this.database,er(this._delegate,_U(e,t)))}equalTo(e,t){return re("Query.equalTo",1,2,arguments.length),new n(this.database,er(this._delegate,DU(e,t)))}toString(){return re("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return re("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(re("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,At(e,"cancel",i.cancel,!0),i.context=r,xI(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(Qt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Oi(this.database,new Ln(this._delegate._repo,this._delegate._path))}},Oi=class n extends J_{constructor(e,t){super(e,new mn(t._repo,t._path,new Eh,!1)),this.database=e,this._delegate=t}getKey(){return re("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return re("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,Fs(this._delegate,e))}getParent(){re("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return re("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){re("Reference.set",1,2,arguments.length),At("Reference.set","onComplete",t,!0);let r=Q_(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(re("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,FU("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}kn("Reference.update",this._delegate._path),At("Reference.update","onComplete",t,!0);let r=pU(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){re("Reference.setWithPriority",2,3,arguments.length),At("Reference.setWithPriority","onComplete",r,!0);let i=fU(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){re("Reference.remove",0,1,arguments.length),At("Reference.remove","onComplete",e,!0);let t=dU(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){re("Reference.transaction",1,3,arguments.length),At("Reference.transaction","transactionUpdate",e,!1),At("Reference.transaction","onComplete",t,!0),yJ("Reference.transaction","applyLocally",r,!0);let i=LU(this._delegate,e,{applyLocally:r}).then(s=>new BS(s.committed,new ra(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){re("Reference.setPriority",1,2,arguments.length),At("Reference.setPriority","onComplete",t,!0);let r=hU(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){re("Reference.push",0,2,arguments.length),At("Reference.push","onComplete",t,!0);let r=uU(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return kn("Reference.onDisconnect",this._delegate._path),new jS(new R_(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var ia=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:AU,forceLongPolling:RU}}useEmulator(e,t,r={}){xU(this._delegate,e,t,r)}ref(e){if(re("database.ref",0,1,arguments.length),e instanceof Oi){let t=MS(this._delegate,e.toString());return new Oi(this,t)}else{let t=PS(this._delegate,e);return new Oi(this,t)}}refFromURL(e){re("database.refFromURL",1,1,arguments.length);let r=MS(this._delegate,e);return new Oi(this,r)}goOffline(){return re("database.goOffline",0,0,arguments.length),NU(this._delegate)}goOnline(){return re("database.goOnline",0,0,arguments.length),PU(this._delegate)}};ia.ServerValue={TIMESTAMP:kU(),increment:n=>OU(n)};function wJ({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){oS(t);let a=new ns("database-standalone"),c=new co("auth-internal",a);c.setComponent(new Fe("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new co("app-check-internal",a),l.setComponent(new Fe("app-check-internal",()=>i,"PRIVATE"))),{instance:new ia(US(n,c,l,e,o),n),namespace:s}}var IJ=Object.freeze({__proto__:null,initStandalone:wJ});var EJ=ia.ServerValue;function TJ(n){n.INTERNAL.registerComponent(new Fe("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new ia(i,r)},"PUBLIC").setServiceProps({Reference:Oi,Query:J_,Database:ia,DataSnapshot:ra,enableLogging:MU,INTERNAL:IJ,ServerValue:EJ}).setMultipleInstances(!0)),n.registerVersion(mJ,gJ)}TJ(Ne);var X_=(()=>{let e=class e{constructor(){}openCloseMenu(){let r=document.getElementById("sidebar-menu");r.style.display=="none"?r.style.display="flex":r.style.display="none"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var UU=(()=>{let e=class e{constructor(r){this.generalService=r,this.userUid=""}ngOnInit(){this.checkBookedTables(),this.checkIfEsternoIsEnabled()}checkPeopleLimit(){let r=document.getElementById("numero-persone-prenotazione-input");Number(r.value)>4&&(r.value="",alert("Per effettuare una prenotazione per pi\xF9 di 4 persone contattaci al numero: 040 233 46 09"))}reserveTable(r,i,s){Ne.auth().onAuthStateChanged(b=>{b&&(this.userUid=b.uid)});let o=document.getElementById("nome-prenotazione-input").value,a=document.getElementById("cognome-prenotazione-input").value,c=document.getElementById("numero-tavolo-prenotazione-input").value,l=document.getElementById("zona-tavolo-prenotazione-input").value,d=document.getElementById("data-prenotazione-input").value,h=document.getElementById("orario-prenotazione-input").value,p=document.getElementById("numero-persone-prenotazione-input").value,_=document.getElementById("telefono-prenotazione-input").value,w=document.getElementById("email-prenotazione-input").value;o!=""&&a!=""&&p!=""&&d!=""&&h!=""&&_!=""&&w!=""||this.userUid=="QoyO7QCgyqbHq2DFiCqqoWdBlJl2",document.getElementById("form-consent-checkbox0").checked?Ne.database().ref("tables/"+s+r).once("value",R=>{if(R.exists()){let L=R.val(),U=Date.now()-L,Q=5*60*60*1e3;U>=Q?this.sendBookEmail(s,r,i):Ne.auth().onAuthStateChanged(ie=>{ie&&(ie.uid=="QoyO7QCgyqbHq2DFiCqqoWdBlJl2",confirm("Vuoi liberare questo tavolo?")&&Ne.database().ref("tables/"+s+r).remove().then(()=>{alert("Tavolo liberato con successo")}).catch(J=>{alert("Errore nel liberare questo tavolo: "+J.message)}))})}else this.sendBookEmail(s,r,i),document.getElementById("form-consent-checkbox1").checked?this.submitTableToGoogleSheets("Bookings"):console.log("Dati non aggiunti a Sheets per mancanza di consenso")}):alert("Per prenotare un tavolo devi prima spuntare le checkbox")}sendBookEmail(r,i,s){if(confirm("Sei sicuro di voler prenotare il tavolo "+i+" - "+s+" nella zona "+r+"?")){document.getElementById("numero-tavolo-prenotazione-input").value=i+" - "+s,document.getElementById("zona-tavolo-prenotazione-input").value=r+"";let o=document.getElementById("form"),a=document.getElementById("result");Ne.database().ref("tables/").update({[r+i]:Ne.database.ServerValue.TIMESTAMP}),document.getElementById("form-consent-checkbox1").checked?this.submitTableToGoogleSheets("Bookings"):console.log("Dati non aggiunti a Sheets per mancanza di consenso");let l=new FormData(o),d={};l.forEach((p,_)=>{d[_]=p});let h=JSON.stringify(d);a.innerHTML="Please wait...",fetch("https://api.web3forms.com/submit",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:h}).then(p=>g(this,null,function*(){let _=yield p.json();p.status==200?(a.innerHTML="Form submitted successfully",alert("Prenotazione confermata con successo")):(console.log(p),a.innerHTML=_.message)})).catch(p=>{console.log(p),a.innerHTML="Something went wrong!"}).then(function(){o.reset(),setTimeout(()=>{a.style.display="none"},3e3)})}}checkBookedTables(){let r=new Date,i=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime();Ne.database().ref("tables").on("value",s=>{s.forEach(o=>{o.val()>i&&(document.getElementById(o.key).style.background="red")})})}checkIfEsternoIsEnabled(){Ne.database().ref("admin/esterno").on("value",r=>{console.log(r.val()),r.val()==!1?document.getElementById("esterno-table-selector").style.display="none":document.getElementById("esterno-table-selector").style.display="flex"})}submitTableToGoogleSheets(r){let s="https://script.google.com/macros/s/AKfycbw3yuPnJliYFTU56FdkmKNAycb4YqBRThO4HWHh3GWzn31agJYrsfvVsH245gAlZDJD_A/exec",o=document.getElementById("nome-prenotazione-input").value,a=document.getElementById("cognome-prenotazione-input").value,c=document.getElementById("numero-tavolo-prenotazione-input").value,l=document.getElementById("zona-tavolo-prenotazione-input").value,d=document.getElementById("data-prenotazione-input").value,h=document.getElementById("orario-prenotazione-input").value,p=document.getElementById("numero-persone-prenotazione-input").value,_=document.getElementById("telefono-prenotazione-input").value,w=document.getElementById("email-prenotazione-input").value;fetch(s+"?sheet="+r,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:o,surname:a,numeroTavolo:c,zonaTavolo:l,dataPrenotazione:d,orarioPrenotazione:h,numeroPersone:p,telefonoPrenotazione:_,emailPrenotazione:w})}).then(b=>{console.log("Dati inviati con successo!",b)}).catch(b=>console.error("Errore durante l'invio dei dati:",b))}};e.\u0275fac=function(i){return new(i||e)(yn(X_))},e.\u0275cmp=st({type:e,selectors:[["app-prenota"]],decls:229,vars:0,consts:[[2,"width","100%","height","100%","display","none","flex-direction","column","align-items","center","justify-content","center"],[2,"margin-bottom","0rem"],[2,"margin-top","0.5rem","width","90%","text-align","center"],["routerLink","/contattaci",1,"button-a"],[2,"height","100%","display","flex","flex-direction","column","align-items","center","overflow-y","auto","overflow-x","hidden"],[2,"margin-top","4rem","width","100%"],[2,"width","100%","max-width","60rem","display","flex","flex-direction","row","justify-content","start"],["src","assets\\svg\\Osteria logo jj_sono ghirigori.svg",2,"width","14rem","height","5rem","object-fit","cover","margin-left","-3rem"],[2,"width","calc(100% - 2rem)","max-width","60rem","display","flex","flex-direction","column","gap","1rem","margin-left","1rem","margin-right","1rem"],[2,"margin-bottom","0rem","width","100%","text-align","center","font-size","2.2rem"],[2,"margin-top","0.5rem","color","aliceblue","width","100%","text-align","center","font-size","1.5rem","margin-bottom","0rem"],[2,"margin-top","0.5rem","color","aliceblue","width","100%","text-align","center","font-size","0.9rem"],["method","POST","id","form"],["type","hidden","name","access_key","value","c51580cb-aec2-44d4-91c0-a77b223d5ee3"],["type","checkbox","name","botcheck",1,"hidden",2,"display","none"],["id","result"],[2,"width","100%","display","flex","flex-direction","row","gap","1rem","flex-wrap","wrap"],[2,"display","flex","flex-direction","column","flex","1","min-width","5rem"],["for","nome-prenotazione-input"],["id","nome-prenotazione-input","type","text","name","Nome","placeholder","James",1,"input"],["for","cognome-prenotazione-input"],["id","cognome-prenotazione-input","type","text","name","Cognome","placeholder","Joyce",1,"input"],["type","text","name","Numero Tavolo","id","numero-tavolo-prenotazione-input",2,"display","none"],["type","text","name","Zona Tavolo","id","zona-tavolo-prenotazione-input",2,"display","none"],["for","data-prenotazione-input"],["id","data-prenotazione-input","type","date","name","Giorno","placeholder","Giorno",1,"input"],["for","orario-prenotazione-input"],["id","orario-prenotazione-input","name","Orario","type","time","placeholder","Inizio",1,"input"],["for","numero-persone-prenotazione-input"],["id","numero-persone-prenotazione-input","name","Numero Persone","type","number",1,"input",3,"change"],[2,"display","flex","flex-direction","column","flex","1","min-width","10rem"],["for","telefono-prenotazione-input"],["id","telefono-prenotazione-input","name","Telefono","type","text","placeholder","",1,"input"],["for","email-prenotazione-input"],["id","email-prenotazione-input","type","email","name","email","placeholder","",1,"input"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-top","1rem"],["type","checkbox","id","form-consent-checkbox0",2,"height","1.5rem","width","1.5rem","flex-shrink","0"],["for","form-consent-checkbox0"],["routerLink","/privacy_policy",2,"color","aqua"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-top","0rem"],["type","checkbox","id","form-consent-checkbox1",2,"height","1.5rem","width","1.5rem","flex-shrink","0"],["for","form-consent-checkbox1"],[2,"display","flex","flex-direction","row","flex-wrap","wrap","gap","2rem"],[2,"flex","1","min-width","18rem"],[1,"desktop-responsive-summary",2,"height","13rem"],[2,"width","100%","display","flex","flex-direction","column"],["src","assets\\imgs\\vetrate\\tempImagexNSzRP.jpg","alt","Slide 1",1,"desktop-responsive-image",2,"height","10rem","object-fit","cover","object-position","bottom"],[2,"max-width","18rem","width","100%","display","flex","flex-direction","column","gap","3rem","border","1px solid white","overflow-x","hidden","margin-top","1rem","border-radius","0.5rem","padding","0.4rem","max-width","18rem","width","100%"],[2,"display","flex","flex-direction","row"],[2,"margin-top","1rem","margin-left","3rem"],["id","SalaPrincipale1",1,"table",2,"width","3rem","height","6rem",3,"click"],[2,"margin-left","0rem"],[2,"margin-top","2rem","margin-left","0rem"],[2,"flex","1"],[2,"display","flex","flex-direction","row","gap","2rem","margin-top","1rem"],["id","SalaPrincipale3",1,"table",2,"width","6rem","height","3rem",3,"click"],[2,"width","100%","height","100%","display","flex","flex-direction","row","align-items","center"],[2,"margin-left","0.2rem","margin-top","0rem"],[2,"margin-left","2rem","margin-top","0rem"],[2,"display","flex","flex-direction","row","gap","1rem"],["id","SalaPrincipale5",1,"table",2,"width","6rem","height","3rem",3,"click"],[2,"display","flex","flex-direction","row","gap","2rem"],["id","SalaPrincipale7",1,"table",2,"width","3rem","height","3rem",3,"click"],["id","SalaPrincipale8",1,"table",2,"width","3rem","height","3rem",3,"click"],[2,"display","flex","flex-direction","row","gap","1.5rem"],[2,"display","flex","flex-direction","row","justify-content","center"],["id","SalaPrincipale9",1,"table",2,"width","6rem","height","3rem",3,"click"],[2,"display","flex","flex-direction","row","justify-content","center","transform","rotateZ(45deg)","margin-top","2rem","margin-right","2rem"],["id","SalaPrincipale11",1,"table",2,"width","6rem","height","3rem",3,"click"],[2,"display","flex","flex-direction","row","justify-content","end"],[2,"display","flex","flex-direction","row","justify-content","center","margin-top","2rem"],[1,"table",2,"width","14rem","height","11rem","border-start-start-radius","6rem","border-end-start-radius","6rem","display","flex","align-items","center","justify-content","center","border-right","10px solid brown"],[2,"transform","rotateZ(-90deg)"],[2,"width","2px","height","100%","border-left","1px solid brown"],["src","assets\\imgs\\fronte-banco\\tempImageFApL2m.jpg","alt","Slide 1",1,"desktop-responsive-image",2,"height","10rem","object-fit","cover"],[2,"width","100%","display","flex","flex-direction","column","gap","3rem","border","1px solid white","margin-top","1rem","border-radius","0.5rem","padding-top","2rem","max-width","18rem","width","100%"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","5rem"],["id","Pianoforte13",1,"table",2,"width","4rem","height","4rem","transform","rotateZ(45deg)",3,"click"],["id","Pianoforte14",1,"table",2,"width","4rem","height","4rem","transform","rotateZ(45deg)",3,"click"],[2,"display","flex","flex-direction","row","display","flex","align-items","center","justify-content","center"],["id","Pianoforte15",1,"table",2,"width","4rem","height","4rem","margin-left","2rem","transform","rotateZ(45deg)",3,"click"],[1,"table",2,"width","100%","height","5rem","border-start-start-radius","8rem","border-start-end-radius","8rem","display","flex","align-items","center","justify-content","center"],["id","esterno-table-selector",2,"flex","1","min-width","18rem"],["src","assets\\imgs\\esterno\\tempImageOEU8vP.jpg","alt","Slide 1",1,"desktop-responsive-image",2,"height","10rem","object-fit","cover"],[2,"width","100%","display","flex","flex-direction","column","gap","3rem","border","1px solid white","margin-top","1rem","border-radius","0.5rem","padding","0.4rem","max-width","18rem","width","100%"],["id","Esterno1",1,"table",2,"width","8rem","height","4rem",3,"click"],["id","Esterno3",1,"table",2,"width","4rem","height","4rem",3,"click"],["id","Esterno4",1,"table",2,"width","8rem","height","4rem",3,"click"],["id","Esterno6",1,"table",2,"width","4rem","height","4rem",3,"click"],[2,"display","flex","flex-direction","row","margin-top","2rem"],["id","Esterno7",1,"table",2,"width","8rem","height","4rem",3,"click"],["id","Esterno9",1,"table",2,"width","4rem","height","4rem",3,"click"],["id","Esterno10",1,"table",2,"width","8rem","height","4rem",3,"click"],[2,"height","4rem","width","1rem","background","brown","display","flex","align-items","center","justify-content","center"],[2,"transform","rotateZ(-90deg)","margin-right","1rem","margin-top","0rem","margin-bottom","0rem"],["id","Esterno12",1,"table",2,"width","8rem","height","4rem",3,"click"],["id","Esterno14",1,"table",2,"width","4rem","height","4rem","margin-top","0.5rem",3,"click"],["id","Esterno15",1,"table",2,"width","8rem","height","4rem",3,"click"],["id","Esterno17",1,"table",2,"width","8rem","height","4rem",3,"click"],["id","Esterno19",1,"table",2,"width","4rem","height","4rem","margin-bottom","0.5rem",3,"click"],[2,"width","100%","max-width","50rem","display","flex","flex-direction","row","justify-content","end","margin-bottom","4rem"],["src","assets\\svg\\Osteria logo jj_sono ghirigori.svg",2,"width","14rem","height","5rem","object-fit","cover","margin-right","-1.8rem"],[2,"background","black","padding-top","2rem","width","100%"],[2,"margin-left","-1rem","width","100%"]],template:function(i,s){i&1&&(S(0,"div",0)(1,"h1",1),O(2,"Prenota"),x(),S(3,"p",2),O(4,"Per prenotare un tavolo contattaci con il bottone sottostante"),x(),S(5,"button",3),O(6,"Contattaci"),x()(),S(7,"div",4),q(8,"div",5),S(9,"div",6),q(10,"img",7),x(),S(11,"div",8)(12,"div")(13,"h1",9),O(14,"NUOVA PRENOTAZIONE"),x(),S(15,"p",10),O(16,"Prenota il tuo tavolo direttamente da qui:"),x(),S(17,"p",11),O(18,"*Massimo 4 persone per prenotazione sul sito, contattaci per estendere questo limite"),x()(),S(19,"form",12),q(20,"input",13)(21,"input",14)(22,"div",15),S(23,"div",16)(24,"div",17)(25,"label",18),O(26,"Nome"),x(),q(27,"input",19),x(),S(28,"div",17)(29,"label",20),O(30,"Cognome"),x(),q(31,"input",21),x()(),q(32,"input",22)(33,"input",23),S(34,"div",16)(35,"div",17)(36,"label",24),O(37,"Data"),x(),q(38,"input",25),x(),S(39,"div",17)(40,"label",26),O(41,"Orario"),x(),q(42,"input",27),x()(),S(43,"div",16)(44,"div",17)(45,"label",28),O(46,"Numero persone"),x(),S(47,"input",29),he("change",function(){return s.checkPeopleLimit()}),x()()(),S(48,"div",16)(49,"div",30)(50,"label",31),O(51,"Telefono"),x(),q(52,"input",32),x(),S(53,"div",30)(54,"label",33),O(55,"Email"),x(),q(56,"input",34),x()()(),S(57,"div",35),q(58,"input",36),S(59,"label",37),O(60,"HO PRESO VISIONE DELL' "),S(61,"a",38),O(62,"INFORMATIVA PRIVACY"),x()()(),S(63,"div",39),q(64,"input",40),S(65,"label",41),O(66,"ACCONSENTO ALL'INVIO DI COMUNICAZIONE PROMOZIONALI E NEWSLETTER"),x()(),S(67,"h2",1),O(68,"Zone"),x(),S(69,"div",42)(70,"details",43)(71,"summary",44)(72,"div",45),q(73,"img",46),S(74,"h3"),O(75,"Sala Principale"),x()()(),S(76,"div",47)(77,"div",48)(78,"div",49)(79,"div",50),he("click",function(){return s.reserveTable(1,2,"SalaPrincipale")}),S(80,"p",51),O(81,"1"),x(),S(82,"p",52),O(83,"2"),x()()(),q(84,"div",53),S(85,"div",54)(86,"div",55),he("click",function(){return s.reserveTable(3,4,"SalaPrincipale")}),S(87,"div",56)(88,"p",57),O(89,"3"),x(),S(90,"p",58),O(91,"4"),x()()()()(),S(92,"div",59)(93,"div",48)(94,"div",60),he("click",function(){return s.reserveTable(5,6,"SalaPrincipale")}),S(95,"div",56)(96,"p",57),O(97,"5"),x(),S(98,"p",58),O(99,"6"),x()()()(),q(100,"div",53),S(101,"div",61)(102,"div",62),he("click",function(){return s.reserveTable(7," ","SalaPrincipale")}),O(103,"7"),x(),S(104,"div",63),he("click",function(){return s.reserveTable(8," ","SalaPrincipale")}),O(105,"8"),x()()(),S(106,"div",64)(107,"div",65)(108,"div",66),he("click",function(){return s.reserveTable(9,10,"SalaPrincipale")}),S(109,"div",56)(110,"p",57),O(111,"9"),x(),S(112,"p",58),O(113,"10"),x()()()(),q(114,"div",53),S(115,"div",67)(116,"div",68),he("click",function(){return s.reserveTable(11,12,"SalaPrincipale")}),S(117,"div",56)(118,"p",57),O(119,"11"),x(),S(120,"p",58),O(121,"12"),x()()()()(),S(122,"div",69)(123,"div",70)(124,"div",71)(125,"p",72),O(126,"Banco"),x(),q(127,"div",73),S(128,"p",72),O(129,"Entrata"),x()()()()()(),S(130,"details",43)(131,"summary",44)(132,"div",45),q(133,"img",74),S(134,"h3"),O(135,"Pianoforte"),x()()(),S(136,"div",75)(137,"div",76)(138,"div",77),he("click",function(){return s.reserveTable(13," ","Pianoforte")}),O(139,"13"),x(),S(140,"div",78),he("click",function(){return s.reserveTable(14," ","Pianoforte")}),O(141,"14"),x()(),S(142,"div",79)(143,"div",80),he("click",function(){return s.reserveTable(15," ","Pianoforte")}),O(144,"15"),x()(),S(145,"div",65)(146,"div",81)(147,"p"),O(148,"Pianoforte"),x()()()()(),S(149,"details",82)(150,"summary",44)(151,"div",45),q(152,"img",83),S(153,"h3"),O(154,"Esterno"),x()()(),S(155,"div",84)(156,"div",48)(157,"div",85),he("click",function(){return s.reserveTable(1,2,"Esterno")}),S(158,"div",56)(159,"p",57),O(160,"1"),x(),S(161,"p",58),O(162,"2"),x()()(),q(163,"div",53),S(164,"div",86),he("click",function(){return s.reserveTable(3," ","Esterno")}),O(165,"3"),x()(),S(166,"div",48)(167,"div",87),he("click",function(){return s.reserveTable(4,5,"Esterno")}),S(168,"div",56)(169,"p",57),O(170,"4"),x(),S(171,"p",58),O(172,"5"),x()()(),q(173,"div",53),S(174,"div",88),he("click",function(){return s.reserveTable(6," ","Esterno")}),O(175,"6"),x()(),S(176,"div",89)(177,"div",90),he("click",function(){return s.reserveTable(7,8,"Esterno")}),S(178,"div",56)(179,"p",57),O(180,"7"),x(),S(181,"p",58),O(182,"8"),x()()(),q(183,"div",53),S(184,"div",91),he("click",function(){return s.reserveTable(9," ","Esterno")}),O(185,"9"),x()(),S(186,"div",48)(187,"div",92),he("click",function(){return s.reserveTable(10,11,"Esterno")}),S(188,"div",56)(189,"p",57),O(190,"10"),x(),S(191,"p",58),O(192,"11"),x()()(),q(193,"div",53),S(194,"div",93)(195,"p",94),O(196,"Ingresso"),x()()(),S(197,"div",89)(198,"div",95),he("click",function(){return s.reserveTable(12,13,"Esterno")}),S(199,"div",56)(200,"p",57),O(201,"12"),x(),S(202,"p",58),O(203,"13"),x()()(),q(204,"div",53),S(205,"div",96),he("click",function(){return s.reserveTable(14," ","Esterno")}),O(206,"14"),x()(),S(207,"div",65)(208,"div",97),he("click",function(){return s.reserveTable(15,16,"Esterno")}),S(209,"div",56)(210,"p",57),O(211,"15"),x(),S(212,"p",58),O(213,"16"),x()()(),q(214,"div",53),x(),S(215,"div",89)(216,"div",98),he("click",function(){return s.reserveTable(17," ","Esterno")}),S(217,"div",56)(218,"p",57),O(219,"17"),x(),S(220,"p",58),O(221,"18"),x()()(),q(222,"div",53),S(223,"div",99),he("click",function(){return s.reserveTable(19," ","Esterno")}),O(224,"19"),x()()()()()(),S(225,"div",100),q(226,"img",101),x(),S(227,"div",102),q(228,"app-footer",103),x()())},dependencies:[Ha,qn]});let n=e;return n})();var jU=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=st({type:e,selectors:[["app-menu"]],decls:38,vars:0,consts:[[2,"width","100%","height","100%","overflow-y","auto","overflow-x","hidden"],[2,"margin-top","7rem","font-size","3rem","width","100%","text-align","center","margin-bottom","0rem"],[2,"width","100%","font-size","1.2rem","text-align","center","margin-top","0.5rem"],[2,"width","100%","display","flex","flex-direction","column","align-items","center","margin-top","4rem","gap","3rem"],[2,"max-width","30rem","width","100%","display","flex","flex-direction","column","gap","1rem"],[2,"width","100%","margin-bottom","0.5rem"],[1,"details"],[1,"summary"],[2,"font-size","1.8rem"],[2,"display","flex","flex-direction","column","gap","0.8rem","padding-top","0.8rem","padding-left","2rem"],["src",_i`assets\\pdf\\ita\\Menu-.html`,"frameborder","0",2,"max-width","30rem","width","100%","height","30rem","overflow-y","auto","overflow-x","hidden","zoom","200%"],["src",_i`assets\\pdf\\ita\\Menu-Dessert.html`,"frameborder","0",2,"max-width","30rem","width","100%","height","30rem","overflow-y","auto","overflow-x","hidden","zoom","200%"],[2,"max-width","30rem","width","100%","display","none","flex-direction","column","gap","1rem"],[2,"width","100%","margin-top","2rem"],["src",_i`assets\\pdf\\eng\\menu-_Inglese_.html`,"frameborder","0",2,"max-width","30rem","width","100%","height","30rem","overflow-y","auto","overflow-x","hidden","zoom","200%"],["src",_i`assets\\pdf\\eng\\Dessert-Inglese.-pdf.html`,"frameborder","0",2,"max-width","30rem","width","100%","height","30rem","overflow-y","auto","overflow-x","hidden","zoom","200%"],[2,"width","100%","padding-top","4rem","background","black","margin-top","5rem"]],template:function(i,s){i&1&&(S(0,"div",0)(1,"h1",1),O(2,"MEN\xD9"),x(),S(3,"p",2),O(4,"Scopri i sapori dell'osteria James Joyce"),x(),S(5,"div",3)(6,"div",4)(7,"h3",5),O(8,"Italian"),x(),S(9,"details",6)(10,"summary",7)(11,"h3",8),O(12,"RISTORANTE"),x()(),q(13,"div",9)(14,"iframe",10),x(),S(15,"details",6)(16,"summary",7)(17,"h3",8),O(18,"DESSERT"),x()(),q(19,"div",9)(20,"iframe",11),x()(),S(21,"div",12)(22,"h3",13),O(23,"English"),x(),S(24,"details",6)(25,"summary",7)(26,"h3",8),O(27,"RESTURANT"),x()(),q(28,"div",9)(29,"iframe",14),x(),S(30,"details",6)(31,"summary",7)(32,"h3",8),O(33,"DESSERT"),x()(),q(34,"div",9)(35,"iframe",15),x()()(),S(36,"div",16),q(37,"app-footer"),x()())},dependencies:[qn]});let n=e;return n})();var BU=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=st({type:e,selectors:[["app-lavora-con-noi"]],decls:15,vars:0,consts:[[2,"width","100%","height","100%","overflow-y","auto","overflow-x","hidden"],[2,"height","8rem","width","100%"],[2,"width","100%","display","flex","flex-direction","row","flex-wrap","wrap","align-items","center","justify-content","center","gap","5rem"],["src","assets\\imgs\\Jj 1 .jpg",2,"width","18rem","object-fit","cover","object-position","center","border-radius","1rem"],[2,"display","flex","flex-direction","column","align-items","center","max-width","20rem","padding-left","1rem"],[2,"width","100%"],[2,"width","100%","margin-top","0rem"],["href","mailto:info@osteriajamesjoyce.it",1,"a1",2,"font-size","1rem"]],template:function(i,s){i&1&&(S(0,"div",0),q(1,"div",1),S(2,"div",2),q(3,"img",3),S(4,"div",4)(5,"h1",5),O(6,"Lavora con noi"),x(),S(7,"p",5),O(8,"Cerchiamo collaboratori che condividano i nostri valori di ospitalit\xE0, passione e professionalit\xE0 nel lavoro."),x(),S(9,"p",6),O(10,"Se anche tu vuoi entrare a far palte del team invia una mail con il tuo CV all'indirizzo "),S(11,"a",7),O(12,"info@osteriajamesjoyce.it"),x()()()(),q(13,"div",1)(14,"app-footer"),x())},dependencies:[qn]});let n=e;return n})();var $U=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=st({type:e,selectors:[["app-privacy-policy"]],decls:7,vars:0,consts:[[2,"width","100%","height","100%","overflow-x","hidden","overflow-y","auto"],[2,"width","100%","text-align","center","margin-top","7rem"],[2,"width","100%","display","flex","align-items","center","justify-content","center"],["src",_i`assets\\legal\\PRIVACY-POLICY-sito-James-Joyce.html`,"frameborder","0",2,"width","90%","height","40rem","overflow-y","auto","overflow-x","hidden"],[2,"width","100%","padding-top","4rem","background","black","margin-top","5rem"]],template:function(i,s){i&1&&(S(0,"div",0)(1,"h1",1),O(2,"Privacy Policy"),x(),S(3,"div",2),q(4,"iframe",3),x(),S(5,"div",4),q(6,"app-footer"),x()())},dependencies:[qn]});let n=e;return n})();var HU=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=st({type:e,selectors:[["app-dove-siamo"]],decls:4,vars:0,consts:[[2,"width","100%","height","100%","overflow-y","auto","overflow-x","hidden","display","flex","flex-direction","column","align-items","center"],[2,"width","100%","text-align","center","margin-top","7rem"],["src",_i`https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2788.8622939240063!2d13.771784999999998!3d45.6535871!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x477b6b9c1994dfdb%3A0x9e7f9b4f97117abd!2sOsteria%20James%20Joyce!5e0!3m2!1sen!2sit!4v1728911850196!5m2!1sen!2sit`,"allowfullscreen","","loading","lazy","referrerpolicy","no-referrer-when-downgrade",2,"border","0","width","80%","min-height","30rem"]],template:function(i,s){i&1&&(S(0,"div",0)(1,"h1",1),O(2,"Dove Siamo"),x(),q(3,"iframe",2),x())}});let n=e;return n})();var qU=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=st({type:e,selectors:[["app-contattaci"]],decls:19,vars:0,consts:[[2,"width","100%","height","100%","overflow-y","auto","overflow-x","hidden"],[2,"height","8rem","width","100%"],[1,"column-reverse-responsive-div",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","5rem"],["src","assets\\imgs\\tempImageFEw6QP.jpg",2,"width","18rem","border-radius","1rem"],[1,"responsive-margin-left"],[2,"margin-bottom","0rem"],[2,"max-width","20rem","margin-top","0.5rem","margin-right","1rem"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","1rem","flex-wrap","wrap"],["href","tel:+390402334609",1,"button-a"],["href","mailto:lavorocristian9@gmail.com",1,"button-a"],["href","https://www.instagram.com/osteria_jamesjoyce?igsh=MTZseGsxcmpneWd2OQ%3D%3D&utm_source=qr",1,"button-a"],[2,"width","100%","background","black","padding-top","4rem"]],template:function(i,s){i&1&&(S(0,"div",0),q(1,"div",1),S(2,"div",2),q(3,"img",3),S(4,"div",4)(5,"h1",5),O(6,"Contattaci"),x(),S(7,"p",6),O(8,"Contattaci e seguici sui nostri canali per restare aggiornato"),x(),S(9,"div",7)(10,"a",8),O(11,"+39 040 233 4609"),x(),S(12,"a",9),O(13,"Email"),x(),S(14,"a",10),O(15,"Instagram"),x()()()(),q(16,"div",1),S(17,"div",11),q(18,"app-footer"),x()())},dependencies:[qn]});let n=e;return n})();var zU=(()=>{let e=class e{constructor(r){this.router=r}ngOnInit(){Ne.auth().onAuthStateChanged(r=>{r?(document.getElementById("admin-email-display").innerText=r.email,document.getElementById("admin-div").style.display="flex",document.getElementById("login-div").style.display="none",this.checkIfAdminEsternoIsEnabled()):(document.getElementById("admin-div").style.display="none",document.getElementById("login-div").style.display="flex")})}login(){let r=document.getElementById("login-email-input"),i=document.getElementById("login-password-input");Ne.auth().signInWithEmailAndPassword(r.value,i.value).then(s=>{document.getElementById("admin-div").style.display="flex"}).catch(s=>{document.getElementById("admin-div").style.display="none",alert("Accesso fallito: "+s.message)})}logout(){confirm("Sei sicuro di volerti disconnettere?")&&Ne.auth().signOut().then(()=>{this.router.navigate(["/home"]),alert("Disconnesso con successo")}).catch(r=>{alert("Errore durante il logout: "+r.message)})}changeEsternoCheckbox(){let r=document.getElementById("show-esterno-checkbox");r.checked?confirm("Sei sicuro di ATTIVARE la parte esterna del ristorante per le prenotazioni?")?Ne.database().ref("admin").update({esterno:!0}):r.checked=!1:confirm("Sei sicuro di DISATTIVARE la parte esterna del ristorante per le prenotazioni?")?Ne.database().ref("admin").update({esterno:!1}):r.checked=!0}checkIfAdminEsternoIsEnabled(){let r=document.getElementById("show-esterno-checkbox");Ne.database().ref("admin/esterno").on("value",i=>{i.val()==!1?r.checked=!1:r.checked=!0})}};e.\u0275fac=function(i){return new(i||e)(yn(Or))},e.\u0275cmp=st({type:e,selectors:[["app-admin"]],decls:23,vars:0,consts:[["id","login-div",2,"height","100%","width","100%","display","none","flex-direction","column","align-items","center","overflow-y","auto","overflow-x","hidden","gap","1rem"],[2,"height","5rem"],["id","login-email-input","type","text","placeholder","Email",1,"input",2,"width","100%","max-width","18rem"],["id","login-password-input","type","text","placeholder","Password",1,"input",2,"width","100%","max-width","18rem"],[1,"button-a",2,"width","8rem",3,"click"],["id","admin-div",2,"height","100%","width","100%","display","none","flex-direction","column","align-items","center","overflow-y","auto","overflow-x","hidden","gap","1rem"],["id","admin-email-display"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"],["type","checkbox","id","show-esterno-checkbox",2,"height","1.5rem","width","1.5rem",3,"change"],["for","show-esterno-checkbox",2,"font-size","1.2rem"],[2,"height","2rem"],["href","https://docs.google.com/spreadsheets/d/1rDP1G4YKLWOL27BLRRFCbCd26VUF1Vj97vqFa3lx-zg/edit?usp=sharing",1,"button-a",2,"max-width","15rem","width","100%"],[1,"button-a",2,"max-width","17rem","width","100%",3,"click"]],template:function(i,s){i&1&&(S(0,"div",0),q(1,"div",1),S(2,"h3"),O(3,"Bentornato, effettua l'accesso"),x(),q(4,"input",2)(5,"input",3),S(6,"button",4),he("click",function(){return s.login()}),O(7,"Login"),x()(),S(8,"div",5),q(9,"div",1),S(10,"h3"),O(11,"Bentornato, "),q(12,"span",6),x(),S(13,"div",7)(14,"input",8),he("change",function(){return s.changeEsternoCheckbox()}),x(),S(15,"label",9),O(16,"Esterno"),x()(),q(17,"div",10),S(18,"a",11),O(19,"Google Sheets"),x(),S(20,"button",12),he("click",function(){return s.logout()}),O(21,"Disconnetti"),x(),q(22,"div",1),x())}});let n=e;return n})();var bJ=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:SM},{path:"prenota",component:UU},{path:"menu",component:jU},{path:"lavora_con_noi",component:BU},{path:"privacy_policy",component:$U},{path:"dove_siamo",component:HU},{path:"contattaci",component:qU},{path:"admin",component:zU}],WU=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=cr({type:e}),e.\u0275inj=ar({providers:[{provide:hr,useClass:Ep}],imports:[vI.forRoot(bJ),vI]});let n=e;return n})();var GU=(()=>{let e=class e{constructor(r){this.generalService=r,this.title="james-joice"}ngOnInit(){this.initFirebase()}initFirebase(){let r={apiKey:"AIzaSyAVsXi4sifLsUe4KUZWTjrZGuD2H7eWd1Y",authDomain:"jjpp-80634.firebaseapp.com",databaseURL:"https://jjpp-80634-default-rtdb.europe-west1.firebasedatabase.app",projectId:"jjpp-80634",storageBucket:"jjpp-80634.appspot.com",messagingSenderId:"157051003839",appId:"1:157051003839:web:5f3fe851d3f34b5544b70a",measurementId:"G-41NRX2HZEY"};Ne.initializeApp(r)}openCloseMenu(){this.generalService.openCloseMenu()}closeSidebar(){document.getElementById("sidebar-menu").style.display="none"}};e.\u0275fac=function(i){return new(i||e)(yn(X_))},e.\u0275cmp=st({type:e,selectors:[["app-root"]],decls:45,vars:0,consts:[[1,"header-strip"],[2,"height","100%","display","flex","flex-direction","row","align-items","center","justify-content","center","gap","1.5rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","2.5rem","color","white","cursor","pointer","margin-left","1rem",3,"click"],[2,"flex","1"],[1,"desktop-element",2,"display","flex","flex-direction","row","align-items","center","gap","1.5rem"],["routerLink","/home",1,"a1"],["routerLink","/menu",1,"a1"],["routerLink","/home","src","assets\\svg\\solo jj.svg",2,"width","5rem","cursor","pointer"],["routerLink","/prenota",1,"a1"],["routerLink","/contattaci",1,"a1"],[2,"width","3.5rem","height","100%","flex-shrink","0"],["id","sidebar-menu"],[2,"display","flex","flex-direction","column"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem","padding-left","1.8rem","margin-top","1rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","2.5rem","color","white","cursor","pointer",3,"click"],[2,"margin-bottom","0rem","margin-top","0rem"],["src","assets\\svg\\solo jj.svg",2,"width","10rem","height","5rem","object-fit","cover","margin-top","2rem","margin-left","-1.8rem"],[2,"display","flex","flex-direction","column","padding-left","1.8rem","padding-bottom","1rem","height","100%"],["routerLink","/home",1,"a1",3,"click"],["routerLink","/menu",1,"a1",3,"click"],["routerLink","/prenota",1,"a1",3,"click"],["routerLink","/contattaci",1,"a1",3,"click"],["routerLink","/dove_siamo",1,"a1",2,"margin-top","0rem","margin-bottom","0rem",3,"click"],["routerLink","/privacy_policy",1,"a1",2,"margin-top","0rem","margin-bottom","0rem",3,"click"],["routerLink","/lavora_con_noi",1,"a1",3,"click"],["routerLink","/admin",1,"a1",3,"click"]],template:function(i,s){i&1&&(S(0,"div",0)(1,"div",1)(2,"span",2),he("click",function(){return s.openCloseMenu()}),O(3,"menu"),x(),q(4,"div",3),S(5,"div",4)(6,"a",5),O(7,"Home"),x(),S(8,"a",6),O(9,"Men\xF9"),x()(),q(10,"img",7),S(11,"div",4)(12,"a",8),O(13,"Prenota"),x(),S(14,"a",9),O(15,"Contattaci"),x()(),q(16,"div",3)(17,"div",10),x()(),S(18,"div",11)(19,"div",12)(20,"div",13)(21,"span",14),he("click",function(){return s.openCloseMenu()}),O(22,"menu"),x(),S(23,"h2",15),O(24,"Indice"),x()(),q(25,"img",16),S(26,"div",17)(27,"a",18),he("click",function(){return s.closeSidebar()}),O(28,"Home"),x(),S(29,"a",19),he("click",function(){return s.closeSidebar()}),O(30,"Men\xF9"),x(),S(31,"a",20),he("click",function(){return s.closeSidebar()}),O(32,"Prenota"),x(),S(33,"a",21),he("click",function(){return s.closeSidebar()}),O(34,"Contattaci"),x(),S(35,"a",22),he("click",function(){return s.closeSidebar()}),O(36,"Dove siamo"),x(),S(37,"a",23),he("click",function(){return s.closeSidebar()}),O(38,"Privacy Policy"),x(),S(39,"a",24),he("click",function(){return s.closeSidebar()}),O(40,"Lavora con noi"),x(),q(41,"div",3),S(42,"a",25),he("click",function(){return s.closeSidebar()}),O(43,"Admin"),x()()()(),q(44,"router-outlet"))},dependencies:[hI,Ha]});let n=e;return n})();var KU=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=cr({type:e,bootstrap:[GU]}),e.\u0275inj=ar({imports:[LP,WU]});let n=e;return n})();OP().bootstrapModule(KU).catch(n=>console.error(n));
